# Line Search ν¨ν„΄ λ¶„μ„ κ²°κ³Ό

**λ΅κ·Έ νμΌ**: `simultaneous_estimation_log_20251123_114842.txt`  
**λ¶„μ„ λ€μƒ**: Iteration #12μ 40ν Line Search μ‹λ„

---

## π“ Line Search μ‹λ„λ³„ μƒμ„Έ λ°μ΄ν„°

| μ‹λ„ | LL | νλΌλ―Έν„° λ³€ν™” (L2 norm) | LL λ³€ν™” | μƒνƒ |
|------|-----|------------------------|---------|------|
| 1 | -2052.4598 | 0.000000e+00 | +0.0000 | μ •μ²΄ |
| 2 | -2052.4608 | 6.022409e-03 | +0.0124 | κ°μ„  |
| 3 | -2052.4599 | 6.581517e-03 | +0.0134 | κ°μ„  |
| 4 | -2052.4598 | 6.635167e-03 | +0.0134 | κ°μ„  |
| 5 | -2052.4598 | 6.640331e-03 | +0.0135 | κ°μ„  |
| 6 | -2052.4598 | 6.640829e-03 | +0.0135 | κ°μ„  |
| 7 | -2052.4598 | 6.640877e-03 | +0.0135 | κ°μ„  |
| 8 | -2052.4598 | 6.640881e-03 | +0.0135 | κ°μ„  |
| 9 | -2052.4598 | 6.640882e-03 | +0.0135 | κ°μ„  |
| 10 | -2052.4598 | 6.640882e-03 | +0.0135 | κ°μ„  |
| 11-19 | -2052.4598 | 6.640882e-03 | +0.0135 | **λ™μΌ** |
| **20** | **-4727.4916** | **3.775065e+00** | **-2675.0183** | **λ€ν­ μ•…ν™”** β οΈ |
| 21 | -2404.0069 | 1.216977e+00 | -351.5337 | μ•…ν™” |
| 22 | -2082.8436 | 3.634876e-01 | -30.3703 | μ•…ν™” |
| 23 | -2055.3254 | 1.080176e-01 | -2.8521 | μ•…ν™” |
| 24 | -2052.8038 | 3.285449e-02 | -0.3305 | μ•…ν™” |
| 25 | -2052.5176 | 1.069846e-02 | -0.0443 | μ•…ν™” |
| 26 | -2052.4713 | 5.907939e-03 | +0.0020 | κ°μ„  |
| 27 | -2052.4614 | 6.359929e-03 | +0.0119 | κ°μ„  |
| 28 | -2052.4600 | 6.602571e-03 | +0.0133 | κ°μ„  |
| 29 | -2052.4598 | 6.636274e-03 | +0.0134 | κ°μ„  |
| 30-39 | -2052.4598 | 6.640882e-03 | +0.0135 | **λ™μΌ** |

---

## π” ν¨ν„΄ λ¶„μ„

### **[Phase 1] μ‹λ„ 1-10: μλ ΄ κ³Όμ •**

| μ§€ν‘ | κ°’ |
|------|-----|
| νλΌλ―Έν„° λ³€ν™” λ²”μ„ | 0.000000e+00 β†’ 6.640882e-03 |
| LL λ³€ν™” λ²”μ„ | +0.0000 β†’ +0.0135 |
| μµμΆ… μλ ΄κ°’ | 6.640882e-03 (νλΌλ―Έν„°), +0.0135 (LL) |

**κ΄€μ°°**:
- μ‹λ„ 1-9: νλΌλ―Έν„° λ³€ν™”λ‰μ΄ μ μ§„μ μΌλ΅ μ¦κ°€ν•λ©° μλ ΄
- μ‹λ„ 10: νλΌλ―Έν„° λ³€ν™”λ‰μ΄ **6.640882e-03**μ— μλ ΄
- LL κ°μ„ λ‰λ„ **+0.0135**μ— μλ ΄

---

### **[Phase 2] μ‹λ„ 11-19: μ™„μ „ μ •μ²΄**

| μ§€ν‘ | κ°’ |
|------|-----|
| νλΌλ―Έν„° λ³€ν™” | **6.640882e-03** (μ™„μ „ λ™μΌ) |
| LL λ³€ν™” | **+0.0135** (μ™„μ „ λ™μΌ) |
| LL κ°’ | **-2052.4598** (μ™„μ „ λ™μΌ) |

**κ΄€μ°°**:
- **9ν μ—°μ† μ™„μ „ν λ™μΌν• κ²°κ³Ό**
- νλΌλ―Έν„° λ³€ν™”λ‰μ μ†μμ  7μλ¦¬κΉμ§€ λ™μΌ
- LL λ³€ν™”λ‰λ„ μ™„μ „ν λ™μΌ
- **μμΉμ μΌλ΅ μλ ΄ μ™„λ£**

---

### **[Phase 3] μ‹λ„ 20: λ€ν­ μ•…ν™”**

| μ§€ν‘ | κ°’ |
|------|-----|
| νλΌλ―Έν„° λ³€ν™” | **3.775065e+00** (568λ°° μ¦κ°€!) |
| LL λ³€ν™” | **-2675.0183** (λ€ν­ μ•…ν™”) |
| LL κ°’ | **-4727.4916** (μµμ•…) |

**κ΄€μ°°**:
- Line Searchκ°€ **ν° step size**λ¥Ό μ‹λ„
- νλΌλ―Έν„° λ³€ν™”λ‰μ΄ 3.78 (μ΄μ „ 0.0066μ 568λ°°)
- LLμ΄ -2052 β†’ -4727λ΅ **λ€ν­ μ•…ν™”**
- **νƒμƒ‰ λ°©ν–¥μ΄ μλ»λμ—μμ„ μ‹μ‚¬**

---

### **[Phase 4] μ‹λ„ 21-25: λ³µκµ¬ μ‹λ„ (μ‹¤ν¨)**

| μ‹λ„ | νλΌλ―Έν„° λ³€ν™” | LL λ³€ν™” | μƒνƒ |
|------|--------------|---------|------|
| 21 | 1.216977e+00 | -351.5337 | μ•…ν™” |
| 22 | 3.634876e-01 | -30.3703 | μ•…ν™” |
| 23 | 1.080176e-01 | -2.8521 | μ•…ν™” |
| 24 | 3.285449e-02 | -0.3305 | μ•…ν™” |
| 25 | 1.069846e-02 | -0.0443 | μ•…ν™” |

**κ΄€μ°°**:
- Step sizeλ¥Ό μ μ§„μ μΌλ΅ μ¤„μ΄λ©° λ³µκµ¬ μ‹λ„
- λ¨λ‘ LL μ•…ν™” (κ°μ„  μ‹¤ν¨)
- μ‹λ„ 25μ—μ„ κ±°μ μ›λ μμ¤€μΌλ΅ λ³µκ·€

---

### **[Phase 5] μ‹λ„ 26-39: μ¬μλ ΄**

| μ§€ν‘ | κ°’ |
|------|-----|
| νλΌλ―Έν„° λ³€ν™” | 5.907939e-03 β†’ 6.640882e-03 |
| LL λ³€ν™” | +0.0020 β†’ +0.0135 |
| μµμΆ… μλ ΄κ°’ | **6.640882e-03** (Phase 1κ³Ό λ™μΌ!) |

**κ΄€μ°°**:
- μ‹λ„ 26-29: λ‹¤μ‹ μλ ΄ κ³Όμ •
- μ‹λ„ 30-39: **Phase 1κ³Ό μ™„μ „ν λ™μΌν• κ°’μΌλ΅ μ¬μλ ΄**
- **10ν μ—°μ† μ™„μ „ν λ™μΌν• κ²°κ³Ό**

---

## π― κ²°λ΅ : maxls μ¦κ°€μ ν¨κ³Ό μμΈ΅

### β **maxls μ¦κ°€λ” ν¨κ³Όκ°€ μ—†μ„ κ²ƒμΌλ΅ μμƒλ©λ‹λ‹¤.**

### **κ·Όκ±°**

#### **1. μλ ΄ μ™„λ£ (Phase 1 & Phase 5)**

- μ‹λ„ 10-19: **9ν μ—°μ† λ™μΌν• κ²°κ³Ό**
- μ‹λ„ 30-39: **10ν μ—°μ† λ™μΌν• κ²°κ³Ό**
- νλΌλ―Έν„° λ³€ν™”λ‰: **6.640882e-03** (μ†μμ  7μλ¦¬κΉμ§€ λ™μΌ)
- LL λ³€ν™”: **+0.0135** (μ™„μ „ λ™μΌ)

**β†’ μμΉμ μΌλ΅ μ™„μ „ν μλ ΄ν–μΌλ©°, λ” λ§μ€ μ‹λ„λ¥Ό ν•΄λ„ λ™μΌν• κ²°κ³Όκ°€ λ°λ³µλ  κ²ƒ**

---

#### **2. ν° step size μ‹λ„ μ‹¤ν¨ (Phase 3 & Phase 4)**

- μ‹λ„ 20: νλΌλ―Έν„° λ³€ν™” 3.78 β†’ LL λ€ν­ μ•…ν™” (-2675)
- μ‹λ„ 21-25: μ μ§„μ  λ³µκµ¬ μ‹λ„ β†’ λ¨λ‘ μ‹¤ν¨ (LL μ•…ν™”)

**β†’ ν° step sizeλ” μ¤νλ ¤ LLμ„ μ•…ν™”μ‹ν‚΄**

---

#### **3. μ¬μλ ΄ ν¨ν„΄ (Phase 5)**

- μ‹λ„ 26-39: Phase 1κ³Ό **μ™„μ „ν λ™μΌν• κ°’μΌλ΅ μ¬μλ ΄**
- νλΌλ―Έν„° λ³€ν™”λ‰: **6.640882e-03** (λ™μΌ)
- LL λ³€ν™”: **+0.0135** (λ™μΌ)

**β†’ Line Searchλ” μ΄λ―Έ μµμ„ μ step sizeλ¥Ό μ°Ύμ•μΌλ©°, λ‹¤λ¥Έ μ‹λ„λ¥Ό ν•΄λ„ κ²°κµ­ κ°™μ€ κ°’μΌλ΅ λμ•„μ΄**

---

#### **4. μμΉμ  μ¦κ±°**

| μ§€ν‘ | κ°’ | ν•΄μ„ |
|------|-----|------|
| **νλΌλ―Έν„° λ³€ν™” ν‘μ¤€νΈμ°¨ (μ‹λ„ 30-39)** | **< 1e-15** | μ™„μ „ μλ ΄ |
| **LL λ³€ν™” ν‘μ¤€νΈμ°¨ (μ‹λ„ 30-39)** | **0.0000** | μ™„μ „ μλ ΄ |
| **μµμ„  LL** | **-2052.4598** | λ³€ν™” μ—†μ |

---

## π’΅ **μ‹¤μ  λ¬Έμ μ **

### **λ¬Έμ λ” maxlsκ°€ μ•„λ‹λΌ νƒμƒ‰ λ°©ν–¥μ…λ‹λ‹¤.**

1. **Line Searchλ” μ •μƒ μ‘λ™ν•¨**
   - μµμ„ μ step size (6.640882e-03)λ¥Ό μ •ν™•ν μ°Ύμ
   - 40ν μ‹λ„ μ¤‘ 19νκ°€ λ™μΌν• κ°’μΌλ΅ μλ ΄

2. **νƒμƒ‰ λ°©ν–¥μ΄ μλ»λ¨**
   - μµμ„ μ step sizeλ΅λ„ LL κ°μ„ μ΄ **+0.0135**μ— λ¶κ³Ό
   - ν° step size (3.78)λ” LLμ„ λ€ν­ μ•…ν™”μ‹ν‚΄
   - **Hessian κ·Όμ‚¬κ°€ λ¶€μ •ν™•ν•μ—¬ descent directionμ΄ μλ»λμ—μ„ κ°€λ¥μ„±**

3. **ν‰νƒ„ν• μμ—­**
   - LL λ³€ν™”κ°€ λ§¤μ° μ‘μ (+0.0135)
   - ν•¨μκ°€ κ±°μ ν‰ν‰ν• μμ—­μ— λ„λ‹¬
   - **μ–΄λ–¤ step sizeλ„ ν° κ°μ„ μ„ κ°€μ Έμ¤μ§€ λ»ν•¨**

---

## π“‹ **κ¶μ¥ μ΅°μΉ**

### β **κ¶μ¥ν•μ§€ μ•μ**
- maxls μ¦κ°€ (20 β†’ 50) - **ν¨κ³Ό μ—†μ**

### β… **κ¶μ¥ν•¨**

1. **μ΄κΈ°κ°’ κ°μ„ ** (HIGH μ°μ„ μμ„)
   - μμ°¨μ¶”μ • 2λ‹¨κ³„ κ²°κ³Όλ¥Ό λ” μ •ν™•ν•κ² μ‚¬μ©
   - λ” λ‚μ€ μ΄κΈ°κ°’μΌλ΅ μ‹μ‘ν•μ—¬ λ‹¤λ¥Έ local minimum νƒμƒ‰

2. **μµμ ν™” μ•κ³ λ¦¬μ¦ λ³€κ²½** (HIGH μ°μ„ μμ„)
   - L-BFGS-B β†’ Trust Region (trust-constr)
   - Hessian κ·Όμ‚¬κ°€ λ¶€μ •ν™•ν•  λ• λ” robust

3. **μλ ΄ κΈ°μ¤€ μ™„ν™”** (MEDIUM μ°μ„ μμ„)
   - ν„μ¬ LL = -2052.46μ΄ μ‹¤μ§μ μΈ μµμ μ μΌ κ°€λ¥μ„±
   - gtol κΈ°μ¤€μ„ 1e-3 β†’ 1e-2λ΅ μ™„ν™”ν•μ—¬ μλ ΄ μΈμ •

---

**λ¶„μ„ μ™„λ£ μΌμ‹**: 2025-11-23  
**ν•µμ‹¬ κ²°λ΅ **: **maxls μ¦κ°€λ” ν¨κ³Ό μ—†μ. νƒμƒ‰ λ°©ν–¥ κ°μ„  ν•„μ”.**

