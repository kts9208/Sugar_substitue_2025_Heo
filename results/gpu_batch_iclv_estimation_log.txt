2025-11-12 21:47:15 - SimultaneousEstimator.estimate() 시작
2025-11-12 21:47:15 - 데이터 shape: (5904, 60)
2025-11-12 21:47:15 - 개인 수: 326
2025-11-12 21:47:15 - Halton draws 이미 설정됨 (건너뛰기)
2025-11-12 21:47:15 - Analytic gradient calculators 초기화 (Apollo 방식)...
2025-11-12 21:47:15 - 다중 잠재변수 측정모델 gradient 초기화: 5개 LV
2025-11-12 21:47:15 - 다중 잠재변수 구조모델 gradient 초기화
2025-11-12 21:47:15 - GPU 배치 그래디언트 활성화
2025-11-12 21:47:15 - 다중 잠재변수 JointGradient 초기화 완료
2025-11-12 21:47:15 - 초기 파라미터 설정 시작...
2025-11-12 21:47:15 - 초기 파라미터 설정 완료 (총 80개)
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - 파라미터 스케일링 비활성화
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - Custom Parameter Scaling Initialized (Gradient-Balanced)
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - Total parameters: 80
2025-11-12 21:47:15 - 
2025-11-12 21:47:15 - Scale factors:
2025-11-12 21:47:15 -   zeta_health_concern_q7        :     1.000000
2025-11-12 21:47:15 -   zeta_health_concern_q8        :     1.000000
2025-11-12 21:47:15 -   zeta_health_concern_q9        :     1.000000
2025-11-12 21:47:15 -   zeta_health_concern_q10       :     1.000000
2025-11-12 21:47:15 -   zeta_health_concern_q11       :     1.000000
2025-11-12 21:47:15 -   sigma_sq_health_concern_q6    :     1.000000
2025-11-12 21:47:15 -   sigma_sq_health_concern_q7    :     1.000000
2025-11-12 21:47:15 -   sigma_sq_health_concern_q8    :     1.000000
2025-11-12 21:47:15 -   sigma_sq_health_concern_q9    :     1.000000
2025-11-12 21:47:15 -   sigma_sq_health_concern_q10   :     1.000000
2025-11-12 21:47:15 -   sigma_sq_health_concern_q11   :     1.000000
2025-11-12 21:47:15 -   zeta_perceived_benefit_q13    :     1.000000
2025-11-12 21:47:15 -   zeta_perceived_benefit_q14    :     1.000000
2025-11-12 21:47:15 -   zeta_perceived_benefit_q15    :     1.000000
2025-11-12 21:47:15 -   zeta_perceived_benefit_q16    :     1.000000
2025-11-12 21:47:15 -   zeta_perceived_benefit_q17    :     1.000000
2025-11-12 21:47:15 -   sigma_sq_perceived_benefit_q12:     1.000000
2025-11-12 21:47:15 -   sigma_sq_perceived_benefit_q13:     1.000000
2025-11-12 21:47:15 -   sigma_sq_perceived_benefit_q14:     1.000000
2025-11-12 21:47:15 -   sigma_sq_perceived_benefit_q15:     1.000000
2025-11-12 21:47:15 -   sigma_sq_perceived_benefit_q16:     1.000000
2025-11-12 21:47:15 -   sigma_sq_perceived_benefit_q17:     1.000000
2025-11-12 21:47:15 -   zeta_perceived_price_q28      :     1.000000
2025-11-12 21:47:15 -   zeta_perceived_price_q29      :     1.000000
2025-11-12 21:47:15 -   sigma_sq_perceived_price_q27  :     1.000000
2025-11-12 21:47:15 -   sigma_sq_perceived_price_q28  :     1.000000
2025-11-12 21:47:15 -   sigma_sq_perceived_price_q29  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q31  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q32  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q33  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q34  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q35  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q36  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q37  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q38  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q39  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q40  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q41  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q42  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q43  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q44  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q45  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q46  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q47  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q48  :     1.000000
2025-11-12 21:47:15 -   zeta_nutrition_knowledge_q49  :     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q30:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q31:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q32:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q33:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q34:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q35:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q36:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q37:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q38:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q39:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q40:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q41:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q42:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q43:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q44:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q45:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q46:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q47:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q48:     1.000000
2025-11-12 21:47:15 -   sigma_sq_nutrition_knowledge_q49:     1.000000
2025-11-12 21:47:15 -   zeta_purchase_intention_q19   :     1.000000
2025-11-12 21:47:15 -   zeta_purchase_intention_q20   :     1.000000
2025-11-12 21:47:15 -   sigma_sq_purchase_intention_q18:     1.000000
2025-11-12 21:47:15 -   sigma_sq_purchase_intention_q19:     1.000000
2025-11-12 21:47:15 -   sigma_sq_purchase_intention_q20:     1.000000
2025-11-12 21:47:15 -   gamma_health_concern_to_perceived_benefit:     1.000000
2025-11-12 21:47:15 -   gamma_perceived_benefit_to_purchase_intention:     1.000000
2025-11-12 21:47:15 -   beta_intercept                :     1.000000
2025-11-12 21:47:15 -   beta_sugar_free               :     1.000000
2025-11-12 21:47:15 -   beta_health_label             :     1.000000
2025-11-12 21:47:15 -   beta_price                    :     1.000000
2025-11-12 21:47:15 -   lambda_main                   :     1.000000
2025-11-12 21:47:15 -   lambda_mod_perceived_price    :     1.000000
2025-11-12 21:47:15 -   lambda_mod_nutrition_knowledge:     1.000000
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - 파라미터 bounds 계산 시작...
2025-11-12 21:47:15 - 파라미터 bounds 계산 완료 (총 80개)
2025-11-12 21:47:15 - 최대 반복 횟수: 1000
2025-11-12 21:47:15 - ======================================================================
2025-11-12 21:47:15 - 순차처리 사용
2025-11-12 21:47:15 - 최적화 시작: BFGS (gradient-based)
2025-11-12 21:47:15 - Analytic gradient 사용 (Apollo 방식)
2025-11-12 21:47:15 - 조기 종료 비활성화 (정상 종료만 사용)
2025-11-12 21:47:15 - BFGS 옵션: c1=0.0001, c2=0.9 (scipy 기본값)
2025-11-12 21:47:15 - [Major Iteration #1 시작] [단계 1/2] 전체 우도 계산
2025-11-12 21:47:15 -   측정모델 health_concern: zeta[0]=1.0000, sigma_sq[0]=0.2428
2025-11-12 21:47:15 -   구조모델 (계층적): gamma_health_concern_to_perceived_benefit=0.510461
2025-11-12 21:47:15 -   선택모델 (조절): intercept=-0.020155, lambda_main=0.445158, lambda_mod_perceived_price=-1.496759
2025-11-12 21:47:15 - 
================================================================================
2025-11-12 21:47:15 - Iteration 1 - 파라미터 값
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - 
[측정모델 파라미터]
2025-11-12 21:47:15 -   health_concern:
2025-11-12 21:47:15 -     - zeta: [1.       1.821545 1.817093 2.004141 2.042785 1.79169 ]
2025-11-12 21:47:15 -     - sigma_sq: [0.242753 0.307487 0.318766 0.374413 0.497122 0.280641]
2025-11-12 21:47:15 -   perceived_benefit:
2025-11-12 21:47:15 -     - zeta: [1.       0.912519 1.028369 1.180854 1.089028 0.936935]
2025-11-12 21:47:15 -     - sigma_sq: [0.400324 0.347557 0.343263 0.391935 0.384655 0.338511]
2025-11-12 21:47:15 -   perceived_price:
2025-11-12 21:47:15 -     - zeta: [1.       1.626653 1.744699]
2025-11-12 21:47:15 -     - sigma_sq: [0.625037 0.627247 0.614678]
2025-11-12 21:47:15 -   nutrition_knowledge:
2025-11-12 21:47:15 -     - zeta: [1.       1.127794 1.260891 1.087865 1.24954  1.303558 1.305639 1.106603
 1.183989 1.255195 1.028991 1.262609 1.261023 1.274052 1.28539  1.275248
 1.191841 0.859048 1.160671 1.045778]
2025-11-12 21:47:15 -     - sigma_sq: [0.251034 0.176283 0.207327 0.19267  0.292034 0.240615 0.274186 0.194213
 0.268437 0.238901 0.202389 0.276854 0.326    0.331827 0.230682 0.283563
 0.207114 0.187191 0.184124 0.191217]
2025-11-12 21:47:15 -   purchase_intention:
2025-11-12 21:47:15 -     - zeta: [1.       1.033757 1.056102]
2025-11-12 21:47:15 -     - sigma_sq: [1.3463   1.305794 1.290706]
2025-11-12 21:47:15 - 
[구조모델 파라미터]
2025-11-12 21:47:15 -   gamma_health_concern_to_perceived_benefit: 0.510461
2025-11-12 21:47:15 -   gamma_perceived_benefit_to_purchase_intention: 0.498259
2025-11-12 21:47:15 - 
[선택모델 파라미터]
2025-11-12 21:47:15 -   intercept: -0.020155
2025-11-12 21:47:15 -   beta: [ 0.232747  0.226071 -0.260845]
2025-11-12 21:47:15 -   lambda_main: 0.445158
2025-11-12 21:47:15 -   lambda_mod_perceived_price: -1.496759
2025-11-12 21:47:15 -   lambda_mod_nutrition_knowledge: 1.051328
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - [구조모델 예측 - 계층적] Draw 0:
2025-11-12 21:47:15 -   1차 LV draws: [ 1.08487588  0.20294383  0.5096311  -0.59612644]
2025-11-12 21:47:15 -   2차+ LV 오차항: {'perceived_benefit': np.float64(-0.36041696003451673), 'purchase_intention': np.float64(-0.657946188246317)}
2025-11-12 21:47:15 -   예측된 LV: {'health_concern': np.float64(1.0848758785868928), 'perceived_benefit': np.float64(0.19336986582482718), 'perceived_price': np.float64(0.5096311039206235), 'nutrition_knowledge': np.float64(-0.5961264423199637), 'purchase_intention': np.float64(-0.5615979122703044)}
2025-11-12 21:47:15 - 
[측정모델 우도 계산 시작]
2025-11-12 21:47:15 -   개인 데이터 shape: (18, 60)
2025-11-12 21:47:15 -   LV 개수: 100
2025-11-12 21:47:15 -   측정모델 우도 (처음 5개): [-1170.04509629 -1208.51680234 -1596.1715621  -1207.1098531
  -257.54447575]
2025-11-12 21:47:15 -   측정모델 우도 범위: [-2235.78, -257.54]
2025-11-12 21:47:15 -   측정모델 우도 평균: -1112.94
2025-11-12 21:47:15 - 
[선택모델 우도 계산 시작]
2025-11-12 21:47:15 -   선택 상황 수: 18
2025-11-12 21:47:15 -   선택모델 우도 (처음 5개): [-7.45999045 -9.16219666 -7.5136732  -7.56229116 -7.43761923]
2025-11-12 21:47:15 -   선택모델 우도 범위: [-138.16, -7.43]
2025-11-12 21:47:15 -   선택모델 우도 평균: -19.34
2025-11-12 21:47:15 - 
[구조모델 우도 계산 시작]
2025-11-12 21:47:15 -   경로 health_concern->perceived_benefit: 예측=0.5538, 실제=0.1934, LL=-0.9839
2025-11-12 21:47:15 -   경로 perceived_benefit->purchase_intention: 예측=0.0963, 실제=-0.5616, LL=-1.1354
2025-11-12 21:47:15 -   구조모델 우도 (처음 5개): [-2.11927385 -2.04127131 -2.79230332 -2.4302223  -2.66043318]
2025-11-12 21:47:15 -   구조모델 우도 범위: [-6.95, -1.85]
2025-11-12 21:47:15 -   구조모델 우도 평균: -2.83
2025-11-12 21:47:15 - 
[결합 우도 계산] Draw 0:
2025-11-12 21:47:15 -   측정모델: -1170.0451
2025-11-12 21:47:15 -   선택모델: -7.4600
2025-11-12 21:47:15 -   구조모델: -2.1193
2025-11-12 21:47:15 -   합계: -1179.6244
2025-11-12 21:47:15 - 
[전체 draws 통계]
2025-11-12 21:47:15 -   Draw 우도 범위: [-2287.54, -267.64]
2025-11-12 21:47:15 -   Draw 우도 평균: -1135.11
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - 두 번째 함수 호출 - 파라미터 변화 확인
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:47:15 - [파라미터 확인]
2025-11-12 21:47:15 -   측정모델 zeta (health_concern 처음 3개): [1.       1.821545 1.817093]
2025-11-12 21:47:15 -   구조모델 (계층적) gamma_health_concern_to_perceived_benefit: 0.510461
2025-11-12 21:47:15 -   선택모델 intercept: -0.020155
2025-11-12 21:47:15 -   선택모델 beta: [ 0.232747  0.226071 -0.260845]
2025-11-12 21:47:15 -   선택모델 lambda_main: 0.445158
2025-11-12 21:47:15 -   선택모델 lambda_mod_perceived_price: -1.496759
2025-11-12 21:47:15 -   선택모델 lambda_mod_nutrition_knowledge: 1.051328
2025-11-12 21:47:15 - ================================================================================
2025-11-12 21:48:36 -   LL =  -84776.3081 (Best:  -84776.3081) [NEW BEST]
2025-11-12 21:48:36 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-12 21:48:36 -   측정모델 health_concern: zeta[0]=1.0000, sigma_sq[0]=0.2428
2025-11-12 21:48:36 -   구조모델 (계층적): gamma_health_concern_to_perceived_benefit=0.510461
2025-11-12 21:48:36 -   선택모델 (조절): intercept=-0.020155, lambda_main=0.445158, lambda_mod_perceived_price=-1.496759
2025-11-12 21:48:36 - [그래디언트 계산] Draw 0:
2025-11-12 21:48:36 -   higher_order_lvs: ['perceived_benefit', 'purchase_intention']
2025-11-12 21:48:36 -   higher_order_errors: [-0.36041696 -0.65794619]
2025-11-12 21:48:36 -   error_dict: {'perceived_benefit': np.float64(-0.36041696003451673), 'purchase_intention': np.float64(-0.657946188246317)}
2025-11-12 21:48:36 -   예측된 LV: {'health_concern': np.float64(1.0848758785868928), 'perceived_benefit': np.float64(0.19336986582482718), 'perceived_price': np.float64(0.5096311039206235), 'nutrition_knowledge': np.float64(-0.5961264423199637), 'purchase_intention': np.float64(-0.5615979122703044)}
2025-11-12 21:48:36 - 
[측정모델 그래디언트 계산]
2025-11-12 21:48:36 -   잠재변수: health_concern
2025-11-12 21:48:36 -     - 측정 방법: continuous_linear
2025-11-12 21:48:36 -     - 지표 수: 6
2025-11-12 21:48:36 -     - zeta (처음 3개): [1.       1.821545 1.817093]
2025-11-12 21:48:36 -     - LV 값 범위: [-2.9408, 2.5019]
2025-11-12 21:48:36 -     - LV 값 평균: -0.0111
2025-11-12 21:48:36 - 
    [지표 q6 계산 예시]
2025-11-12 21:48:36 -       - 관측값 y: 4.0000
2025-11-12 21:48:36 -       - zeta[0]: 1.000000
2025-11-12 21:48:36 -       - sigma_sq[0]: 0.242753
2025-11-12 21:48:36 -       - LV (draw 0): 1.0849
2025-11-12 21:48:36 -       - 예측값 (draw 0): 1.0849
2025-11-12 21:48:36 -       - 잔차 (draw 0): 2.9151
2025-11-12 21:48:36 - 
    [가중평균 적용 전후]
2025-11-12 21:48:36 -       - grad_zeta_batch (draw 0, 처음 3개): [234.50116440720393, 128.5298705580257, 63.01743289258616]
2025-11-12 21:48:36 -       - weights (처음 5개): [0.0, 0.0, 0.0, 0.0, 1.0]
2025-11-12 21:48:36 -       - grad_zeta_weighted (처음 3개): [293.70214797976513, -0.39270402482072436, -123.25901757215395]
2025-11-12 21:48:36 -       - grad_sigma_sq_weighted (처음 3개): [459.07067097702515, -29.268643090273777, 59.15016350050134]
2025-11-12 21:48:36 - 
  [health_concern] 최종 그래디언트:
2025-11-12 21:48:36 -     - grad_zeta: 범위=[-148.3685, 293.7021], norm=377.4153
2025-11-12 21:48:36 -     - grad_sigma_sq: 범위=[-29.2686, 459.0707], norm=479.9825
2025-11-12 21:48:36 - 
  [perceived_benefit] 최종 그래디언트:
2025-11-12 21:48:36 -     - grad_zeta: 범위=[12.1187, 179.8457], norm=329.1044
2025-11-12 21:48:36 -     - grad_sigma_sq: 범위=[-25.5811, 199.0577], norm=308.7763
2025-11-12 21:48:36 - 
  [perceived_price] 최종 그래디언트:
2025-11-12 21:48:36 -     - grad_zeta: 범위=[-241.4994, -200.6092], norm=389.6795
2025-11-12 21:48:36 -     - grad_sigma_sq: 범위=[635.5283, 927.2375], norm=1407.0079
2025-11-12 21:48:36 - 
  [nutrition_knowledge] 최종 그래디언트:
2025-11-12 21:48:36 -     - grad_zeta: 범위=[-221.5404, 523.2891], norm=1352.9620
2025-11-12 21:48:36 -     - grad_sigma_sq: 범위=[-31.8813, 1365.6564], norm=2674.0707
2025-11-12 21:48:36 - 
  [purchase_intention] 최종 그래디언트:
2025-11-12 21:48:36 -     - grad_zeta: 범위=[3.1911, 4.4640], norm=6.3965
2025-11-12 21:48:36 -     - grad_sigma_sq: 범위=[35.6006, 75.7728], norm=91.9283
2025-11-12 21:48:36 - 
[구조모델 그래디언트 계산]
2025-11-12 21:48:36 -   구조 유형: 계층적
2025-11-12 21:48:36 - 
  [경로 1] health_concern → perceived_benefit
2025-11-12 21:48:36 -     - gamma: 0.510461
2025-11-12 21:48:36 -     - predictor (draw 0): 1.0849
2025-11-12 21:48:36 -     - target (draw 0): 0.1934
2025-11-12 21:48:36 -     - 예측값 μ (draw 0): 0.5538
2025-11-12 21:48:36 -     - 잔차 (draw 0): -0.3604
2025-11-12 21:48:36 -     - 잔차 범위: [-2.6610, 2.6222]
2025-11-12 21:48:36 -     - target 값 (처음 5개 draws): [ 0.19336987 -0.79938438 -1.21844315 -1.54848603  2.01383198]
2025-11-12 21:48:36 -     - predictor 값 (처음 5개 draws): [ 1.08487588 -0.35575591  0.2819568  -1.22116549  2.19761389]
2025-11-12 21:48:36 -     - 잔차 (처음 5개 draws): [-0.36041696 -0.61778486 -1.3623711  -0.92512867  0.8920358 ]
2025-11-12 21:48:36 -     - grad_gamma_health_concern_to_perceived_benefit: 1.960350
2025-11-12 21:48:36 -     - grad_gamma_perceived_benefit_to_purchase_intention: -1.855989
2025-11-12 21:48:36 - 
[선택모델 그래디언트 계산]
2025-11-12 21:48:36 -   선택 상황 수: 18
2025-11-12 21:48:36 -   조절효과 모델:
2025-11-12 21:48:36 -     - intercept: -0.020155
2025-11-12 21:48:36 -     - beta: [ 0.232747  0.226071 -0.260845]
2025-11-12 21:48:36 -     - lambda_main: 0.445158
2025-11-12 21:48:36 -     - lambda_mod_perceived_price: -1.496759
2025-11-12 21:48:36 -     - lambda_mod_nutrition_knowledge: 1.051328
2025-11-12 21:48:36 - 
  [중간 계산 값 (draw 0, situation 0)]
2025-11-12 21:48:36 -     - V: 0.0842
2025-11-12 21:48:36 -     - Φ(V): 0.5335
2025-11-12 21:48:36 -     - φ(V): 0.3975
2025-11-12 21:48:36 -     - choice: 1
2025-11-12 21:48:36 -     - Mills ratio: 0.7451
2025-11-12 21:48:36 - 
  [최종 그래디언트]
2025-11-12 21:48:36 -     - grad_intercept: -5.986437
2025-11-12 21:48:36 -     - grad_beta: [ 1.31089706  0.05686346 -1.25958735]
2025-11-12 21:48:36 -     - grad_lambda_main: -0.489627
2025-11-12 21:48:36 -     - grad_lambda_mod_perceived_price: 0.642144
2025-11-12 21:48:36 -     - grad_lambda_mod_nutrition_knowledge: -1.135963
2025-11-12 21:49:28 - 
[Gradient 방향 검증 - External (원본)]
  Gradient norm: 7.611433e+05
  Gradient max: 3.529032e+05
  Gradient (처음 5개): [-18253.89225392 -17756.58835998 -12294.77690399  -9139.73872081
 -19872.79908359]
  Gradient (마지막 5개): [  229.86331337  3141.04353147  6367.54529057 13028.07065743
  1665.87004284]

2025-11-12 21:49:28 - 
[Gradient 방향 검증 - Internal (스케일됨)]
  Gradient norm: 7.611433e+05
  Gradient max: 3.529032e+05
  Gradient (처음 5개): [-18253.89225392 -17756.58835998 -12294.77690399  -9139.73872081
 -19872.79908359]
  Gradient (마지막 5개): [  229.86331337  3141.04353147  6367.54529057 13028.07065743
  1665.87004284]
  주의: scipy는 이 gradient를 사용하여 descent direction을 계산합니다.
       d = -H^(-1) · gradient이므로, gradient가 양수면 d는 음수 방향입니다.
2025-11-12 21:49:28 - 
2025-11-12 21:49:28 - Gradient Scaling Comparison:
2025-11-12 21:49:28 - --------------------------------------------------------------------------------
2025-11-12 21:49:28 - Parameter                       Grad(External)  Grad(Internal)        Scale
2025-11-12 21:49:28 - --------------------------------------------------------------------------------
2025-11-12 21:49:28 - zeta_health_concern_q7           -1.825389e+04   -1.825389e+04     1.000000
2025-11-12 21:49:28 - zeta_health_concern_q8           -1.775659e+04   -1.775659e+04     1.000000
2025-11-12 21:49:28 - zeta_health_concern_q9           -1.229478e+04   -1.229478e+04     1.000000
2025-11-12 21:49:28 - zeta_health_concern_q10          -9.139739e+03   -9.139739e+03     1.000000
2025-11-12 21:49:28 - zeta_health_concern_q11          -1.987280e+04   -1.987280e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_health_concern_q6       -3.529032e+05   -3.529032e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_health_concern_q7       -1.088446e+05   -1.088446e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_health_concern_q8       -9.696978e+04   -9.696978e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_health_concern_q9       -6.997217e+04   -6.997217e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_health_concern_q10      -4.260096e+04   -4.260096e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_health_concern_q11      -1.233205e+05   -1.233205e+05     1.000000
2025-11-12 21:49:28 - zeta_perceived_benefit_q13       -1.795601e+04   -1.795601e+04     1.000000
2025-11-12 21:49:28 - zeta_perceived_benefit_q14       -3.089211e+04   -3.089211e+04     1.000000
2025-11-12 21:49:28 - zeta_perceived_benefit_q15       -2.786677e+04   -2.786677e+04     1.000000
2025-11-12 21:49:28 - zeta_perceived_benefit_q16       -2.787358e+04   -2.787358e+04     1.000000
2025-11-12 21:49:28 - zeta_perceived_benefit_q17       -2.584090e+04   -2.584090e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_perceived_benefit_q12   -1.104406e+05   -1.104406e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_perceived_benefit_q13   -7.193581e+04   -7.193581e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_perceived_benefit_q14   -1.242093e+05   -1.242093e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_perceived_benefit_q15   -1.079425e+05   -1.079425e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_perceived_benefit_q16   -1.171723e+05   -1.171723e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_perceived_benefit_q17   -1.042776e+05   -1.042776e+05     1.000000
2025-11-12 21:49:28 - zeta_perceived_price_q28         -1.878028e+03   -1.878028e+03     1.000000
2025-11-12 21:49:28 - zeta_perceived_price_q29         -1.085927e+03   -1.085927e+03     1.000000
2025-11-12 21:49:28 - sigma_sq_perceived_price_q27     -8.271678e+04   -8.271678e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_perceived_price_q28     -7.005296e+04   -7.005296e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_perceived_price_q29     -7.654222e+04   -7.654222e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q31     -5.491760e+04   -5.491760e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q32     -5.392916e+04   -5.392916e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q33     -5.031567e+04   -5.031567e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q34     -4.315636e+04   -4.315636e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q35     -4.521613e+04   -4.521613e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q36     -3.978396e+04   -3.978396e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q37     -5.605621e+04   -5.605621e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q38     -4.797310e+04   -4.797310e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q39     -4.781558e+04   -4.781558e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q40     -5.424386e+04   -5.424386e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q41     -4.258621e+04   -4.258621e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q42     -4.057017e+04   -4.057017e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q43     -3.977679e+04   -3.977679e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q44     -4.733317e+04   -4.733317e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q45     -4.231180e+04   -4.231180e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q46     -5.007807e+04   -5.007807e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q47     -4.678930e+04   -4.678930e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q48     -5.635362e+04   -5.635362e+04     1.000000
2025-11-12 21:49:28 - zeta_nutrition_knowledge_q49     -5.757027e+04   -5.757027e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q30   -1.431366e+05   -1.431366e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q31   -1.475544e+05   -1.475544e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q32   -1.200630e+05   -1.200630e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q33   -1.517830e+05   -1.517830e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q34   -7.859711e+04   -7.859711e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q35   -9.521712e+04   -9.521712e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q36   -7.869255e+04   -7.869255e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q37   -1.528885e+05   -1.528885e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q38   -9.982459e+04   -9.982459e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q39   -1.061616e+05   -1.061616e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q40   -1.402192e+05   -1.402192e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q41   -8.043447e+04   -8.043447e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q42   -6.591541e+04   -6.591541e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q43   -6.149345e+04   -6.149345e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q44   -1.062654e+05   -1.062654e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q45   -8.040456e+04   -8.040456e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q46   -1.254906e+05   -1.254906e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q47   -1.402300e+05   -1.402300e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q48   -1.323798e+05   -1.323798e+05     1.000000
2025-11-12 21:49:28 - sigma_sq_nutrition_knowledge_q49   -1.539888e+05   -1.539888e+05     1.000000
2025-11-12 21:49:28 - zeta_purchase_intention_q19      -3.893190e+03   -3.893190e+03     1.000000
2025-11-12 21:49:28 - zeta_purchase_intention_q20      -4.138679e+03   -4.138679e+03     1.000000
2025-11-12 21:49:28 - sigma_sq_purchase_intention_q18   -1.411665e+04   -1.411665e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_purchase_intention_q19   -1.369131e+04   -1.369131e+04     1.000000
2025-11-12 21:49:28 - sigma_sq_purchase_intention_q20   -1.503989e+04   -1.503989e+04     1.000000
2025-11-12 21:49:28 - gamma_health_concern_to_perceived_benefit   -2.053257e+02   -2.053257e+02     1.000000
2025-11-12 21:49:28 - gamma_perceived_benefit_to_purchase_intention    1.584267e+01    1.584267e+01     1.000000
2025-11-12 21:49:28 - beta_intercept                    3.952996e+03    3.952996e+03     1.000000
2025-11-12 21:49:28 - beta_sugar_free                   2.295280e+02    2.295280e+02     1.000000
2025-11-12 21:49:28 - beta_health_label                 2.298633e+02    2.298633e+02     1.000000
2025-11-12 21:49:28 - beta_price                        3.141044e+03    3.141044e+03     1.000000
2025-11-12 21:49:28 - lambda_main                       6.367545e+03    6.367545e+03     1.000000
2025-11-12 21:49:28 - lambda_mod_perceived_price        1.302807e+04    1.302807e+04     1.000000
2025-11-12 21:49:28 - lambda_mod_nutrition_knowledge    1.665870e+03    1.665870e+03     1.000000
2025-11-12 21:49:28 - --------------------------------------------------------------------------------
2025-11-12 21:49:28 - External gradient norm: 7.611433e+05
2025-11-12 21:49:28 - Internal gradient norm: 7.611433e+05
2025-11-12 21:49:28 - External gradient max:  3.529032e+05
2025-11-12 21:49:28 - Internal gradient max:  3.529032e+05
2025-11-12 21:49:28 - --------------------------------------------------------------------------------
2025-11-12 21:49:28 - [Line Search 함수 호출 #iter1-1] [단계 1/2] 전체 우도 계산
2025-11-12 21:49:28 -   측정모델 health_concern: zeta[0]=1.0000, sigma_sq[0]=0.7110
2025-11-12 21:49:28 -   구조모델 (계층적): gamma_health_concern_to_perceived_benefit=0.510733
2025-11-12 21:49:28 -   선택모델 (조절): intercept=-0.025400, lambda_main=0.436709, lambda_mod_perceived_price=-1.514047
2025-11-12 21:49:28 - 
================================================================================
2025-11-12 21:49:28 - Iteration 2 - 파라미터 값
2025-11-12 21:49:28 - ================================================================================
2025-11-12 21:49:28 - 
[측정모델 파라미터]
2025-11-12 21:49:28 -   health_concern:
2025-11-12 21:49:28 -     - zeta: [1.         1.84576703 1.84065513 2.02045557 2.05491299 1.81806024]
2025-11-12 21:49:28 -     - sigma_sq: [0.7110383  0.45191841 0.44744017 0.46726266 0.5536514  0.44428128]
2025-11-12 21:49:28 -   perceived_benefit:
2025-11-12 21:49:28 -     - zeta: [1.         0.93634575 1.06936133 1.21783185 1.12601488 0.97122461]
2025-11-12 21:49:28 -     - sigma_sq: [0.54687326 0.44301232 0.50808271 0.53516944 0.54013691 0.47688234]
2025-11-12 21:49:28 -   perceived_price:
2025-11-12 21:49:28 -     - zeta: [1.         1.62914505 1.74613997]
2025-11-12 21:49:28 -     - sigma_sq: [0.73479814 0.72020387 0.71624579]
2025-11-12 21:49:28 -   nutrition_knowledge:
2025-11-12 21:49:28 -     - zeta: [1.         1.20066698 1.33245236 1.15463145 1.30680638 1.3635576
 1.35843037 1.18098686 1.24764697 1.31864394 1.10096995 1.31911883
 1.31485763 1.32683387 1.3481988  1.3313937  1.25829216 0.92113512
 1.23544951 1.12217094]
2025-11-12 21:49:28 -     - sigma_sq: [0.44096934 0.37208048 0.36664479 0.3940787  0.39632853 0.36696348
 0.37860718 0.39708858 0.40089936 0.37977231 0.38845305 0.38358663
 0.41346654 0.41342581 0.37169105 0.39025593 0.37363388 0.37326938
 0.35978559 0.39555266]
2025-11-12 21:49:28 -   purchase_intention:
2025-11-12 21:49:28 -     - zeta: [1.         1.03892307 1.06159383]
2025-11-12 21:49:28 -     - sigma_sq: [1.36503211 1.3239617  1.31066321]
2025-11-12 21:49:28 - 
[구조모델 파라미터]
2025-11-12 21:49:28 -   gamma_health_concern_to_perceived_benefit: 0.510733
2025-11-12 21:49:28 -   gamma_perceived_benefit_to_purchase_intention: 0.498238
2025-11-12 21:49:28 - 
[선택모델 파라미터]
2025-11-12 21:49:28 -   intercept: -0.025400
2025-11-12 21:49:28 -   beta: [ 0.23244243  0.22576598 -0.26501301]
2025-11-12 21:49:28 -   lambda_main: 0.436709
2025-11-12 21:49:28 -   lambda_mod_perceived_price: -1.514047
2025-11-12 21:49:28 -   lambda_mod_nutrition_knowledge: 1.049117
2025-11-12 21:49:28 - ================================================================================
2025-11-12 21:50:50 -   LL =  -61145.7863 (Best:  -61145.7863) [NEW BEST]
2025-11-12 21:50:50 -   파라미터 변화량 (L2 norm): 1.010000e+00
  함수값 변화: +23630.5218 (감소)
2025-11-12 21:50:50 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-12 21:51:41 - 
[탐색 방향 분석 - Iteration #1]
  탐색 방향 d norm: 1.010000e+00
  탐색 방향 d max: 4.682853e-01
  Gradient norm: 2.823966e+05
  d와 -grad의 코사인 유사도: 0.883775
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.02422203 0.02356213 0.01631457 0.01212799 0.02637024]
  -grad 상위 5개: [12149.15672049 12373.91960411  9683.50684955  8362.43741981
 12228.72633605]
  → Hessian이 방향을 조정함

2025-11-12 21:51:41 - [Line Search 함수 호출 #iter2-2] [단계 1/2] 전체 우도 계산
2025-11-12 21:51:41 - 
================================================================================
2025-11-12 21:51:41 - Iteration 3 - 파라미터 값
2025-11-12 21:51:41 - ================================================================================
2025-11-12 21:51:41 - 
[측정모델 파라미터]
2025-11-12 21:51:41 -   health_concern:
2025-11-12 21:51:41 -     - zeta: [1.         1.84576703 1.84065513 2.02045557 2.05491299 1.81806024]
2025-11-12 21:51:41 -     - sigma_sq: [0.7110383  0.45191841 0.44744017 0.46726266 0.5536514  0.44428128]
2025-11-12 21:51:41 -   perceived_benefit:
2025-11-12 21:51:41 -     - zeta: [1.         0.93634575 1.06936133 1.21783185 1.12601488 0.97122461]
2025-11-12 21:51:41 -     - sigma_sq: [0.54687326 0.44301232 0.50808271 0.53516944 0.54013691 0.47688234]
2025-11-12 21:51:41 -   perceived_price:
2025-11-12 21:51:41 -     - zeta: [1.         1.62914505 1.74613997]
2025-11-12 21:51:41 -     - sigma_sq: [0.73479814 0.72020387 0.71624579]
2025-11-12 21:51:41 -   nutrition_knowledge:
2025-11-12 21:51:41 -     - zeta: [1.         1.20066698 1.33245236 1.15463145 1.30680638 1.3635576
 1.35843037 1.18098686 1.24764697 1.31864394 1.10096995 1.31911883
 1.31485763 1.32683387 1.3481988  1.3313937  1.25829216 0.92113512
 1.23544951 1.12217094]
2025-11-12 21:51:41 -     - sigma_sq: [0.44096934 0.37208048 0.36664479 0.3940787  0.39632853 0.36696348
 0.37860718 0.39708858 0.40089936 0.37977231 0.38845305 0.38358663
 0.41346654 0.41342581 0.37169105 0.39025593 0.37363388 0.37326938
 0.35978559 0.39555266]
2025-11-12 21:51:41 -   purchase_intention:
2025-11-12 21:51:41 -     - zeta: [1.         1.03892307 1.06159383]
2025-11-12 21:51:41 -     - sigma_sq: [1.36503211 1.3239617  1.31066321]
2025-11-12 21:51:41 - 
[구조모델 파라미터]
2025-11-12 21:51:41 -   gamma_health_concern_to_perceived_benefit: 0.510733
2025-11-12 21:51:41 -   gamma_perceived_benefit_to_purchase_intention: 0.498238
2025-11-12 21:51:41 - 
[선택모델 파라미터]
2025-11-12 21:51:41 -   intercept: -0.025400
2025-11-12 21:51:41 -   beta: [ 0.23244243  0.22576598 -0.26501301]
2025-11-12 21:51:41 -   lambda_main: 0.436709
2025-11-12 21:51:41 -   lambda_mod_perceived_price: -1.514047
2025-11-12 21:51:41 -   lambda_mod_nutrition_knowledge: 1.049117
2025-11-12 21:51:41 - ================================================================================
2025-11-12 21:53:02 -   LL =  -61145.7863 (Best:  -61145.7863) 
2025-11-12 21:53:02 -   파라미터 변화량 (L2 norm): 1.010000e+00
  함수값 변화: +23630.5218 (감소)
2025-11-12 21:53:02 - [단계 2/2] Analytic Gradient 계산 #iter1-3
2025-11-12 21:53:54 - ======================================================================
2025-11-12 21:53:54 - ICLV 모델 추정 시작
2025-11-12 21:53:54 - ======================================================================
2025-11-12 21:53:54 - [단계 2/2] Analytic Gradient 계산 #iter1-3
2025-11-12 21:54:45 - 
================================================================================
[Major Iteration #1 완료]
  최종 LL: -61145.7863
  Line Search: 2회 함수 호출 - ✓ 성공 (함수값 감소: 23630.5218)
  함수 호출: 2회 (누적)
  그래디언트 호출: 2회 (누적)
  수렴 조건:
    - ftol = N/A (첫 iteration)
    - gtol = 5.355519e+04 (기준: 1e-3)

  전체 파라미터 값 및 그래디언트:
    [ 0] zeta_health_concern_q7                            : param=+1.845767e+00, grad=-1.214916e+04
    [ 1] zeta_health_concern_q8                            : param=+1.840655e+00, grad=-1.237392e+04
    [ 2] zeta_health_concern_q9                            : param=+2.020456e+00, grad=-9.683507e+03
    [ 3] zeta_health_concern_q10                           : param=+2.054913e+00, grad=-8.362437e+03
    [ 4] zeta_health_concern_q11                           : param=+1.818060e+00, grad=-1.222873e+04
    [ 5] sigma_sq_health_concern_q6                        : param=+7.110383e-01, grad=-3.742800e+04
    [ 6] sigma_sq_health_concern_q7                        : param=+4.519184e-01, grad=-4.381606e+04
    [ 7] sigma_sq_health_concern_q8                        : param=+4.474402e-01, grad=-4.285657e+04
    [ 8] sigma_sq_health_concern_q9                        : param=+4.672627e-01, grad=-3.965799e+04
    [ 9] sigma_sq_health_concern_q10                       : param=+5.536514e-01, grad=-3.016167e+04
    [10] sigma_sq_health_concern_q11                       : param=+4.442813e-01, grad=-4.212131e+04
    [11] zeta_perceived_benefit_q13                        : param=+9.363458e-01, grad=-1.422106e+04
    [12] zeta_perceived_benefit_q14                        : param=+1.069361e+00, grad=-2.091839e+04
    [13] zeta_perceived_benefit_q15                        : param=+1.217832e+00, grad=-2.051746e+04
    [14] zeta_perceived_benefit_q16                        : param=+1.126015e+00, grad=-1.985174e+04
    [15] zeta_perceived_benefit_q17                        : param=+9.712246e-01, grad=-1.843316e+04
    [16] sigma_sq_perceived_benefit_q12                    : param=+5.468733e-01, grad=-5.355519e+04
    [17] sigma_sq_perceived_benefit_q13                    : param=+4.430123e-01, grad=-3.808736e+04
    [18] sigma_sq_perceived_benefit_q14                    : param=+5.080827e-01, grad=-4.862021e+04
    [19] sigma_sq_perceived_benefit_q15                    : param=+5.351694e-01, grad=-5.013284e+04
    [20] sigma_sq_perceived_benefit_q16                    : param=+5.401369e-01, grad=-5.246717e+04
    [21] sigma_sq_perceived_benefit_q17                    : param=+4.768823e-01, grad=-4.527782e+04
    [22] zeta_perceived_price_q28                          : param=+1.629145e+00, grad=-5.283415e+03
    [23] zeta_perceived_price_q29                          : param=+1.746140e+00, grad=-4.435985e+03
    [24] sigma_sq_perceived_price_q27                      : param=+7.347981e-01, grad=-5.335258e+04
    [25] sigma_sq_perceived_price_q28                      : param=+7.202039e-01, grad=-4.320908e+04
    [26] sigma_sq_perceived_price_q29                      : param=+7.162458e-01, grad=-4.594083e+04
    [27] zeta_nutrition_knowledge_q31                      : param=+1.200667e+00, grad=-2.376645e+04
    [28] zeta_nutrition_knowledge_q32                      : param=+1.332452e+00, grad=-2.866563e+04
    [29] zeta_nutrition_knowledge_q33                      : param=+1.154631e+00, grad=-2.239062e+04
    [30] zeta_nutrition_knowledge_q34                      : param=+1.306806e+00, grad=-3.065738e+04
    [31] zeta_nutrition_knowledge_q35                      : param=+1.363558e+00, grad=-2.869706e+04
    [32] zeta_nutrition_knowledge_q36                      : param=+1.358430e+00, grad=-2.879261e+04
    [33] zeta_nutrition_knowledge_q37                      : param=+1.180987e+00, grad=-2.505648e+04
    [34] zeta_nutrition_knowledge_q38                      : param=+1.247647e+00, grad=-3.064886e+04
    [35] zeta_nutrition_knowledge_q39                      : param=+1.318644e+00, grad=-2.862255e+04
    [36] zeta_nutrition_knowledge_q40                      : param=+1.100970e+00, grad=-2.542403e+04
    [37] zeta_nutrition_knowledge_q41                      : param=+1.319119e+00, grad=-2.998113e+04
    [38] zeta_nutrition_knowledge_q42                      : param=+1.314858e+00, grad=-3.094380e+04
    [39] zeta_nutrition_knowledge_q43                      : param=+1.326834e+00, grad=-3.118924e+04
    [40] zeta_nutrition_knowledge_q44                      : param=+1.348199e+00, grad=-2.824294e+04
    [41] zeta_nutrition_knowledge_q45                      : param=+1.331394e+00, grad=-3.034788e+04
    [42] zeta_nutrition_knowledge_q46                      : param=+1.258292e+00, grad=-2.634261e+04
    [43] zeta_nutrition_knowledge_q47                      : param=+9.211351e-01, grad=-2.084067e+04
    [44] zeta_nutrition_knowledge_q48                      : param=+1.235450e+00, grad=-2.691217e+04
    [45] zeta_nutrition_knowledge_q49                      : param=+1.122171e+00, grad=-2.521994e+04
    [46] sigma_sq_nutrition_knowledge_q30                  : param=+4.409693e-01, grad=-5.069131e+04
    [47] sigma_sq_nutrition_knowledge_q31                  : param=+3.720805e-01, grad=-3.136301e+04
    [48] sigma_sq_nutrition_knowledge_q32                  : param=+3.666448e-01, grad=-3.807148e+04
    [49] sigma_sq_nutrition_knowledge_q33                  : param=+3.940787e-01, grad=-3.553868e+04
    [50] sigma_sq_nutrition_knowledge_q34                  : param=+3.963285e-01, grad=-4.447822e+04
    [51] sigma_sq_nutrition_knowledge_q35                  : param=+3.669635e-01, grad=-4.262550e+04
    [52] sigma_sq_nutrition_knowledge_q36                  : param=+3.786072e-01, grad=-4.213560e+04
    [53] sigma_sq_nutrition_knowledge_q37                  : param=+3.970886e-01, grad=-3.439251e+04
    [54] sigma_sq_nutrition_knowledge_q38                  : param=+4.008994e-01, grad=-4.424174e+04
    [55] sigma_sq_nutrition_knowledge_q39                  : param=+3.797723e-01, grad=-4.301953e+04
    [56] sigma_sq_nutrition_knowledge_q40                  : param=+3.884531e-01, grad=-3.653901e+04
    [57] sigma_sq_nutrition_knowledge_q41                  : param=+3.835866e-01, grad=-4.310185e+04
    [58] sigma_sq_nutrition_knowledge_q42                  : param=+4.134665e-01, grad=-4.358902e+04
    [59] sigma_sq_nutrition_knowledge_q43                  : param=+4.134258e-01, grad=-4.183974e+04
    [60] sigma_sq_nutrition_knowledge_q44                  : param=+3.716911e-01, grad=-4.175628e+04
    [61] sigma_sq_nutrition_knowledge_q45                  : param=+3.902559e-01, grad=-4.268612e+04
    [62] sigma_sq_nutrition_knowledge_q46                  : param=+3.736339e-01, grad=-3.724413e+04
    [63] sigma_sq_nutrition_knowledge_q47                  : param=+3.732694e-01, grad=-3.308579e+04
    [64] sigma_sq_nutrition_knowledge_q48                  : param=+3.597856e-01, grad=-3.161229e+04
    [65] sigma_sq_nutrition_knowledge_q49                  : param=+3.955527e-01, grad=-3.296491e+04
    [66] zeta_purchase_intention_q19                       : param=+1.038923e+00, grad=-5.175280e+03
    [67] zeta_purchase_intention_q20                       : param=+1.061594e+00, grad=-5.507155e+03
    [68] sigma_sq_purchase_intention_q18                   : param=+1.365032e+00, grad=-1.271383e+04
    [69] sigma_sq_purchase_intention_q19                   : param=+1.323962e+00, grad=-1.223659e+04
    [70] sigma_sq_purchase_intention_q20                   : param=+1.310663e+00, grad=-1.338632e+04
    [71] gamma_health_concern_to_perceived_benefit         : param=+5.107335e-01, grad=-2.304921e+02
    [72] gamma_perceived_benefit_to_purchase_intention     : param=+4.982380e-01, grad=+2.035731e+00
    [73] beta_intercept                                    : param=-2.540043e-02, grad=+3.573048e+03
    [74] beta_sugar_free                                   : param=+2.324424e-01, grad=+1.826477e+02
    [75] beta_health_label                                 : param=+2.257660e-01, grad=+1.378719e+02
    [76] beta_price                                        : param=-2.650130e-01, grad=+2.606455e+03
    [77] lambda_main                                       : param=+4.367086e-01, grad=+5.200966e+03
    [78] lambda_mod_perceived_price                        : param=-1.514047e+00, grad=+1.019668e+04
    [79] lambda_mod_nutrition_knowledge                    : param=+1.049117e+00, grad=+1.600370e+03

  Hessian 업데이트: 첫 iteration (초기 H = I)
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 21:54:45 - [Major Iteration #2 시작] [단계 1/2] 전체 우도 계산
2025-11-12 21:56:06 -   LL =  -58751.5346 (Best:  -58751.5346) [NEW BEST]
2025-11-12 21:56:06 - [단계 2/2] Analytic Gradient 계산 #iter1-1
2025-11-12 21:56:58 - [Line Search 함수 호출 #iter3-1] [단계 1/2] 전체 우도 계산
2025-11-12 21:58:19 -   LL =  -58751.5346 (Best:  -58751.5346) 
2025-11-12 21:58:19 -   파라미터 변화량 (L2 norm): 0.000000e+00
  함수값 변화: +0.0000 (증가)
2025-11-12 21:58:19 - [단계 2/2] Analytic Gradient 계산 #iter2-2
2025-11-12 21:59:12 - 
[탐색 방향 분석 - Iteration #3]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 2.549244e+05
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [11200.72803641 11254.87145337  8660.49664875  7639.69910865
 11512.87698314]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 21:59:12 - ======================================================================
2025-11-12 21:59:12 - ICLV 모델 추정 시작
2025-11-12 21:59:12 - ======================================================================
2025-11-12 21:59:12 - [단계 2/2] Analytic Gradient 계산 #iter2-2
2025-11-12 22:00:03 - 
[탐색 방향 분석 - Iteration #3]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 2.549244e+05
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [11200.72803641 11254.87145337  8660.49664875  7639.69910865
 11512.87698314]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 22:00:03 - [단계 2/2] Analytic Gradient 계산 #iter2-2
2025-11-12 22:00:55 - 
[탐색 방향 분석 - Iteration #3]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 2.549244e+05
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [11200.72803641 11254.87145337  8660.49664875  7639.69910865
 11512.87698314]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 22:00:55 - 
================================================================================
[Major Iteration #2 완료]
  최종 LL: -58751.5346
  Line Search: 1회 함수 호출 - ⚠️  정체 (함수값 변화 없음)
  함수 호출: 3회 (누적)
  그래디언트 호출: 3회 (누적)
  수렴 조건:
    - ftol = 3.915645e-02 (기준: 1e-3)
    - gtol = 5.380996e+04 (기준: 1e-3, 변화: +2.55e+02 [+0.5%])

  전체 파라미터 값 및 그래디언트:
    [ 0] zeta_health_concern_q7                            : param=+1.858597e+00, grad=-1.120073e+04
    [ 1] zeta_health_concern_q8                            : param=+1.854156e+00, grad=-1.125487e+04
    [ 2] zeta_health_concern_q9                            : param=+2.031854e+00, grad=-8.660497e+03
    [ 3] zeta_health_concern_q10                           : param=+2.065525e+00, grad=-7.639699e+03
    [ 4] zeta_health_concern_q11                           : param=+1.830194e+00, grad=-1.151288e+04
    [ 5] sigma_sq_health_concern_q6                        : param=+5.962681e-01, grad=-5.380996e+04
    [ 6] sigma_sq_health_concern_q7                        : param=+4.758184e-01, grad=-3.824916e+04
    [ 7] sigma_sq_health_concern_q8                        : param=+4.757531e-01, grad=-3.666370e+04
    [ 8] sigma_sq_health_concern_q9                        : param=+5.037396e-01, grad=-3.294562e+04
    [ 9] sigma_sq_health_concern_q10                       : param=+5.869150e-01, grad=-2.595300e+04
    [10] sigma_sq_health_concern_q11                       : param=+4.575385e-01, grad=-3.864335e+04
    [11] zeta_perceived_benefit_q13                        : param=+9.531372e-01, grad=-1.290469e+04
    [12] zeta_perceived_benefit_q14                        : param=+1.091731e+00, grad=-1.951348e+04
    [13] zeta_perceived_benefit_q15                        : param=+1.241038e+00, grad=-1.881337e+04
    [14] zeta_perceived_benefit_q16                        : param=+1.147994e+00, grad=-1.826385e+04
    [15] zeta_perceived_benefit_q17                        : param=+9.916547e-01, grad=-1.701501e+04
    [16] sigma_sq_perceived_benefit_q12                    : param=+5.878382e-01, grad=-4.547831e+04
    [17] sigma_sq_perceived_benefit_q13                    : param=+4.755821e-01, grad=-3.160322e+04
    [18] sigma_sq_perceived_benefit_q14                    : param=+5.328189e-01, grad=-4.254210e+04
    [19] sigma_sq_perceived_benefit_q15                    : param=+5.711452e-01, grad=-4.227618e+04
    [20] sigma_sq_perceived_benefit_q16                    : param=+5.756016e-01, grad=-4.458936e+04
    [21] sigma_sq_perceived_benefit_q17                    : param=+5.058434e-01, grad=-3.857202e+04
    [22] zeta_perceived_price_q28                          : param=+1.637876e+00, grad=-4.989983e+03
    [23] zeta_perceived_price_q29                          : param=+1.753726e+00, grad=-4.194367e+03
    [24] sigma_sq_perceived_price_q27                      : param=+7.898096e-01, grad=-4.577776e+04
    [25] sigma_sq_perceived_price_q28                      : param=+7.631637e-01, grad=-3.802682e+04
    [26] sigma_sq_perceived_price_q29                      : param=+7.608500e-01, grad=-4.023349e+04
    [27] zeta_nutrition_knowledge_q31                      : param=+1.215774e+00, grad=-2.454813e+04
    [28] zeta_nutrition_knowledge_q32                      : param=+1.357075e+00, grad=-2.704478e+04
    [29] zeta_nutrition_knowledge_q33                      : param=+1.169604e+00, grad=-2.267440e+04
    [30] zeta_nutrition_knowledge_q34                      : param=+1.340692e+00, grad=-2.641089e+04
    [31] zeta_nutrition_knowledge_q35                      : param=+1.392770e+00, grad=-2.538369e+04
    [32] zeta_nutrition_knowledge_q36                      : param=+1.390644e+00, grad=-2.497205e+04
    [33] zeta_nutrition_knowledge_q37                      : param=+1.197872e+00, grad=-2.549404e+04
    [34] zeta_nutrition_knowledge_q38                      : param=+1.279012e+00, grad=-2.726151e+04
    [35] zeta_nutrition_knowledge_q39                      : param=+1.346367e+00, grad=-2.577267e+04
    [36] zeta_nutrition_knowledge_q40                      : param=+1.119473e+00, grad=-2.507889e+04
    [37] zeta_nutrition_knowledge_q41                      : param=+1.352058e+00, grad=-2.595966e+04
    [38] zeta_nutrition_knowledge_q42                      : param=+1.350615e+00, grad=-2.644526e+04
    [39] zeta_nutrition_knowledge_q43                      : param=+1.363454e+00, grad=-2.671435e+04
    [40] zeta_nutrition_knowledge_q44                      : param=+1.375476e+00, grad=-2.559967e+04
    [41] zeta_nutrition_knowledge_q45                      : param=+1.365150e+00, grad=-2.636898e+04
    [42] zeta_nutrition_knowledge_q46                      : param=+1.280650e+00, grad=-2.519734e+04
    [43] zeta_nutrition_knowledge_q47                      : param=+9.350937e-01, grad=-2.100784e+04
    [44] zeta_nutrition_knowledge_q48                      : param=+1.255590e+00, grad=-2.689944e+04
    [45] zeta_nutrition_knowledge_q49                      : param=+1.138569e+00, grad=-2.600041e+04
    [46] sigma_sq_nutrition_knowledge_q30                  : param=+4.596672e-01, grad=-4.712995e+04
    [47] sigma_sq_nutrition_knowledge_q31                  : param=+3.529662e-01, grad=-3.475646e+04
    [48] sigma_sq_nutrition_knowledge_q32                  : param=+3.741549e-01, grad=-3.536771e+04
    [49] sigma_sq_nutrition_knowledge_q33                  : param=+3.804377e-01, grad=-3.804800e+04
    [50] sigma_sq_nutrition_knowledge_q34                  : param=+4.371766e-01, grad=-3.443974e+04
    [51] sigma_sq_nutrition_knowledge_q35                  : param=+3.957634e-01, grad=-3.489581e+04
    [52] sigma_sq_nutrition_knowledge_q36                  : param=+4.151012e-01, grad=-3.295798e+04
    [53] sigma_sq_nutrition_knowledge_q37                  : param=+3.807666e-01, grad=-3.720721e+04
    [54] sigma_sq_nutrition_knowledge_q38                  : param=+4.302727e-01, grad=-3.649704e+04
    [55] sigma_sq_nutrition_knowledge_q39                  : param=+4.036041e-01, grad=-3.657259e+04
    [56] sigma_sq_nutrition_knowledge_q40                  : param=+3.826643e-01, grad=-3.701897e+04
    [57] sigma_sq_nutrition_knowledge_q41                  : param=+4.209501e-01, grad=-3.368666e+04
    [58] sigma_sq_nutrition_knowledge_q42                  : param=+4.592764e-01, grad=-3.316698e+04
    [59] sigma_sq_nutrition_knowledge_q43                  : param=+4.583213e-01, grad=-3.173148e+04
    [60] sigma_sq_nutrition_knowledge_q44                  : param=+3.931477e-01, grad=-3.570194e+04
    [61] sigma_sq_nutrition_knowledge_q45                  : param=+4.268711e-01, grad=-3.352971e+04
    [62] sigma_sq_nutrition_knowledge_q46                  : param=+3.768010e-01, grad=-3.570292e+04
    [63] sigma_sq_nutrition_knowledge_q47                  : param=+3.611300e-01, grad=-3.512002e+04
    [64] sigma_sq_nutrition_knowledge_q48                  : param=+3.490215e-01, grad=-3.294414e+04
    [65] sigma_sq_nutrition_knowledge_q49                  : param=+3.760353e-01, grad=-3.599387e+04
    [66] zeta_purchase_intention_q19                       : param=+1.046407e+00, grad=-5.176972e+03
    [67] zeta_purchase_intention_q20                       : param=+1.069560e+00, grad=-5.492627e+03
    [68] sigma_sq_purchase_intention_q18                   : param=+1.381051e+00, grad=-1.228789e+04
    [69] sigma_sq_purchase_intention_q19                   : param=+1.339325e+00, grad=-1.178805e+04
    [70] sigma_sq_purchase_intention_q20                   : param=+1.327438e+00, grad=-1.287144e+04
    [71] gamma_health_concern_to_perceived_benefit         : param=+5.110502e-01, grad=-2.338898e+02
    [72] gamma_perceived_benefit_to_purchase_intention     : param=+4.982425e-01, grad=+3.311086e-02
    [73] beta_intercept                                    : param=-2.990975e-02, grad=+3.547340e+03
    [74] beta_sugar_free                                   : param=+2.322262e-01, grad=+1.739175e+02
    [75] beta_health_label                                 : param=+2.256322e-01, grad=+1.318852e+02
    [76] beta_price                                        : param=-2.681686e-01, grad=+2.559857e+03
    [77] lambda_main                                       : param=+4.304639e-01, grad=+5.130857e+03
    [78] lambda_mod_perceived_price                        : param=-1.526007e+00, grad=+1.002089e+04
    [79] lambda_mod_nutrition_knowledge                    : param=+1.047043e+00, grad=+1.519140e+03

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 2.507615e-01
    - y_k (gradient 변화) norm: 4.285158e+04
    - s_k^T · y_k: 9.884974e+03 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 1.011636e-04
    - s_k 상위 5개: [0.01282957 0.0135012  0.01139839 0.01061192 0.01213379]
    - y_k 상위 5개: [ 948.42868408 1119.04815074 1023.0102008   722.73831117  715.84935291]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 22:00:55 - [Major Iteration #3 시작] [단계 1/2] 전체 우도 계산
2025-11-12 22:02:15 -   LL =  -58470.6236 (Best:  -58470.6236) [NEW BEST]
2025-11-12 22:02:15 - [단계 2/2] Analytic Gradient 계산 #iter2-1
2025-11-12 22:03:06 - [Line Search 함수 호출 #iter3-1] [단계 1/2] 전체 우도 계산
2025-11-12 22:04:28 -   LL =  -57467.8039 (Best:  -57467.8039) [NEW BEST]
2025-11-12 22:04:28 -   파라미터 변화량 (L2 norm): 2.650544e-01
  함수값 변화: +1002.8197 (감소)
2025-11-12 22:04:28 - [단계 2/2] Analytic Gradient 계산 #iter2-2
2025-11-12 22:05:20 - 
[탐색 방향 분석 - Iteration #3]
  탐색 방향 d norm: 2.650544e-01
  탐색 방향 d max: 6.037226e-02
  Gradient norm: 2.516347e+05
  d와 -grad의 코사인 유사도: 0.223863
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.02184001 0.02106139 0.01640189 0.01852752 0.02356711]
  -grad 상위 5개: [10846.17336508 10843.06670319  8125.34091878  6713.36091442
 10888.82858771]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 3.313180e-01
    - 변화량 max: 7.546533e-02
    - 변화 상위 5개 인덱스: [45 44 27 33 36]
    - 변화 상위 5개 값: [0.07546533 0.07313693 0.07087739 0.07054995 0.06119602]

2025-11-12 22:05:20 - [Line Search 함수 호출 #iter4-2] [단계 1/2] 전체 우도 계산
2025-11-12 22:06:38 -   LL =  -57467.8039 (Best:  -57467.8039) 
2025-11-12 22:06:38 -   파라미터 변화량 (L2 norm): 2.650544e-01
  함수값 변화: +1002.8197 (감소)
2025-11-12 22:06:38 - [단계 2/2] Analytic Gradient 계산 #iter3-3
2025-11-12 22:07:29 - ======================================================================
2025-11-12 22:07:29 - ICLV 모델 추정 시작
2025-11-12 22:07:29 - ======================================================================
2025-11-12 22:07:29 - [단계 2/2] Analytic Gradient 계산 #iter3-3
2025-11-12 22:08:21 - [단계 2/2] Analytic Gradient 계산 #iter3-3
2025-11-12 22:09:12 - 
================================================================================
[Major Iteration #3 완료]
  최종 LL: -57467.8039
  Line Search: 2회 함수 호출 - ✓ 성공 (함수값 감소: 1002.8197)
  함수 호출: 5회 (누적)
  그래디언트 호출: 5회 (누적)
  수렴 조건:
    - ftol = 2.185017e-02 (기준: 1e-3, 변화: -1.73e-02 [-44.2%])
    - gtol = 6.368657e+04 (기준: 1e-3, 변화: +9.88e+03 [+18.4%])

  전체 파라미터 값 및 그래디언트:
    [ 0] zeta_health_concern_q7                            : param=+1.885897e+00, grad=-1.084617e+04
    [ 1] zeta_health_concern_q8                            : param=+1.880483e+00, grad=-1.084307e+04
    [ 2] zeta_health_concern_q9                            : param=+2.052356e+00, grad=-8.125341e+03
    [ 3] zeta_health_concern_q10                           : param=+2.088684e+00, grad=-6.713361e+03
    [ 4] zeta_health_concern_q11                           : param=+1.859653e+00, grad=-1.088883e+04
    [ 5] sigma_sq_health_concern_q6                        : param=+5.496430e-01, grad=-6.368657e+04
    [ 6] sigma_sq_health_concern_q7                        : param=+4.628575e-01, grad=-3.974690e+04
    [ 7] sigma_sq_health_concern_q8                        : param=+4.648222e-01, grad=-3.788189e+04
    [ 8] sigma_sq_health_concern_q9                        : param=+5.080178e-01, grad=-3.191521e+04
    [ 9] sigma_sq_health_concern_q10                       : param=+6.245241e-01, grad=-2.244277e+04
    [10] sigma_sq_health_concern_q11                       : param=+4.491439e-01, grad=-3.965273e+04
    [11] zeta_perceived_benefit_q13                        : param=+9.868904e-01, grad=-1.196554e+04
    [12] zeta_perceived_benefit_q14                        : param=+1.143891e+00, grad=-1.874852e+04
    [13] zeta_perceived_benefit_q15                        : param=+1.290134e+00, grad=-1.795143e+04
    [14] zeta_perceived_benefit_q16                        : param=+1.195126e+00, grad=-1.756064e+04
    [15] zeta_perceived_benefit_q17                        : param=+1.036539e+00, grad=-1.632916e+04
    [16] sigma_sq_perceived_benefit_q12                    : param=+5.856517e-01, grad=-4.545266e+04
    [17] sigma_sq_perceived_benefit_q13                    : param=+4.711404e-01, grad=-3.100177e+04
    [18] sigma_sq_perceived_benefit_q14                    : param=+5.146054e-01, grad=-4.335798e+04
    [19] sigma_sq_perceived_benefit_q15                    : param=+5.560089e-01, grad=-4.282429e+04
    [20] sigma_sq_perceived_benefit_q16                    : param=+5.592384e-01, grad=-4.547166e+04
    [21] sigma_sq_perceived_benefit_q17                    : param=+4.882142e-01, grad=-3.958682e+04
    [22] zeta_perceived_price_q28                          : param=+1.662018e+00, grad=-3.980784e+03
    [23] zeta_perceived_price_q29                          : param=+1.774898e+00, grad=-3.316247e+03
    [24] sigma_sq_perceived_price_q27                      : param=+8.417030e-01, grad=-4.126835e+04
    [25] sigma_sq_perceived_price_q28                      : param=+8.179243e-01, grad=-3.444603e+04
    [26] sigma_sq_perceived_price_q29                      : param=+8.119658e-01, grad=-3.681083e+04
    [27] zeta_nutrition_knowledge_q31                      : param=+1.286651e+00, grad=-1.992296e+04
    [28] zeta_nutrition_knowledge_q32                      : param=+1.415027e+00, grad=-2.514104e+04
    [29] zeta_nutrition_knowledge_q33                      : param=+1.230272e+00, grad=-1.886842e+04
    [30] zeta_nutrition_knowledge_q34                      : param=+1.379745e+00, grad=-2.768175e+04
    [31] zeta_nutrition_knowledge_q35                      : param=+1.433709e+00, grad=-2.625245e+04
    [32] zeta_nutrition_knowledge_q36                      : param=+1.431694e+00, grad=-2.570007e+04
    [33] zeta_nutrition_knowledge_q37                      : param=+1.268422e+00, grad=-2.119770e+04
    [34] zeta_nutrition_knowledge_q38                      : param=+1.326094e+00, grad=-2.746167e+04
    [35] zeta_nutrition_knowledge_q39                      : param=+1.391204e+00, grad=-2.583917e+04
    [36] zeta_nutrition_knowledge_q40                      : param=+1.180669e+00, grad=-2.168060e+04
    [37] zeta_nutrition_knowledge_q41                      : param=+1.392073e+00, grad=-2.694797e+04
    [38] zeta_nutrition_knowledge_q42                      : param=+1.391016e+00, grad=-2.691017e+04
    [39] zeta_nutrition_knowledge_q43                      : param=+1.407134e+00, grad=-2.686797e+04
    [40] zeta_nutrition_knowledge_q44                      : param=+1.422622e+00, grad=-2.554966e+04
    [41] zeta_nutrition_knowledge_q45                      : param=+1.408688e+00, grad=-2.695740e+04
    [42] zeta_nutrition_knowledge_q46                      : param=+1.339481e+00, grad=-2.244430e+04
    [43] zeta_nutrition_knowledge_q47                      : param=+9.898212e-01, grad=-1.755899e+04
    [44] zeta_nutrition_knowledge_q48                      : param=+1.328727e+00, grad=-2.266363e+04
    [45] zeta_nutrition_knowledge_q49                      : param=+1.214034e+00, grad=-2.160399e+04
    [46] sigma_sq_nutrition_knowledge_q30                  : param=+4.699782e-01, grad=-4.471598e+04
    [47] sigma_sq_nutrition_knowledge_q31                  : param=+3.662243e-01, grad=-2.706692e+04
    [48] sigma_sq_nutrition_knowledge_q32                  : param=+3.605387e-01, grad=-3.303264e+04
    [49] sigma_sq_nutrition_knowledge_q33                  : param=+3.960318e-01, grad=-3.113668e+04
    [50] sigma_sq_nutrition_knowledge_q34                  : param=+3.948379e-01, grad=-3.903226e+04
    [51] sigma_sq_nutrition_knowledge_q35                  : param=+3.575692e-01, grad=-3.908853e+04
    [52] sigma_sq_nutrition_knowledge_q36                  : param=+3.741840e-01, grad=-3.807517e+04
    [53] sigma_sq_nutrition_knowledge_q37                  : param=+3.931361e-01, grad=-3.003126e+04
    [54] sigma_sq_nutrition_knowledge_q38                  : param=+3.941774e-01, grad=-4.056304e+04
    [55] sigma_sq_nutrition_knowledge_q39                  : param=+3.736982e-01, grad=-3.880451e+04
    [56] sigma_sq_nutrition_knowledge_q40                  : param=+3.856767e-01, grad=-3.263184e+04
    [57] sigma_sq_nutrition_knowledge_q41                  : param=+3.786915e-01, grad=-3.908302e+04
    [58] sigma_sq_nutrition_knowledge_q42                  : param=+4.252733e-01, grad=-3.601141e+04
    [59] sigma_sq_nutrition_knowledge_q43                  : param=+4.266738e-01, grad=-3.375460e+04
    [60] sigma_sq_nutrition_knowledge_q44                  : param=+3.625826e-01, grad=-3.789200e+04
    [61] sigma_sq_nutrition_knowledge_q45                  : param=+3.869246e-01, grad=-3.825540e+04
    [62] sigma_sq_nutrition_knowledge_q46                  : param=+3.708005e-01, grad=-3.310066e+04
    [63] sigma_sq_nutrition_knowledge_q47                  : param=+3.717877e-01, grad=-2.971521e+04
    [64] sigma_sq_nutrition_knowledge_q48                  : param=+3.504250e-01, grad=-2.702495e+04
    [65] sigma_sq_nutrition_knowledge_q49                  : param=+3.817409e-01, grad=-2.999515e+04
    [66] zeta_purchase_intention_q19                       : param=+1.072057e+00, grad=-4.847148e+03
    [67] zeta_purchase_intention_q20                       : param=+1.096557e+00, grad=-5.122984e+03
    [68] sigma_sq_purchase_intention_q18                   : param=+1.428477e+00, grad=-1.144461e+04
    [69] sigma_sq_purchase_intention_q19                   : param=+1.384076e+00, grad=-1.090829e+04
    [70] sigma_sq_purchase_intention_q20                   : param=+1.375837e+00, grad=-1.184025e+04
    [71] gamma_health_concern_to_perceived_benefit         : param=+5.122018e-01, grad=-2.378080e+02
    [72] gamma_perceived_benefit_to_purchase_intention     : param=+4.982936e-01, grad=+5.320498e+00
    [73] beta_intercept                                    : param=-4.501938e-02, grad=+3.511677e+03
    [74] beta_sugar_free                                   : param=+2.316380e-01, grad=+1.574252e+02
    [75] beta_health_label                                 : param=+2.252707e-01, grad=+1.144487e+02
    [76] beta_price                                        : param=-2.782434e-01, grad=+2.461837e+03
    [77] lambda_main                                       : param=+4.100982e-01, grad=+5.024188e+03
    [78] lambda_mod_perceived_price                        : param=-1.564315e+00, grad=+9.781509e+03
    [79] lambda_mod_nutrition_knowledge                    : param=+1.041406e+00, grad=+1.222692e+03

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 3.313180e-01
    - y_k (gradient 변화) norm: 2.747595e+04
    - s_k^T · y_k: 5.518227e+03 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 1.812176e-04
    - s_k 상위 5개: [0.02730002 0.02632674 0.02050236 0.02315941 0.02945889]
    - y_k 상위 5개: [354.55467133 411.80475017 535.15572996 926.33819423 624.04839543]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 22:09:12 - [Major Iteration #4 시작] [단계 1/2] 전체 우도 계산
2025-11-12 22:10:29 -   LL =  -57314.6016 (Best:  -57314.6016) [NEW BEST]
2025-11-12 22:10:29 - [단계 2/2] Analytic Gradient 계산 #iter3-1
2025-11-12 22:11:20 - [Line Search 함수 호출 #iter4-1] [단계 1/2] 전체 우도 계산
2025-11-12 22:11:20 - 
================================================================================
2025-11-12 22:11:20 - Iteration 10 - 파라미터 값
2025-11-12 22:11:20 - ================================================================================
2025-11-12 22:11:20 - 
[측정모델 파라미터]
2025-11-12 22:11:20 -   health_concern:
2025-11-12 22:11:20 -     - zeta: [1.         1.90690861 1.90008302 2.06597446 2.10214892 1.88100392]
2025-11-12 22:11:20 -     - sigma_sq: [0.60416987 0.46020784 0.46102068 0.5007908  0.63093401 0.44969943]
2025-11-12 22:11:20 -   perceived_benefit:
2025-11-12 22:11:20 -     - zeta: [1.         1.00919278 1.18369996 1.32623565 1.23070714 1.07037927]
2025-11-12 22:11:20 -     - sigma_sq: [0.57971174 0.45953414 0.50286328 0.54283099 0.54755649 0.47700062]
2025-11-12 22:11:20 -   perceived_price:
2025-11-12 22:11:20 -     - zeta: [1.         1.67593176 1.78714194]
2025-11-12 22:11:20 -     - sigma_sq: [0.85194164 0.83876496 0.83043565]
2025-11-12 22:11:20 -   nutrition_knowledge:
2025-11-12 22:11:20 -     - zeta: [1.         1.31965655 1.45279834 1.25929937 1.41959274 1.4734593
 1.46990873 1.30306593 1.36669214 1.42946906 1.21243139 1.43104877
 1.42626789 1.44312537 1.46228827 1.44805622 1.37261709 1.01586499
 1.36559608 1.25265095]
2025-11-12 22:11:20 -     - sigma_sq: [0.4643181  0.33446832 0.33467405 0.37083842 0.38216285 0.34861935
 0.36711098 0.36369962 0.38634328 0.36035738 0.36420302 0.37216832
 0.40722729 0.40528382 0.34877169 0.37813765 0.35105585 0.35159055
 0.31778192 0.35470298]
2025-11-12 22:11:20 -   purchase_intention:
2025-11-12 22:11:20 -     - zeta: [1.         1.0922122  1.11760361]
2025-11-12 22:11:20 -     - sigma_sq: [1.46400134 1.4169988  1.41088811]
2025-11-12 22:11:20 - 
[구조모델 파라미터]
2025-11-12 22:11:20 -   gamma_health_concern_to_perceived_benefit: 0.513237
2025-11-12 22:11:20 -   gamma_perceived_benefit_to_purchase_intention: 0.498304
2025-11-12 22:11:20 - 
[선택모델 파라미터]
2025-11-12 22:11:20 -   intercept: -0.057994
2025-11-12 22:11:20 -   beta: [ 0.23123943  0.2250724  -0.28638396]
2025-11-12 22:11:20 -   lambda_main: 0.393002
2025-11-12 22:11:20 -   lambda_mod_perceived_price: -1.596207
2025-11-12 22:11:20 -   lambda_mod_nutrition_knowledge: 1.038534
2025-11-12 22:11:20 - ================================================================================
2025-11-12 22:12:37 -   LL =  -56754.7815 (Best:  -56754.7815) [NEW BEST]
2025-11-12 22:12:37 -   파라미터 변화량 (L2 norm): 1.815197e-01
  함수값 변화: +559.8202 (감소)
2025-11-12 22:12:37 - [단계 2/2] Analytic Gradient 계산 #iter3-2
2025-11-12 22:13:28 - 
[탐색 방향 분석 - Iteration #4]
  탐색 방향 d norm: 1.815197e-01
  탐색 방향 d max: 4.362152e-02
  Gradient norm: 2.493749e+05
  d와 -grad의 코사인 유사도: 0.190050
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.0168096  0.01567997 0.01089451 0.01077169 0.0170808 ]
  -grad 상위 5개: [10524.20359278 10620.1368275   8088.48736785  6522.02349965
 10418.60455602]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 4.646567e-01
    - 변화량 max: 9.898878e-02
    - 변화 상위 5개 인덱스: [45 44 33 27 28]
    - 변화 상위 5개 값: [0.09898878 0.09537891 0.09108382 0.08970699 0.08413256]

2025-11-12 22:13:28 - [Line Search 함수 호출 #iter5-2] [단계 1/2] 전체 우도 계산
2025-11-12 22:14:46 -   LL =  -56754.7815 (Best:  -56754.7815) 
2025-11-12 22:14:46 -   파라미터 변화량 (L2 norm): 1.815197e-01
  함수값 변화: +559.8202 (감소)
2025-11-12 22:14:46 - [단계 2/2] Analytic Gradient 계산 #iter4-3
2025-11-12 22:15:39 - ======================================================================
2025-11-12 22:15:39 - ICLV 모델 추정 시작
2025-11-12 22:15:39 - ======================================================================
2025-11-12 22:15:39 - [단계 2/2] Analytic Gradient 계산 #iter4-3
2025-11-12 22:16:29 - [단계 2/2] Analytic Gradient 계산 #iter4-3
2025-11-12 22:17:22 - 
================================================================================
[Major Iteration #4 완료]
  최종 LL: -56754.7815
  Line Search: 2회 함수 호출 - ✓ 성공 (함수값 감소: 559.8202)
  함수 호출: 7회 (누적)
  그래디언트 호출: 7회 (누적)
  수렴 조건:
    - ftol = 1.240734e-02 (기준: 1e-3, 변화: -9.44e-03 [-43.2%])
    - gtol = 5.284862e+04 (기준: 1e-3, 변화: -1.08e+04 [-17.0%])

  전체 파라미터 값 및 그래디언트:
    [ 0] zeta_health_concern_q7                            : param=+1.906909e+00, grad=-1.052420e+04
    [ 1] zeta_health_concern_q8                            : param=+1.900083e+00, grad=-1.062014e+04
    [ 2] zeta_health_concern_q9                            : param=+2.065974e+00, grad=-8.088487e+03
    [ 3] zeta_health_concern_q10                           : param=+2.102149e+00, grad=-6.522023e+03
    [ 4] zeta_health_concern_q11                           : param=+1.881004e+00, grad=-1.041860e+04
    [ 5] sigma_sq_health_concern_q6                        : param=+6.041699e-01, grad=-5.284862e+04
    [ 6] sigma_sq_health_concern_q7                        : param=+4.602078e-01, grad=-4.078296e+04
    [ 7] sigma_sq_health_concern_q8                        : param=+4.610207e-01, grad=-3.898240e+04
    [ 8] sigma_sq_health_concern_q9                        : param=+5.007908e-01, grad=-3.371631e+04
    [ 9] sigma_sq_health_concern_q10                       : param=+6.309340e-01, grad=-2.248115e+04
    [10] sigma_sq_health_concern_q11                       : param=+4.496994e-01, grad=-4.030448e+04
    [11] zeta_perceived_benefit_q13                        : param=+1.009193e+00, grad=-1.164539e+04
    [12] zeta_perceived_benefit_q14                        : param=+1.183700e+00, grad=-1.801317e+04
    [13] zeta_perceived_benefit_q15                        : param=+1.326236e+00, grad=-1.735574e+04
    [14] zeta_perceived_benefit_q16                        : param=+1.230707e+00, grad=-1.693349e+04
    [15] zeta_perceived_benefit_q17                        : param=+1.070379e+00, grad=-1.567917e+04
    [16] sigma_sq_perceived_benefit_q12                    : param=+5.797117e-01, grad=-4.685546e+04
    [17] sigma_sq_perceived_benefit_q13                    : param=+4.595341e-01, grad=-3.235328e+04
    [18] sigma_sq_perceived_benefit_q14                    : param=+5.028633e-01, grad=-4.454710e+04
    [19] sigma_sq_perceived_benefit_q15                    : param=+5.428310e-01, grad=-4.448180e+04
    [20] sigma_sq_perceived_benefit_q16                    : param=+5.475565e-01, grad=-4.692608e+04
    [21] sigma_sq_perceived_benefit_q17                    : param=+4.770006e-01, grad=-4.085670e+04
    [22] zeta_perceived_price_q28                          : param=+1.675932e+00, grad=-3.530714e+03
    [23] zeta_perceived_price_q29                          : param=+1.787142e+00, grad=-2.994758e+03
    [24] sigma_sq_perceived_price_q27                      : param=+8.519416e-01, grad=-4.066516e+04
    [25] sigma_sq_perceived_price_q28                      : param=+8.387650e-01, grad=-3.334282e+04
    [26] sigma_sq_perceived_price_q29                      : param=+8.304356e-01, grad=-3.567728e+04
    [27] zeta_nutrition_knowledge_q31                      : param=+1.319657e+00, grad=-1.952162e+04
    [28] zeta_nutrition_knowledge_q32                      : param=+1.452798e+00, grad=-2.453317e+04
    [29] zeta_nutrition_knowledge_q33                      : param=+1.259299e+00, grad=-1.841560e+04
    [30] zeta_nutrition_knowledge_q34                      : param=+1.419593e+00, grad=-2.631716e+04
    [31] zeta_nutrition_knowledge_q35                      : param=+1.473459e+00, grad=-2.433498e+04
    [32] zeta_nutrition_knowledge_q36                      : param=+1.469909e+00, grad=-2.374569e+04
    [33] zeta_nutrition_knowledge_q37                      : param=+1.303066e+00, grad=-2.077257e+04
    [34] zeta_nutrition_knowledge_q38                      : param=+1.366692e+00, grad=-2.566024e+04
    [35] zeta_nutrition_knowledge_q39                      : param=+1.429469e+00, grad=-2.443642e+04
    [36] zeta_nutrition_knowledge_q40                      : param=+1.212431e+00, grad=-2.100645e+04
    [37] zeta_nutrition_knowledge_q41                      : param=+1.431049e+00, grad=-2.504184e+04
    [38] zeta_nutrition_knowledge_q42                      : param=+1.426268e+00, grad=-2.617856e+04
    [39] zeta_nutrition_knowledge_q43                      : param=+1.443125e+00, grad=-2.627807e+04
    [40] zeta_nutrition_knowledge_q44                      : param=+1.462288e+00, grad=-2.400508e+04
    [41] zeta_nutrition_knowledge_q45                      : param=+1.448056e+00, grad=-2.521687e+04
    [42] zeta_nutrition_knowledge_q46                      : param=+1.372617e+00, grad=-2.149442e+04
    [43] zeta_nutrition_knowledge_q47                      : param=+1.015865e+00, grad=-1.683592e+04
    [44] zeta_nutrition_knowledge_q48                      : param=+1.365596e+00, grad=-2.226223e+04
    [45] zeta_nutrition_knowledge_q49                      : param=+1.252651e+00, grad=-2.082491e+04
    [46] sigma_sq_nutrition_knowledge_q30                  : param=+4.643181e-01, grad=-4.517405e+04
    [47] sigma_sq_nutrition_knowledge_q31                  : param=+3.344683e-01, grad=-3.037733e+04
    [48] sigma_sq_nutrition_knowledge_q32                  : param=+3.346741e-01, grad=-3.477438e+04
    [49] sigma_sq_nutrition_knowledge_q33                  : param=+3.708384e-01, grad=-3.357580e+04
    [50] sigma_sq_nutrition_knowledge_q34                  : param=+3.821629e-01, grad=-3.784344e+04
    [51] sigma_sq_nutrition_knowledge_q35                  : param=+3.486194e-01, grad=-3.723387e+04
    [52] sigma_sq_nutrition_knowledge_q36                  : param=+3.671110e-01, grad=-3.636288e+04
    [53] sigma_sq_nutrition_knowledge_q37                  : param=+3.636996e-01, grad=-3.272465e+04
    [54] sigma_sq_nutrition_knowledge_q38                  : param=+3.863433e-01, grad=-3.866750e+04
    [55] sigma_sq_nutrition_knowledge_q39                  : param=+3.603574e-01, grad=-3.805710e+04
    [56] sigma_sq_nutrition_knowledge_q40                  : param=+3.642030e-01, grad=-3.431280e+04
    [57] sigma_sq_nutrition_knowledge_q41                  : param=+3.721683e-01, grad=-3.687665e+04
    [58] sigma_sq_nutrition_knowledge_q42                  : param=+4.072273e-01, grad=-3.625039e+04
    [59] sigma_sq_nutrition_knowledge_q43                  : param=+4.052838e-01, grad=-3.446631e+04
    [60] sigma_sq_nutrition_knowledge_q44                  : param=+3.487717e-01, grad=-3.713384e+04
    [61] sigma_sq_nutrition_knowledge_q45                  : param=+3.781377e-01, grad=-3.652286e+04
    [62] sigma_sq_nutrition_knowledge_q46                  : param=+3.510558e-01, grad=-3.446300e+04
    [63] sigma_sq_nutrition_knowledge_q47                  : param=+3.515906e-01, grad=-3.196981e+04
    [64] sigma_sq_nutrition_knowledge_q48                  : param=+3.177819e-01, grad=-3.024584e+04
    [65] sigma_sq_nutrition_knowledge_q49                  : param=+3.547030e-01, grad=-3.204116e+04
    [66] zeta_purchase_intention_q19                       : param=+1.092212e+00, grad=-4.566316e+03
    [67] zeta_purchase_intention_q20                       : param=+1.117604e+00, grad=-4.809212e+03
    [68] sigma_sq_purchase_intention_q18                   : param=+1.464001e+00, grad=-1.088462e+04
    [69] sigma_sq_purchase_intention_q19                   : param=+1.416999e+00, grad=-1.033694e+04
    [70] sigma_sq_purchase_intention_q20                   : param=+1.410888e+00, grad=-1.118973e+04
    [71] gamma_health_concern_to_perceived_benefit         : param=+5.132370e-01, grad=-2.329332e+02
    [72] gamma_perceived_benefit_to_purchase_intention     : param=+4.983036e-01, grad=+4.863902e+00
    [73] beta_intercept                                    : param=-5.799374e-02, grad=+3.419587e+03
    [74] beta_sugar_free                                   : param=+2.312394e-01, grad=+1.203542e+02
    [75] beta_health_label                                 : param=+2.250724e-01, grad=+7.659416e+01
    [76] beta_price                                        : param=-2.863840e-01, grad=+2.270904e+03
    [77] lambda_main                                       : param=+3.930024e-01, grad=+4.885176e+03
    [78] lambda_mod_perceived_price                        : param=-1.596207e+00, grad=+9.559201e+03
    [79] lambda_mod_nutrition_knowledge                    : param=+1.038534e+00, grad=+9.744960e+02

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 2.268996e-01
    - y_k (gradient 변화) norm: 1.557753e+04
    - s_k^T · y_k: 2.212079e+03 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 4.520634e-04
    - s_k 상위 5개: [0.021012   0.01959996 0.01361814 0.01346461 0.021351  ]
    - y_k 상위 5개: [321.9697723  222.92987569  36.85355094 191.33741477 470.2240317 ]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 22:17:22 - [Major Iteration #5 시작] [단계 1/2] 전체 우도 계산
2025-11-12 22:18:39 -   LL =  -56670.6188 (Best:  -56670.6188) [NEW BEST]
2025-11-12 22:18:39 - [단계 2/2] Analytic Gradient 계산 #iter4-1
2025-11-12 22:19:31 - [Line Search 함수 호출 #iter5-1] [단계 1/2] 전체 우도 계산
2025-11-12 22:20:49 -   LL =  -56408.5997 (Best:  -56408.5997) [NEW BEST]
2025-11-12 22:20:49 -   파라미터 변화량 (L2 norm): 1.861815e-01
  함수값 변화: +262.0191 (감소)
2025-11-12 22:20:49 - [단계 2/2] Analytic Gradient 계산 #iter4-2
2025-11-12 22:21:40 - 
[탐색 방향 분석 - Iteration #5]
  탐색 방향 d norm: 1.861815e-01
  탐색 방향 d max: 5.108647e-02
  Gradient norm: 2.494672e+05
  d와 -grad의 코사인 유사도: 0.066905
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.01978776 0.01908544 0.01316426 0.00573269 0.01491816]
  -grad 상위 5개: [ 9941.18131715 10367.11180142  8600.33262965  7803.15651462
  9996.7987236 ]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 3.644966e-01
    - 변화량 max: 7.649547e-02
    - 변화 상위 5개 인덱스: [78 12 30 39 38]
    - 변화 상위 5개 값: [-0.07649547  0.07435376  0.07149964  0.07078904  0.06816809]

2025-11-12 22:21:40 - [Line Search 함수 호출 #iter6-2] [단계 1/2] 전체 우도 계산
2025-11-12 22:22:57 -   LL =  -56408.5997 (Best:  -56408.5997) 
2025-11-12 22:22:57 -   파라미터 변화량 (L2 norm): 1.861815e-01
  함수값 변화: +262.0191 (감소)
2025-11-12 22:22:57 - [단계 2/2] Analytic Gradient 계산 #iter5-3
2025-11-12 22:23:49 - ======================================================================
2025-11-12 22:23:49 - ICLV 모델 추정 시작
2025-11-12 22:23:49 - ======================================================================
2025-11-12 22:23:49 - [단계 2/2] Analytic Gradient 계산 #iter5-3
2025-11-12 22:24:40 - [단계 2/2] Analytic Gradient 계산 #iter5-3
2025-11-12 22:25:33 - 
================================================================================
[Major Iteration #5 완료]
  최종 LL: -56408.5997
  Line Search: 2회 함수 호출 - ✓ 성공 (함수값 감소: 262.0191)
  함수 호출: 9회 (누적)
  그래디언트 호출: 9회 (누적)
  수렴 조건:
    - ftol = 6.099606e-03 (기준: 1e-3, 변화: -6.31e-03 [-50.8%])
    - gtol = 5.492558e+04 (기준: 1e-3, 변화: +2.08e+03 [+3.9%])

  전체 파라미터 값 및 그래디언트:
    [ 0] zeta_health_concern_q7                            : param=+1.931643e+00, grad=-9.941181e+03
    [ 1] zeta_health_concern_q8                            : param=+1.923940e+00, grad=-1.036711e+04
    [ 2] zeta_health_concern_q9                            : param=+2.082430e+00, grad=-8.600333e+03
    [ 3] zeta_health_concern_q10                           : param=+2.109315e+00, grad=-7.803157e+03
    [ 4] zeta_health_concern_q11                           : param=+1.899652e+00, grad=-9.996799e+03
    [ 5] sigma_sq_health_concern_q6                        : param=+6.060210e-01, grad=-5.492558e+04
    [ 6] sigma_sq_health_concern_q7                        : param=+5.065261e-01, grad=-3.572891e+04
    [ 7] sigma_sq_health_concern_q8                        : param=+4.995505e-01, grad=-3.476922e+04
    [ 8] sigma_sq_health_concern_q9                        : param=+5.213840e-01, grad=-3.320770e+04
    [ 9] sigma_sq_health_concern_q10                       : param=+5.959013e-01, grad=-2.754454e+04
    [10] sigma_sq_health_concern_q11                       : param=+4.940368e-01, grad=-3.564535e+04
    [11] zeta_perceived_benefit_q13                        : param=+1.028127e+00, grad=-1.116192e+04
    [12] zeta_perceived_benefit_q14                        : param=+1.226207e+00, grad=-1.607953e+04
    [13] zeta_perceived_benefit_q15                        : param=+1.363508e+00, grad=-1.576314e+04
    [14] zeta_perceived_benefit_q16                        : param=+1.268317e+00, grad=-1.524290e+04
    [15] zeta_perceived_benefit_q17                        : param=+1.104471e+00, grad=-1.401124e+04
    [16] sigma_sq_perceived_benefit_q12                    : param=+6.050287e-01, grad=-4.457680e+04
    [17] sigma_sq_perceived_benefit_q13                    : param=+4.642535e-01, grad=-3.277393e+04
    [18] sigma_sq_perceived_benefit_q14                    : param=+5.301858e-01, grad=-4.040662e+04
    [19] sigma_sq_perceived_benefit_q15                    : param=+5.697992e-01, grad=-4.111142e+04
    [20] sigma_sq_perceived_benefit_q16                    : param=+5.765638e-01, grad=-4.289314e+04
    [21] sigma_sq_perceived_benefit_q17                    : param=+5.043082e-01, grad=-3.697663e+04
    [22] zeta_perceived_price_q28                          : param=+1.675003e+00, grad=-3.881051e+03
    [23] zeta_perceived_price_q29                          : param=+1.788718e+00, grad=-3.451723e+03
    [24] sigma_sq_perceived_price_q27                      : param=+7.880835e-01, grad=-4.785913e+04
    [25] sigma_sq_perceived_price_q28                      : param=+7.957547e-01, grad=-3.735927e+04
    [26] sigma_sq_perceived_price_q29                      : param=+7.833806e-01, grad=-4.016414e+04
    [27] zeta_nutrition_knowledge_q31                      : param=+1.326255e+00, grad=-1.911018e+04
    [28] zeta_nutrition_knowledge_q32                      : param=+1.485577e+00, grad=-2.236379e+04
    [29] zeta_nutrition_knowledge_q33                      : param=+1.264082e+00, grad=-1.881355e+04
    [30] zeta_nutrition_knowledge_q34                      : param=+1.459214e+00, grad=-2.563826e+04
    [31] zeta_nutrition_knowledge_q35                      : param=+1.494491e+00, grad=-2.524678e+04
    [32] zeta_nutrition_knowledge_q36                      : param=+1.482535e+00, grad=-2.400533e+04
    [33] zeta_nutrition_knowledge_q37                      : param=+1.314877e+00, grad=-2.088428e+04
    [34] zeta_nutrition_knowledge_q38                      : param=+1.385248e+00, grad=-2.675456e+04
    [35] zeta_nutrition_knowledge_q39                      : param=+1.456371e+00, grad=-2.401381e+04
    [36] zeta_nutrition_knowledge_q40                      : param=+1.218773e+00, grad=-2.110432e+04
    [37] zeta_nutrition_knowledge_q41                      : param=+1.449501e+00, grad=-2.617619e+04
    [38] zeta_nutrition_knowledge_q42                      : param=+1.466234e+00, grad=-2.475536e+04
    [39] zeta_nutrition_knowledge_q43                      : param=+1.485121e+00, grad=-2.485430e+04
    [40] zeta_nutrition_knowledge_q44                      : param=+1.486596e+00, grad=-2.389709e+04
    [41] zeta_nutrition_knowledge_q45                      : param=+1.467753e+00, grad=-2.597264e+04
    [42] zeta_nutrition_knowledge_q46                      : param=+1.377027e+00, grad=-2.130906e+04
    [43] zeta_nutrition_knowledge_q47                      : param=+1.009887e+00, grad=-1.681550e+04
    [44] zeta_nutrition_knowledge_q48                      : param=+1.381487e+00, grad=-2.080992e+04
    [45] zeta_nutrition_knowledge_q49                      : param=+1.261043e+00, grad=-2.101787e+04
    [46] sigma_sq_nutrition_knowledge_q30                  : param=+4.539943e-01, grad=-4.603687e+04
    [47] sigma_sq_nutrition_knowledge_q31                  : param=+3.270107e-01, grad=-2.973994e+04
    [48] sigma_sq_nutrition_knowledge_q32                  : param=+3.266051e-01, grad=-3.258758e+04
    [49] sigma_sq_nutrition_knowledge_q33                  : param=+3.553250e-01, grad=-3.435567e+04
    [50] sigma_sq_nutrition_knowledge_q34                  : param=+3.563088e-01, grad=-3.823966e+04
    [51] sigma_sq_nutrition_knowledge_q35                  : param=+3.151732e-01, grad=-4.101427e+04
    [52] sigma_sq_nutrition_knowledge_q36                  : param=+3.444762e-01, grad=-3.913238e+04
    [53] sigma_sq_nutrition_knowledge_q37                  : param=+3.463898e-01, grad=-3.337491e+04
    [54] sigma_sq_nutrition_knowledge_q38                  : param=+3.529902e-01, grad=-4.309014e+04
    [55] sigma_sq_nutrition_knowledge_q39                  : param=+3.365194e-01, grad=-4.001842e+04
    [56] sigma_sq_nutrition_knowledge_q40                  : param=+3.527182e-01, grad=-3.457386e+04
    [57] sigma_sq_nutrition_knowledge_q41                  : param=+3.379676e-01, grad=-4.108840e+04
    [58] sigma_sq_nutrition_knowledge_q42                  : param=+3.915664e-01, grad=-3.478196e+04
    [59] sigma_sq_nutrition_knowledge_q43                  : param=+3.887023e-01, grad=-3.258335e+04
    [60] sigma_sq_nutrition_knowledge_q44                  : param=+3.245998e-01, grad=-3.839890e+04
    [61] sigma_sq_nutrition_knowledge_q45                  : param=+3.474600e-01, grad=-3.965867e+04
    [62] sigma_sq_nutrition_knowledge_q46                  : param=+3.443023e-01, grad=-3.358613e+04
    [63] sigma_sq_nutrition_knowledge_q47                  : param=+3.536195e-01, grad=-3.091373e+04
    [64] sigma_sq_nutrition_knowledge_q48                  : param=+3.169686e-01, grad=-2.707849e+04
    [65] sigma_sq_nutrition_knowledge_q49                  : param=+3.365316e-01, grad=-3.396490e+04
    [66] zeta_purchase_intention_q19                       : param=+1.117521e+00, grad=-4.280821e+03
    [67] zeta_purchase_intention_q20                       : param=+1.143053e+00, grad=-4.466832e+03
    [68] sigma_sq_purchase_intention_q18                   : param=+1.503363e+00, grad=-1.030533e+04
    [69] sigma_sq_purchase_intention_q19                   : param=+1.450611e+00, grad=-9.761373e+03
    [70] sigma_sq_purchase_intention_q20                   : param=+1.444194e+00, grad=-1.061270e+04
    [71] gamma_health_concern_to_perceived_benefit         : param=+5.150941e-01, grad=-2.104471e+02
    [72] gamma_perceived_benefit_to_purchase_intention     : param=+4.982777e-01, grad=-6.414947e+00
    [73] beta_intercept                                    : param=-7.932005e-02, grad=+3.245614e+03
    [74] beta_sugar_free                                   : param=+2.318409e-01, grad=+5.790193e+01
    [75] beta_health_label                                 : param=+2.260700e-01, grad=+1.446291e+01
    [76] beta_price                                        : param=-2.947378e-01, grad=+1.953191e+03
    [77] lambda_main                                       : param=+3.660676e-01, grad=+4.688516e+03
    [78] lambda_mod_perceived_price                        : param=-1.647189e+00, grad=+9.325983e+03
    [79] lambda_mod_nutrition_knowledge                    : param=+1.044444e+00, grad=+8.297284e+02

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 2.327269e-01
    - y_k (gradient 변화) norm: 1.959038e+04
    - s_k^T · y_k: 3.317196e+03 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 3.014594e-04
    - s_k 상위 5개: [0.0247347  0.0238568  0.01645533 0.00716586 0.0186477 ]
    - y_k 상위 5개: [  583.02227563   253.02502608  -511.8452618  -1281.13301497
   421.80583242]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 22:25:33 - [Major Iteration #6 시작] [단계 1/2] 전체 우도 계산
2025-11-12 22:26:51 -   LL =  -56376.7258 (Best:  -56376.7258) [NEW BEST]
2025-11-12 22:26:51 - [단계 2/2] Analytic Gradient 계산 #iter5-1
2025-11-12 22:27:41 - [Line Search 함수 호출 #iter7-1] [단계 1/2] 전체 우도 계산
2025-11-12 22:28:59 -   LL =  -56376.7258 (Best:  -56376.7258) 
2025-11-12 22:28:59 -   파라미터 변화량 (L2 norm): 0.000000e+00
  함수값 변화: +0.0000 (증가)
2025-11-12 22:28:59 - [단계 2/2] Analytic Gradient 계산 #iter6-2
2025-11-12 22:29:50 - 
[탐색 방향 분석 - Iteration #7]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 2.492406e+05
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [10065.31770469 10506.01705377  8633.6761265   7944.6695816
 10202.48551741]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 22:29:50 - ======================================================================
2025-11-12 22:29:50 - ICLV 모델 추정 시작
2025-11-12 22:29:50 - ======================================================================
2025-11-12 22:29:50 - [단계 2/2] Analytic Gradient 계산 #iter6-2
2025-11-12 22:30:41 - 
[탐색 방향 분석 - Iteration #7]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 2.492406e+05
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [10065.31770469 10506.01705377  8633.6761265   7944.6695816
 10202.48551741]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 22:30:41 - [단계 2/2] Analytic Gradient 계산 #iter6-2
2025-11-12 22:31:35 - 
[탐색 방향 분석 - Iteration #7]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 2.492406e+05
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [10065.31770469 10506.01705377  8633.6761265   7944.6695816
 10202.48551741]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 22:31:35 - 
================================================================================
[Major Iteration #6 완료]
  최종 LL: -56376.7258
  Line Search: 1회 함수 호출 - ⚠️  정체 (함수값 변화 없음)
  함수 호출: 10회 (누적)
  그래디언트 호출: 10회 (누적)
  수렴 조건:
    - ftol = 5.650530e-04 (기준: 1e-3, 변화: -5.53e-03 [-90.7%]) ✓ 수렴 조건 만족
    - gtol = 5.556948e+04 (기준: 1e-3, 변화: +6.44e+02 [+1.2%])

  전체 파라미터 값 및 그래디언트:
    [ 0] zeta_health_concern_q7                            : param=+1.936156e+00, grad=-1.006532e+04
    [ 1] zeta_health_concern_q8                            : param=+1.929667e+00, grad=-1.050602e+04
    [ 2] zeta_health_concern_q9                            : param=+2.089120e+00, grad=-8.633676e+03
    [ 3] zeta_health_concern_q10                           : param=+2.114961e+00, grad=-7.944670e+03
    [ 4] zeta_health_concern_q11                           : param=+1.902034e+00, grad=-1.020249e+04
    [ 5] sigma_sq_health_concern_q6                        : param=+6.042039e-01, grad=-5.556948e+04
    [ 6] sigma_sq_health_concern_q7                        : param=+5.077663e-01, grad=-3.569861e+04
    [ 7] sigma_sq_health_concern_q8                        : param=+5.008491e-01, grad=-3.453984e+04
    [ 8] sigma_sq_health_concern_q9                        : param=+5.302530e-01, grad=-3.192335e+04
    [ 9] sigma_sq_health_concern_q10                       : param=+5.993544e-01, grad=-2.711676e+04
    [10] sigma_sq_health_concern_q11                       : param=+4.954598e-01, grad=-3.547802e+04
    [11] zeta_perceived_benefit_q13                        : param=+1.030205e+00, grad=-1.093835e+04
    [12] zeta_perceived_benefit_q14                        : param=+1.229496e+00, grad=-1.604656e+04
    [13] zeta_perceived_benefit_q15                        : param=+1.366562e+00, grad=-1.567347e+04
    [14] zeta_perceived_benefit_q16                        : param=+1.271226e+00, grad=-1.524411e+04
    [15] zeta_perceived_benefit_q17                        : param=+1.106244e+00, grad=-1.397395e+04
    [16] sigma_sq_perceived_benefit_q12                    : param=+6.086524e-01, grad=-4.419121e+04
    [17] sigma_sq_perceived_benefit_q13                    : param=+4.705458e-01, grad=-3.201642e+04
    [18] sigma_sq_perceived_benefit_q14                    : param=+5.285049e-01, grad=-4.082308e+04
    [19] sigma_sq_perceived_benefit_q15                    : param=+5.712549e-01, grad=-4.100577e+04
    [20] sigma_sq_perceived_benefit_q16                    : param=+5.759708e-01, grad=-4.300831e+04
    [21] sigma_sq_perceived_benefit_q17                    : param=+5.034468e-01, grad=-3.730897e+04
    [22] zeta_perceived_price_q28                          : param=+1.673191e+00, grad=-3.957798e+03
    [23] zeta_perceived_price_q29                          : param=+1.788794e+00, grad=-3.537537e+03
    [24] sigma_sq_perceived_price_q27                      : param=+7.863541e-01, grad=-4.811102e+04
    [25] sigma_sq_perceived_price_q28                      : param=+7.884746e-01, grad=-3.812397e+04
    [26] sigma_sq_perceived_price_q29                      : param=+7.766304e-01, grad=-4.087445e+04
    [27] zeta_nutrition_knowledge_q31                      : param=+1.321427e+00, grad=-1.926313e+04
    [28] zeta_nutrition_knowledge_q32                      : param=+1.484152e+00, grad=-2.283139e+04
    [29] zeta_nutrition_knowledge_q33                      : param=+1.262370e+00, grad=-1.869710e+04
    [30] zeta_nutrition_knowledge_q34                      : param=+1.465904e+00, grad=-2.576919e+04
    [31] zeta_nutrition_knowledge_q35                      : param=+1.499245e+00, grad=-2.474249e+04
    [32] zeta_nutrition_knowledge_q36                      : param=+1.481198e+00, grad=-2.390494e+04
    [33] zeta_nutrition_knowledge_q37                      : param=+1.314102e+00, grad=-2.071978e+04
    [34] zeta_nutrition_knowledge_q38                      : param=+1.389521e+00, grad=-2.616249e+04
    [35] zeta_nutrition_knowledge_q39                      : param=+1.458874e+00, grad=-2.382579e+04
    [36] zeta_nutrition_knowledge_q40                      : param=+1.215940e+00, grad=-2.114771e+04
    [37] zeta_nutrition_knowledge_q41                      : param=+1.454095e+00, grad=-2.565270e+04
    [38] zeta_nutrition_knowledge_q42                      : param=+1.471146e+00, grad=-2.505908e+04
    [39] zeta_nutrition_knowledge_q43                      : param=+1.490827e+00, grad=-2.519710e+04
    [40] zeta_nutrition_knowledge_q44                      : param=+1.488912e+00, grad=-2.390347e+04
    [41] zeta_nutrition_knowledge_q45                      : param=+1.471364e+00, grad=-2.571395e+04
    [42] zeta_nutrition_knowledge_q46                      : param=+1.371791e+00, grad=-2.170499e+04
    [43] zeta_nutrition_knowledge_q47                      : param=+1.002217e+00, grad=-1.714011e+04
    [44] zeta_nutrition_knowledge_q48                      : param=+1.375825e+00, grad=-2.147220e+04
    [45] zeta_nutrition_knowledge_q49                      : param=+1.258248e+00, grad=-2.069967e+04
    [46] sigma_sq_nutrition_knowledge_q30                  : param=+4.545400e-01, grad=-4.576171e+04
    [47] sigma_sq_nutrition_knowledge_q31                  : param=+3.291677e-01, grad=-2.931064e+04
    [48] sigma_sq_nutrition_knowledge_q32                  : param=+3.201658e-01, grad=-3.397458e+04
    [49] sigma_sq_nutrition_knowledge_q33                  : param=+3.580259e-01, grad=-3.380382e+04
    [50] sigma_sq_nutrition_knowledge_q34                  : param=+3.482277e-01, grad=-3.940356e+04
    [51] sigma_sq_nutrition_knowledge_q35                  : param=+3.165675e-01, grad=-3.990220e+04
    [52] sigma_sq_nutrition_knowledge_q36                  : param=+3.461184e-01, grad=-3.861233e+04
    [53] sigma_sq_nutrition_knowledge_q37                  : param=+3.486926e-01, grad=-3.281633e+04
    [54] sigma_sq_nutrition_knowledge_q38                  : param=+3.567845e-01, grad=-4.151948e+04
    [55] sigma_sq_nutrition_knowledge_q39                  : param=+3.362088e-01, grad=-3.959574e+04
    [56] sigma_sq_nutrition_knowledge_q40                  : param=+3.539949e-01, grad=-3.433332e+04
    [57] sigma_sq_nutrition_knowledge_q41                  : param=+3.399967e-01, grad=-3.998145e+04
    [58] sigma_sq_nutrition_knowledge_q42                  : param=+3.819170e-01, grad=-3.616327e+04
    [59] sigma_sq_nutrition_knowledge_q43                  : param=+3.777739e-01, grad=-3.407119e+04
    [60] sigma_sq_nutrition_knowledge_q44                  : param=+3.214763e-01, grad=-3.877581e+04
    [61] sigma_sq_nutrition_knowledge_q45                  : param=+3.473438e-01, grad=-3.907859e+04
    [62] sigma_sq_nutrition_knowledge_q46                  : param=+3.424932e-01, grad=-3.409072e+04
    [63] sigma_sq_nutrition_knowledge_q47                  : param=+3.556415e-01, grad=-3.082097e+04
    [64] sigma_sq_nutrition_knowledge_q48                  : param=+3.118927e-01, grad=-2.831120e+04
    [65] sigma_sq_nutrition_knowledge_q49                  : param=+3.429011e-01, grad=-3.274592e+04
    [66] zeta_purchase_intention_q19                       : param=+1.123646e+00, grad=-4.201385e+03
    [67] zeta_purchase_intention_q20                       : param=+1.148832e+00, grad=-4.373866e+03
    [68] sigma_sq_purchase_intention_q18                   : param=+1.511525e+00, grad=-1.020433e+04
    [69] sigma_sq_purchase_intention_q19                   : param=+1.456739e+00, grad=-9.667174e+03
    [70] sigma_sq_purchase_intention_q20                   : param=+1.449752e+00, grad=-1.053302e+04
    [71] gamma_health_concern_to_perceived_benefit         : param=+5.156266e-01, grad=-2.078850e+02
    [72] gamma_perceived_benefit_to_purchase_intention     : param=+4.983095e-01, grad=-7.102329e+00
    [73] beta_intercept                                    : param=-8.555626e-02, grad=+3.222498e+03
    [74] beta_sugar_free                                   : param=+2.324424e-01, grad=+4.837093e+01
    [75] beta_health_label                                 : param=+2.268069e-01, grad=+8.291282e+00
    [76] beta_price                                        : param=-2.955596e-01, grad=+1.913976e+03
    [77] lambda_main                                       : param=+3.582374e-01, grad=+4.707163e+03
    [78] lambda_mod_perceived_price                        : param=-1.662668e+00, grad=+9.399454e+03
    [79] lambda_mod_nutrition_knowledge                    : param=+1.048251e+00, grad=+8.455658e+02

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 4.236132e-02
    - y_k (gradient 변화) norm: 4.949486e+03
    - s_k^T · y_k: 1.244528e+02 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 8.035178e-03
    - s_k 상위 5개: [0.00451241 0.00572735 0.00668987 0.00564671 0.00238234]
    - y_k 상위 5개: [-124.13638754 -138.90525235  -33.34349685 -141.51306697 -205.68679382]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 22:31:35 - [Major Iteration #7 시작] [단계 1/2] 전체 우도 계산
2025-11-12 22:32:53 -   LL =  -56374.1244 (Best:  -56374.1244) [NEW BEST]
2025-11-12 22:32:53 - [단계 2/2] Analytic Gradient 계산 #iter6-1
2025-11-12 22:33:44 - [Line Search 함수 호출 #iter7-1] [단계 1/2] 전체 우도 계산
2025-11-12 22:35:01 -   LL =  -56364.0838 (Best:  -56364.0838) [NEW BEST]
2025-11-12 22:35:01 -   파라미터 변화량 (L2 norm): 2.040532e-02
  함수값 변화: +10.0406 (감소)
2025-11-12 22:35:01 - [단계 2/2] Analytic Gradient 계산 #iter6-2
2025-11-12 22:35:53 - 
[탐색 방향 분석 - Iteration #7]
  탐색 방향 d norm: 2.040532e-02
  탐색 방향 d max: 9.820499e-03
  Gradient norm: 2.491037e+05
  d와 -grad의 코사인 유사도: 0.048411
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.00288892 0.00387884 0.00446378 0.00442548 0.0018352 ]
  -grad 상위 5개: [10085.65775193 10506.93821749  8582.95715338  7896.21538725
 10264.20593228]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 2.550665e-02
    - 변화량 max: 1.227562e-02
    - 변화 상위 5개 인덱스: [78 77  2  3 43]
    - 변화 상위 5개 값: [-0.01227562 -0.00606802  0.00557972  0.00553185 -0.00538184]

2025-11-12 22:35:53 - [Line Search 함수 호출 #iter7-2] [단계 1/2] 전체 우도 계산
2025-11-12 22:37:11 -   LL =  -56331.4327 (Best:  -56331.4327) [NEW BEST]
2025-11-12 22:37:11 -   파라미터 변화량 (L2 norm): 1.020266e-01
  함수값 변화: +42.6917 (감소)
2025-11-12 22:37:11 - [단계 2/2] Analytic Gradient 계산 #iter6-3
2025-11-12 22:38:02 - [Line Search 함수 호출 #iter8-3] [단계 1/2] 전체 우도 계산
2025-11-12 22:38:02 - 
================================================================================
2025-11-12 22:38:02 - Iteration 20 - 파라미터 값
2025-11-12 22:38:02 - ================================================================================
2025-11-12 22:38:02 - 
[측정모델 파라미터]
2025-11-12 22:38:02 -   health_concern:
2025-11-12 22:38:02 -     - zeta: [1.         1.95132255 1.95003109 2.1125545  2.13819526 1.91166875]
2025-11-12 22:38:02 -     - sigma_sq: [0.60880045 0.50405394 0.49490269 0.53598097 0.61099976 0.48988617]
2025-11-12 22:38:02 -   perceived_benefit:
2025-11-12 22:38:02 -     - zeta: [1.         1.03009449 1.23327363 1.36934393 1.27519425 1.10570575]
2025-11-12 22:38:02 -     - sigma_sq: [0.61124443 0.47979664 0.52605093 0.57078295 0.5715788  0.5025272 ]
2025-11-12 22:38:02 -   perceived_price:
2025-11-12 22:38:02 -     - zeta: [1.         1.66767536 1.79033232]
2025-11-12 22:38:02 -     - sigma_sq: [0.79709302 0.78365652 0.77364195]
2025-11-12 22:38:02 -   nutrition_knowledge:
2025-11-12 22:38:02 -     - zeta: [1.         1.30388272 1.48144529 1.25202624 1.48706417 1.50367543
 1.47165486 1.30501448 1.39076405 1.45968866 1.20418342 1.45808366
 1.48879865 1.51192114 1.49330626 1.4765302  1.35816921 0.97961291
 1.3634647  1.23883915]
2025-11-12 22:38:02 -     - sigma_sq: [0.45361967 0.3302775  0.32487582 0.36038345 0.34631307 0.30737034
 0.34774109 0.34971795 0.34775482 0.33212938 0.35652077 0.33366955
 0.37628696 0.36942699 0.32240782 0.34246521 0.34720314 0.36124045
 0.31699242 0.34676509]
2025-11-12 22:38:02 -   purchase_intention:
2025-11-12 22:38:02 -     - zeta: [1.         1.14081594 1.16435777]
2025-11-12 22:38:02 -     - sigma_sq: [1.53337043 1.47194008 1.46306894]
2025-11-12 22:38:02 - 
[구조모델 파라미터]
2025-11-12 22:38:02 -   gamma_health_concern_to_perceived_benefit: 0.517280
2025-11-12 22:38:02 -   gamma_perceived_benefit_to_purchase_intention: 0.498451
2025-11-12 22:38:02 - 
[선택모델 파라미터]
2025-11-12 22:38:02 -   intercept: -0.105129
2025-11-12 22:38:02 -   beta: [ 0.23485578  0.22960235 -0.29630684]
2025-11-12 22:38:02 -   lambda_main: 0.332752
2025-11-12 22:38:02 -   lambda_mod_perceived_price: -1.714226
2025-11-12 22:38:02 -   lambda_mod_nutrition_knowledge: 1.061628
2025-11-12 22:38:02 - ================================================================================
2025-11-12 22:39:20 -   LL =  -56331.4327 (Best:  -56331.4327) 
2025-11-12 22:39:20 -   파라미터 변화량 (L2 norm): 1.020266e-01
  함수값 변화: +42.6917 (감소)
2025-11-12 22:39:20 - [단계 2/2] Analytic Gradient 계산 #iter7-4
2025-11-12 22:40:10 - ======================================================================
2025-11-12 22:40:10 - ICLV 모델 추정 시작
2025-11-12 22:40:10 - ======================================================================
2025-11-12 22:40:10 - [단계 2/2] Analytic Gradient 계산 #iter7-4
2025-11-12 22:41:02 - [단계 2/2] Analytic Gradient 계산 #iter7-4
2025-11-12 22:41:54 - 
================================================================================
[Major Iteration #7 완료]
  최종 LL: -56331.4327
  Line Search: 3회 함수 호출 - ✓ 성공 (함수값 감소: 42.6917)
  함수 호출: 13회 (누적)
  그래디언트 호출: 13회 (누적)
  수렴 조건:
    - ftol = 8.034014e-04 (기준: 1e-3, 변화: +2.38e-04 [+42.2%]) ✓ 수렴 조건 만족
    - gtol = 5.490120e+04 (기준: 1e-3, 변화: -6.68e+02 [-1.2%])

  전체 파라미터 값 및 그래디언트:
    [ 0] zeta_health_concern_q7                            : param=+1.951323e+00, grad=-9.968839e+03
    [ 1] zeta_health_concern_q8                            : param=+1.950031e+00, grad=-1.031019e+04
    [ 2] zeta_health_concern_q9                            : param=+2.112554e+00, grad=-8.217058e+03
    [ 3] zeta_health_concern_q10                           : param=+2.138195e+00, grad=-7.545797e+03
    [ 4] zeta_health_concern_q11                           : param=+1.911669e+00, grad=-1.025388e+04
    [ 5] sigma_sq_health_concern_q6                        : param=+6.088005e-01, grad=-5.490120e+04
    [ 6] sigma_sq_health_concern_q7                        : param=+5.040539e-01, grad=-3.612924e+04
    [ 7] sigma_sq_health_concern_q8                        : param=+4.949027e-01, grad=-3.530843e+04
    [ 8] sigma_sq_health_concern_q9                        : param=+5.359810e-01, grad=-3.100963e+04
    [ 9] sigma_sq_health_concern_q10                       : param=+6.109998e-01, grad=-2.574873e+04
    [10] sigma_sq_health_concern_q11                       : param=+4.898862e-01, grad=-3.636335e+04
    [11] zeta_perceived_benefit_q13                        : param=+1.030094e+00, grad=-1.065816e+04
    [12] zeta_perceived_benefit_q14                        : param=+1.233274e+00, grad=-1.599279e+04
    [13] zeta_perceived_benefit_q15                        : param=+1.369344e+00, grad=-1.561701e+04
    [14] zeta_perceived_benefit_q16                        : param=+1.275194e+00, grad=-1.533545e+04
    [15] zeta_perceived_benefit_q17                        : param=+1.105706e+00, grad=-1.398742e+04
    [16] sigma_sq_perceived_benefit_q12                    : param=+6.112444e-01, grad=-4.379855e+04
    [17] sigma_sq_perceived_benefit_q13                    : param=+4.797966e-01, grad=-3.080757e+04
    [18] sigma_sq_perceived_benefit_q14                    : param=+5.260509e-01, grad=-4.116187e+04
    [19] sigma_sq_perceived_benefit_q15                    : param=+5.707830e-01, grad=-4.098018e+04
    [20] sigma_sq_perceived_benefit_q16                    : param=+5.715788e-01, grad=-4.342832e+04
    [21] sigma_sq_perceived_benefit_q17                    : param=+5.025272e-01, grad=-3.750285e+04
    [22] zeta_perceived_price_q28                          : param=+1.667675e+00, grad=-3.994117e+03
    [23] zeta_perceived_price_q29                          : param=+1.790332e+00, grad=-3.537264e+03
    [24] sigma_sq_perceived_price_q27                      : param=+7.970930e-01, grad=-4.685915e+04
    [25] sigma_sq_perceived_price_q28                      : param=+7.836565e-01, grad=-3.877577e+04
    [26] sigma_sq_perceived_price_q29                      : param=+7.736419e-01, grad=-4.130242e+04
    [27] zeta_nutrition_knowledge_q31                      : param=+1.303883e+00, grad=-2.020408e+04
    [28] zeta_nutrition_knowledge_q32                      : param=+1.481445e+00, grad=-2.245866e+04
    [29] zeta_nutrition_knowledge_q33                      : param=+1.252026e+00, grad=-1.900889e+04
    [30] zeta_nutrition_knowledge_q34                      : param=+1.487064e+00, grad=-2.437444e+04
    [31] zeta_nutrition_knowledge_q35                      : param=+1.503675e+00, grad=-2.491878e+04
    [32] zeta_nutrition_knowledge_q36                      : param=+1.471655e+00, grad=-2.425358e+04
    [33] zeta_nutrition_knowledge_q37                      : param=+1.305014e+00, grad=-2.104567e+04
    [34] zeta_nutrition_knowledge_q38                      : param=+1.390764e+00, grad=-2.662532e+04
    [35] zeta_nutrition_knowledge_q39                      : param=+1.459689e+00, grad=-2.392031e+04
    [36] zeta_nutrition_knowledge_q40                      : param=+1.204183e+00, grad=-2.161571e+04
    [37] zeta_nutrition_knowledge_q41                      : param=+1.458084e+00, grad=-2.568716e+04
    [38] zeta_nutrition_knowledge_q42                      : param=+1.488799e+00, grad=-2.426845e+04
    [39] zeta_nutrition_knowledge_q43                      : param=+1.511921e+00, grad=-2.431915e+04
    [40] zeta_nutrition_knowledge_q44                      : param=+1.493306e+00, grad=-2.329410e+04
    [41] zeta_nutrition_knowledge_q45                      : param=+1.476530e+00, grad=-2.560202e+04
    [42] zeta_nutrition_knowledge_q46                      : param=+1.358169e+00, grad=-2.211294e+04
    [43] zeta_nutrition_knowledge_q47                      : param=+9.796129e-01, grad=-1.815943e+04
    [44] zeta_nutrition_knowledge_q48                      : param=+1.363465e+00, grad=-2.174709e+04
    [45] zeta_nutrition_knowledge_q49                      : param=+1.238839e+00, grad=-2.152029e+04
    [46] sigma_sq_nutrition_knowledge_q30                  : param=+4.536197e-01, grad=-4.559535e+04
    [47] sigma_sq_nutrition_knowledge_q31                  : param=+3.302775e-01, grad=-2.970530e+04
    [48] sigma_sq_nutrition_knowledge_q32                  : param=+3.248758e-01, grad=-3.260506e+04
    [49] sigma_sq_nutrition_knowledge_q33                  : param=+3.603834e-01, grad=-3.369520e+04
    [50] sigma_sq_nutrition_knowledge_q34                  : param=+3.463131e-01, grad=-3.781551e+04
    [51] sigma_sq_nutrition_knowledge_q35                  : param=+3.073703e-01, grad=-4.173958e+04
    [52] sigma_sq_nutrition_knowledge_q36                  : param=+3.477411e-01, grad=-3.822692e+04
    [53] sigma_sq_nutrition_knowledge_q37                  : param=+3.497180e-01, grad=-3.285941e+04
    [54] sigma_sq_nutrition_knowledge_q38                  : param=+3.477548e-01, grad=-4.323785e+04
    [55] sigma_sq_nutrition_knowledge_q39                  : param=+3.321294e-01, grad=-3.988065e+04
    [56] sigma_sq_nutrition_knowledge_q40                  : param=+3.565208e-01, grad=-3.406494e+04
    [57] sigma_sq_nutrition_knowledge_q41                  : param=+3.336695e-01, grad=-4.082594e+04
    [58] sigma_sq_nutrition_knowledge_q42                  : param=+3.762870e-01, grad=-3.558299e+04
    [59] sigma_sq_nutrition_knowledge_q43                  : param=+3.694270e-01, grad=-3.392177e+04
    [60] sigma_sq_nutrition_knowledge_q44                  : param=+3.224078e-01, grad=-3.777751e+04
    [61] sigma_sq_nutrition_knowledge_q45                  : param=+3.424652e-01, grad=-3.922749e+04
    [62] sigma_sq_nutrition_knowledge_q46                  : param=+3.472031e-01, grad=-3.347960e+04
    [63] sigma_sq_nutrition_knowledge_q47                  : param=+3.612404e-01, grad=-3.060000e+04
    [64] sigma_sq_nutrition_knowledge_q48                  : param=+3.169924e-01, grad=-2.783176e+04
    [65] sigma_sq_nutrition_knowledge_q49                  : param=+3.467651e-01, grad=-3.287519e+04
    [66] zeta_purchase_intention_q19                       : param=+1.140816e+00, grad=-3.982458e+03
    [67] zeta_purchase_intention_q20                       : param=+1.164358e+00, grad=-4.156527e+03
    [68] sigma_sq_purchase_intention_q18                   : param=+1.533370e+00, grad=-9.884942e+03
    [69] sigma_sq_purchase_intention_q19                   : param=+1.471940e+00, grad=-9.400483e+03
    [70] sigma_sq_purchase_intention_q20                   : param=+1.463069e+00, grad=-1.028516e+04
    [71] gamma_health_concern_to_perceived_benefit         : param=+5.172798e-01, grad=-2.074616e+02
    [72] gamma_perceived_benefit_to_purchase_intention     : param=+4.984510e-01, grad=-1.191316e+01
    [73] beta_intercept                                    : param=-1.051285e-01, grad=+3.163153e+03
    [74] beta_sugar_free                                   : param=+2.348558e-01, grad=+1.808736e+01
    [75] beta_health_label                                 : param=+2.296024e-01, grad=-9.502186e+00
    [76] beta_price                                        : param=-2.963068e-01, grad=+1.812528e+03
    [77] lambda_main                                       : param=+3.327517e-01, grad=+4.775724e+03
    [78] lambda_mod_perceived_price                        : param=-1.714226e+00, grad=+9.666837e+03
    [79] lambda_mod_nutrition_knowledge                    : param=+1.061628e+00, grad=+7.998357e+02

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 1.071279e-01
    - y_k (gradient 변화) norm: 5.587644e+03
    - s_k^T · y_k: 2.874129e+02 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 3.479314e-03
    - s_k 상위 5개: [0.01516682 0.02036392 0.02343484 0.02323378 0.0096348 ]
    - y_k 상위 5개: [ 96.47909838 195.82922864 416.61854437 398.87276805 -51.39236604]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 22:41:54 - [Major Iteration #8 시작] [단계 1/2] 전체 우도 계산
2025-11-12 22:43:11 -   LL =  -56329.5249 (Best:  -56329.5249) [NEW BEST]
2025-11-12 22:43:11 - [단계 2/2] Analytic Gradient 계산 #iter7-1
2025-11-12 22:44:03 - [Line Search 함수 호출 #iter8-1] [단계 1/2] 전체 우도 계산
2025-11-12 22:45:21 -   LL =  -56323.5742 (Best:  -56323.5742) [NEW BEST]
2025-11-12 22:45:21 -   파라미터 변화량 (L2 norm): 3.406365e-02
  함수값 변화: +5.9508 (감소)
2025-11-12 22:45:21 - [단계 2/2] Analytic Gradient 계산 #iter7-2
2025-11-12 22:46:11 - 
[탐색 방향 분석 - Iteration #8]
  탐색 방향 d norm: 3.406365e-02
  탐색 방향 d max: 2.038069e-02
  Gradient norm: 2.487784e+05
  d와 -grad의 코사인 유사도: 0.038598
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.00526968 0.00694006 0.00719091 0.00749162 0.00394236]
  -grad 상위 5개: [ 9845.31049375 10116.71265395  8116.47743062  7411.32940584
 10131.8561494 ]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 1.400474e-01
    - 변화량 max: 7.457836e-02
    - 변화 상위 5개 인덱스: [78 77  3  2 68]
    - 변화 상위 5개 값: [-0.07457836 -0.0364549   0.03149193  0.03130754  0.02859626]

2025-11-12 22:46:11 - [Line Search 함수 호출 #iter9-2] [단계 1/2] 전체 우도 계산
2025-11-12 22:47:29 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 22:47:29 -   파라미터 변화량 (L2 norm): 3.406365e-02
  함수값 변화: +5.9508 (감소)
2025-11-12 22:47:29 - [단계 2/2] Analytic Gradient 계산 #iter8-3
2025-11-12 22:48:20 - ======================================================================
2025-11-12 22:48:20 - ICLV 모델 추정 시작
2025-11-12 22:48:20 - ======================================================================
2025-11-12 22:48:20 - [단계 2/2] Analytic Gradient 계산 #iter8-3
2025-11-12 22:49:14 - [단계 2/2] Analytic Gradient 계산 #iter8-3
2025-11-12 22:50:07 - 
================================================================================
[Major Iteration #8 완료]
  최종 LL: -56323.5742
  Line Search: 2회 함수 호출 - ✓ 성공 (함수값 감소: 5.9508)
  함수 호출: 15회 (누적)
  그래디언트 호출: 15회 (누적)
  수렴 조건:
    - ftol = 1.395052e-04 (기준: 1e-3, 변화: -6.64e-04 [-82.6%]) ✓ 수렴 조건 만족
    - gtol = 5.500442e+04 (기준: 1e-3, 변화: +1.03e+02 [+0.2%])

  전체 파라미터 값 및 그래디언트:
    [ 0] zeta_health_concern_q7                            : param=+1.957910e+00, grad=-9.845310e+03
    [ 1] zeta_health_concern_q8                            : param=+1.958706e+00, grad=-1.011671e+04
    [ 2] zeta_health_concern_q9                            : param=+2.121543e+00, grad=-8.116477e+03
    [ 3] zeta_health_concern_q10                           : param=+2.147560e+00, grad=-7.411329e+03
    [ 4] zeta_health_concern_q11                           : param=+1.916597e+00, grad=-1.013186e+04
    [ 5] sigma_sq_health_concern_q6                        : param=+6.083874e-01, grad=-5.500442e+04
    [ 6] sigma_sq_health_concern_q7                        : param=+5.040201e-01, grad=-3.601744e+04
    [ 7] sigma_sq_health_concern_q8                        : param=+4.952584e-01, grad=-3.514009e+04
    [ 8] sigma_sq_health_concern_q9                        : param=+5.314745e-01, grad=-3.147651e+04
    [ 9] sigma_sq_health_concern_q10                       : param=+6.095807e-01, grad=-2.577806e+04
    [10] sigma_sq_health_concern_q11                       : param=+4.909584e-01, grad=-3.613645e+04
    [11] zeta_perceived_benefit_q13                        : param=+1.027667e+00, grad=-1.076685e+04
    [12] zeta_perceived_benefit_q14                        : param=+1.233745e+00, grad=-1.592657e+04
    [13] zeta_perceived_benefit_q15                        : param=+1.369333e+00, grad=-1.562006e+04
    [14] zeta_perceived_benefit_q16                        : param=+1.276708e+00, grad=-1.528982e+04
    [15] zeta_perceived_benefit_q17                        : param=+1.104609e+00, grad=-1.396005e+04
    [16] sigma_sq_perceived_benefit_q12                    : param=+6.098185e-01, grad=-4.400822e+04
    [17] sigma_sq_perceived_benefit_q13                    : param=+4.769147e-01, grad=-3.130545e+04
    [18] sigma_sq_perceived_benefit_q14                    : param=+5.275862e-01, grad=-4.088787e+04
    [19] sigma_sq_perceived_benefit_q15                    : param=+5.703658e-01, grad=-4.104134e+04
    [20] sigma_sq_perceived_benefit_q16                    : param=+5.719790e-01, grad=-4.330195e+04
    [21] sigma_sq_perceived_benefit_q17                    : param=+5.038631e-01, grad=-3.734194e+04
    [22] zeta_perceived_price_q28                          : param=+1.665244e+00, grad=-3.980597e+03
    [23] zeta_perceived_price_q29                          : param=+1.791135e+00, grad=-3.508279e+03
    [24] sigma_sq_perceived_price_q27                      : param=+7.979718e-01, grad=-4.677603e+04
    [25] sigma_sq_perceived_price_q28                      : param=+7.872397e-01, grad=-3.845629e+04
    [26] sigma_sq_perceived_price_q29                      : param=+7.769769e-01, grad=-4.096586e+04
    [27] zeta_nutrition_knowledge_q31                      : param=+1.300193e+00, grad=-2.027837e+04
    [28] zeta_nutrition_knowledge_q32                      : param=+1.478425e+00, grad=-2.270432e+04
    [29] zeta_nutrition_knowledge_q33                      : param=+1.248109e+00, grad=-1.920632e+04
    [30] zeta_nutrition_knowledge_q34                      : param=+1.489609e+00, grad=-2.457097e+04
    [31] zeta_nutrition_knowledge_q35                      : param=+1.505139e+00, grad=-2.446537e+04
    [32] zeta_nutrition_knowledge_q36                      : param=+1.468222e+00, grad=-2.455665e+04
    [33] zeta_nutrition_knowledge_q37                      : param=+1.301511e+00, grad=-2.122567e+04
    [34] zeta_nutrition_knowledge_q38                      : param=+1.392018e+00, grad=-2.635798e+04
    [35] zeta_nutrition_knowledge_q39                      : param=+1.459535e+00, grad=-2.394622e+04
    [36] zeta_nutrition_knowledge_q40                      : param=+1.200695e+00, grad=-2.181324e+04
    [37] zeta_nutrition_knowledge_q41                      : param=+1.458635e+00, grad=-2.561339e+04
    [38] zeta_nutrition_knowledge_q42                      : param=+1.493163e+00, grad=-2.411444e+04
    [39] zeta_nutrition_knowledge_q43                      : param=+1.517552e+00, grad=-2.398924e+04
    [40] zeta_nutrition_knowledge_q44                      : param=+1.491703e+00, grad=-2.357496e+04
    [41] zeta_nutrition_knowledge_q45                      : param=+1.477434e+00, grad=-2.565602e+04
    [42] zeta_nutrition_knowledge_q46                      : param=+1.354242e+00, grad=-2.228251e+04
    [43] zeta_nutrition_knowledge_q47                      : param=+9.745136e-01, grad=-1.836666e+04
    [44] zeta_nutrition_knowledge_q48                      : param=+1.359765e+00, grad=-2.174972e+04
    [45] zeta_nutrition_knowledge_q49                      : param=+1.232546e+00, grad=-2.185702e+04
    [46] sigma_sq_nutrition_knowledge_q30                  : param=+4.524340e-01, grad=-4.579009e+04
    [47] sigma_sq_nutrition_knowledge_q31                  : param=+3.326298e-01, grad=-2.937762e+04
    [48] sigma_sq_nutrition_knowledge_q32                  : param=+3.237981e-01, grad=-3.297622e+04
    [49] sigma_sq_nutrition_knowledge_q33                  : param=+3.606104e-01, grad=-3.382149e+04
    [50] sigma_sq_nutrition_knowledge_q34                  : param=+3.407470e-01, grad=-3.893446e+04
    [51] sigma_sq_nutrition_knowledge_q35                  : param=+3.111783e-01, grad=-4.041392e+04
    [52] sigma_sq_nutrition_knowledge_q36                  : param=+3.464074e-01, grad=-3.862355e+04
    [53] sigma_sq_nutrition_knowledge_q37                  : param=+3.501294e-01, grad=-3.288203e+04
    [54] sigma_sq_nutrition_knowledge_q38                  : param=+3.500646e-01, grad=-4.236999e+04
    [55] sigma_sq_nutrition_knowledge_q39                  : param=+3.317344e-01, grad=-3.981474e+04
    [56] sigma_sq_nutrition_knowledge_q40                  : param=+3.565861e-01, grad=-3.418007e+04
    [57] sigma_sq_nutrition_knowledge_q41                  : param=+3.337827e-01, grad=-4.063991e+04
    [58] sigma_sq_nutrition_knowledge_q42                  : param=+3.744359e-01, grad=-3.555060e+04
    [59] sigma_sq_nutrition_knowledge_q43                  : param=+3.687321e-01, grad=-3.362979e+04
    [60] sigma_sq_nutrition_knowledge_q44                  : param=+3.195162e-01, grad=-3.859256e+04
    [61] sigma_sq_nutrition_knowledge_q45                  : param=+3.407596e-01, grad=-3.942892e+04
    [62] sigma_sq_nutrition_knowledge_q46                  : param=+3.480648e-01, grad=-3.346300e+04
    [63] sigma_sq_nutrition_knowledge_q47                  : param=+3.630502e-01, grad=-3.046422e+04
    [64] sigma_sq_nutrition_knowledge_q48                  : param=+3.202019e-01, grad=-2.736969e+04
    [65] sigma_sq_nutrition_knowledge_q49                  : param=+3.475910e-01, grad=-3.299328e+04
    [66] zeta_purchase_intention_q19                       : param=+1.147250e+00, grad=-3.909412e+03
    [67] zeta_purchase_intention_q20                       : param=+1.169960e+00, grad=-4.088409e+03
    [68] sigma_sq_purchase_intention_q18                   : param=+1.541161e+00, grad=-9.782792e+03
    [69] sigma_sq_purchase_intention_q19                   : param=+1.476908e+00, grad=-9.324342e+03
    [70] sigma_sq_purchase_intention_q20                   : param=+1.467237e+00, grad=-1.021705e+04
    [71] gamma_health_concern_to_perceived_benefit         : param=+5.180348e-01, grad=-2.073255e+02
    [72] gamma_perceived_benefit_to_purchase_intention     : param=+4.985465e-01, grad=-1.222834e+01
    [73] beta_intercept                                    : param=-1.138146e-01, grad=+3.113511e+03
    [74] beta_sugar_free                                   : param=+2.362005e-01, grad=+1.336536e+00
    [75] beta_health_label                                 : param=+2.310528e-01, grad=-2.402919e+01
    [76] beta_price                                        : param=-2.958455e-01, grad=+1.737646e+03
    [77] lambda_main                                       : param=+3.205688e-01, grad=+4.717222e+03
    [78] lambda_mod_perceived_price                        : param=-1.739702e+00, grad=+9.580320e+03
    [79] lambda_mod_nutrition_knowledge                    : param=+1.068264e+00, grad=+7.159950e+02

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 4.257956e-02
    - y_k (gradient 변화) norm: 2.725464e+03
    - s_k^T · y_k: 4.859756e+01 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 2.057716e-02
    - s_k 상위 5개: [0.0065871  0.00867507 0.00898864 0.00936452 0.00492795]
    - y_k 상위 5개: [123.52811256 193.47517118 100.58015151 134.46740771 122.02173405]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 22:50:07 - [Major Iteration #9 시작] [단계 1/2] 전체 우도 계산
2025-11-12 22:51:25 -   LL =  -56323.8299 (Best:  -56323.5742) 
2025-11-12 22:51:25 - [단계 2/2] Analytic Gradient 계산 #iter8-1
2025-11-12 22:52:16 - [Line Search 함수 호출 #iter9-1] [단계 1/2] 전체 우도 계산
2025-11-12 22:53:33 -   LL =  -56323.6266 (Best:  -56323.5742) 
2025-11-12 22:53:33 -   파라미터 변화량 (L2 norm): 1.360999e-03
  함수값 변화: +0.2033 (감소)
2025-11-12 22:53:33 - [단계 2/2] Analytic Gradient 계산 #iter8-2
2025-11-12 22:54:24 - 
[탐색 방향 분석 - Iteration #9]
  탐색 방향 d norm: 1.360999e-03
  탐색 방향 d max: 9.407206e-04
  Gradient norm: 2.487774e+05
  d와 -grad의 코사인 유사도: -0.037138
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [-0.00018499 -0.00023046 -0.00025721 -0.00026515 -0.0001397 ]
  -grad 상위 5개: [ 9844.40751644 10115.28367224  8115.59220947  7410.69507502
 10130.90161596]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 3.436991e-02
    - 변화량 max: 2.062645e-02
    - 변화 상위 5개 인덱스: [78 77  3  2 73]
    - 변화 상위 5개 값: [-0.02062645 -0.0098602   0.00756089  0.00725811 -0.00702619]

2025-11-12 22:54:24 - [Line Search 함수 호출 #iter9-2] [단계 1/2] 전체 우도 계산
2025-11-12 22:55:42 -   LL =  -56323.5850 (Best:  -56323.5742) 
2025-11-12 22:55:42 -   파라미터 변화량 (L2 norm): 1.642998e-03
  함수값 변화: +0.2449 (감소)
2025-11-12 22:55:42 - [단계 2/2] Analytic Gradient 계산 #iter8-3
2025-11-12 22:56:33 - [Line Search 함수 호출 #iter9-3] [단계 1/2] 전체 우도 계산
2025-11-12 22:57:51 -   LL =  -56323.5764 (Best:  -56323.5742) 
2025-11-12 22:57:51 -   파라미터 변화량 (L2 norm): 1.701348e-03
  함수값 변화: +0.2535 (감소)
2025-11-12 22:57:51 - [단계 2/2] Analytic Gradient 계산 #iter8-4
2025-11-12 22:58:42 - [Line Search 함수 호출 #iter9-4] [단계 1/2] 전체 우도 계산
2025-11-12 23:00:01 -   LL =  -56323.5746 (Best:  -56323.5742) 
2025-11-12 23:00:01 -   파라미터 변화량 (L2 norm): 1.713418e-03
  함수값 변화: +0.2552 (감소)
2025-11-12 23:00:01 - [단계 2/2] Analytic Gradient 계산 #iter8-5
2025-11-12 23:00:53 - [Line Search 함수 호출 #iter9-5] [단계 1/2] 전체 우도 계산
2025-11-12 23:02:12 -   LL =  -56323.5743 (Best:  -56323.5742) 
2025-11-12 23:02:12 -   파라미터 변화량 (L2 norm): 1.715915e-03
  함수값 변화: +0.2556 (감소)
2025-11-12 23:02:12 - [단계 2/2] Analytic Gradient 계산 #iter8-6
2025-11-12 23:03:03 - [Line Search 함수 호출 #iter9-6] [단계 1/2] 전체 우도 계산
2025-11-12 23:03:03 - 
================================================================================
2025-11-12 23:03:03 - Iteration 30 - 파라미터 값
2025-11-12 23:03:03 - ================================================================================
2025-11-12 23:03:03 - 
[측정모델 파라미터]
2025-11-12 23:03:03 -   health_concern:
2025-11-12 23:03:03 -     - zeta: [1.         1.95790967 1.95870619 2.12154317 2.1475598  1.91659672]
2025-11-12 23:03:03 -     - sigma_sq: [0.6083874  0.50402007 0.49525843 0.53147452 0.60958069 0.4909584 ]
2025-11-12 23:03:03 -   perceived_benefit:
2025-11-12 23:03:03 -     - zeta: [1.         1.02766653 1.23374461 1.36933284 1.27670788 1.10460906]
2025-11-12 23:03:03 -     - sigma_sq: [0.60981854 0.47691473 0.52758616 0.57036582 0.57197904 0.50386307]
2025-11-12 23:03:03 -   perceived_price:
2025-11-12 23:03:03 -     - zeta: [1.         1.6652435  1.79113518]
2025-11-12 23:03:03 -     - sigma_sq: [0.79797177 0.78723967 0.77697691]
2025-11-12 23:03:03 -   nutrition_knowledge:
2025-11-12 23:03:03 -     - zeta: [1.         1.30019297 1.4784252  1.24810909 1.48960942 1.5051387
 1.46822172 1.30151082 1.39201809 1.45953522 1.20069455 1.45863521
 1.49316284 1.51755165 1.49170275 1.47743352 1.35424234 0.97451356
 1.35976491 1.23254585]
2025-11-12 23:03:03 -     - sigma_sq: [0.45243396 0.33262979 0.32379812 0.3606104  0.34074702 0.31117833
 0.34640745 0.35012937 0.35006457 0.3317344  0.35658607 0.33378269
 0.37443587 0.36873212 0.31951623 0.34075963 0.34806484 0.3630502
 0.32020187 0.34759097]
2025-11-12 23:03:03 -   purchase_intention:
2025-11-12 23:03:03 -     - zeta: [1.         1.14725001 1.16996029]
2025-11-12 23:03:03 -     - sigma_sq: [1.54116151 1.47690761 1.46723716]
2025-11-12 23:03:03 - 
[구조모델 파라미터]
2025-11-12 23:03:03 -   gamma_health_concern_to_perceived_benefit: 0.518035
2025-11-12 23:03:03 -   gamma_perceived_benefit_to_purchase_intention: 0.498547
2025-11-12 23:03:03 - 
[선택모델 파라미터]
2025-11-12 23:03:03 -   intercept: -0.113815
2025-11-12 23:03:03 -   beta: [ 0.23620049  0.23105285 -0.29584547]
2025-11-12 23:03:03 -   lambda_main: 0.320569
2025-11-12 23:03:03 -   lambda_mod_perceived_price: -1.739702
2025-11-12 23:03:03 -   lambda_mod_nutrition_knowledge: 1.068264
2025-11-12 23:03:03 - ================================================================================
2025-11-12 23:04:22 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:04:22 -   파라미터 변화량 (L2 norm): 1.716432e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:04:22 - [단계 2/2] Analytic Gradient 계산 #iter8-7
2025-11-12 23:05:14 - [Line Search 함수 호출 #iter9-7] [단계 1/2] 전체 우도 계산
2025-11-12 23:06:33 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:06:33 -   파라미터 변화량 (L2 norm): 1.716538e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:06:33 - [단계 2/2] Analytic Gradient 계산 #iter8-8
2025-11-12 23:07:26 - [Line Search 함수 호출 #iter9-8] [단계 1/2] 전체 우도 계산
2025-11-12 23:08:45 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:08:45 -   파라미터 변화량 (L2 norm): 1.716560e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:08:45 - [단계 2/2] Analytic Gradient 계산 #iter8-9
2025-11-12 23:09:36 - [Line Search 함수 호출 #iter9-9] [단계 1/2] 전체 우도 계산
2025-11-12 23:10:53 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:10:53 -   파라미터 변화량 (L2 norm): 1.716565e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:10:53 - [단계 2/2] Analytic Gradient 계산 #iter8-10
2025-11-12 23:11:45 - [Line Search 함수 호출 #iter9-10] [단계 1/2] 전체 우도 계산
2025-11-12 23:13:02 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:13:02 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:13:02 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:13:02 - [단계 2/2] Analytic Gradient 계산 #iter8-11
2025-11-12 23:13:54 - [Line Search 함수 호출 #iter9-11] [단계 1/2] 전체 우도 계산
2025-11-12 23:15:11 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:15:11 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:15:11 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:15:11 - [단계 2/2] Analytic Gradient 계산 #iter8-12
2025-11-12 23:16:02 - [Line Search 함수 호출 #iter9-12] [단계 1/2] 전체 우도 계산
2025-11-12 23:17:19 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:17:19 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:17:19 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:17:19 - [단계 2/2] Analytic Gradient 계산 #iter8-13
2025-11-12 23:18:11 - [Line Search 함수 호출 #iter9-13] [단계 1/2] 전체 우도 계산
2025-11-12 23:19:28 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:19:28 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:19:28 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:19:28 - [단계 2/2] Analytic Gradient 계산 #iter8-14
2025-11-12 23:20:21 - [Line Search 함수 호출 #iter9-14] [단계 1/2] 전체 우도 계산
2025-11-12 23:21:39 -   LL =  -56323.5742 (Best:  -56323.5742) [NEW BEST]
2025-11-12 23:21:39 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:21:39 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:21:39 - [단계 2/2] Analytic Gradient 계산 #iter8-15
2025-11-12 23:22:29 - [Line Search 함수 호출 #iter9-15] [단계 1/2] 전체 우도 계산
2025-11-12 23:23:47 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:23:47 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:23:47 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:23:47 - [단계 2/2] Analytic Gradient 계산 #iter8-16
2025-11-12 23:24:38 - [Line Search 함수 호출 #iter9-16] [단계 1/2] 전체 우도 계산
2025-11-12 23:24:38 - 
================================================================================
2025-11-12 23:24:38 - Iteration 40 - 파라미터 값
2025-11-12 23:24:38 - ================================================================================
2025-11-12 23:24:38 - 
[측정모델 파라미터]
2025-11-12 23:24:38 -   health_concern:
2025-11-12 23:24:38 -     - zeta: [1.         1.95790965 1.95870617 2.12154314 2.14755978 1.9165967 ]
2025-11-12 23:24:38 -     - sigma_sq: [0.60838741 0.50402008 0.49525842 0.53147453 0.60958071 0.49095839]
2025-11-12 23:24:38 -   perceived_benefit:
2025-11-12 23:24:38 -     - zeta: [1.         1.02766654 1.23374461 1.36933285 1.27670787 1.10460906]
2025-11-12 23:24:38 -     - sigma_sq: [0.60981854 0.47691473 0.52758616 0.57036582 0.57197904 0.50386306]
2025-11-12 23:24:38 -   perceived_price:
2025-11-12 23:24:38 -     - zeta: [1.         1.66524351 1.79113518]
2025-11-12 23:24:38 -     - sigma_sq: [0.79797178 0.78723965 0.77697691]
2025-11-12 23:24:38 -   nutrition_knowledge:
2025-11-12 23:24:38 -     - zeta: [1.         1.30019297 1.47842521 1.2481091  1.48960942 1.50513871
 1.46822172 1.30151082 1.39201809 1.45953522 1.20069455 1.45863521
 1.49316284 1.51755165 1.49170275 1.47743352 1.35424234 0.97451356
 1.35976492 1.23254586]
2025-11-12 23:24:38 -     - sigma_sq: [0.45243396 0.33262979 0.32379812 0.3606104  0.34074701 0.31117834
 0.34640744 0.35012937 0.35006457 0.3317344  0.35658607 0.33378268
 0.37443588 0.36873213 0.31951622 0.34075962 0.34806484 0.3630502
 0.32020188 0.34759096]
2025-11-12 23:24:38 -   purchase_intention:
2025-11-12 23:24:38 -     - zeta: [1.         1.14725    1.16996028]
2025-11-12 23:24:38 -     - sigma_sq: [1.54116149 1.4769076  1.46723715]
2025-11-12 23:24:38 - 
[구조모델 파라미터]
2025-11-12 23:24:38 -   gamma_health_concern_to_perceived_benefit: 0.518035
2025-11-12 23:24:38 -   gamma_perceived_benefit_to_purchase_intention: 0.498547
2025-11-12 23:24:38 - 
[선택모델 파라미터]
2025-11-12 23:24:38 -   intercept: -0.113815
2025-11-12 23:24:38 -   beta: [ 0.23620048  0.23105284 -0.29584548]
2025-11-12 23:24:38 -   lambda_main: 0.320569
2025-11-12 23:24:38 -   lambda_mod_perceived_price: -1.739702
2025-11-12 23:24:38 -   lambda_mod_nutrition_knowledge: 1.068264
2025-11-12 23:24:38 - ================================================================================
2025-11-12 23:25:56 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:25:56 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:25:56 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:25:56 - [단계 2/2] Analytic Gradient 계산 #iter8-17
2025-11-12 23:26:48 - [Line Search 함수 호출 #iter9-17] [단계 1/2] 전체 우도 계산
2025-11-12 23:28:05 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:28:05 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:28:05 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:28:05 - [단계 2/2] Analytic Gradient 계산 #iter8-18
2025-11-12 23:28:57 - [Line Search 함수 호출 #iter9-18] [단계 1/2] 전체 우도 계산
2025-11-12 23:30:15 -   LL =  -56323.5742 (Best:  -56323.5742) [NEW BEST]
2025-11-12 23:30:15 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:30:15 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:30:15 - [단계 2/2] Analytic Gradient 계산 #iter8-19
2025-11-12 23:31:09 - [Line Search 함수 호출 #iter9-19] [단계 1/2] 전체 우도 계산
2025-11-12 23:32:27 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:32:27 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:32:27 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:32:27 - [단계 2/2] Analytic Gradient 계산 #iter8-20
2025-11-12 23:33:18 - [Line Search 함수 호출 #iter9-20] [단계 1/2] 전체 우도 계산
2025-11-12 23:34:37 -   LL =  -56323.5742 (Best:  -56323.5742) 
2025-11-12 23:34:37 -   파라미터 변화량 (L2 norm): 1.716566e-03
  함수값 변화: +0.2557 (감소)
2025-11-12 23:34:37 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 56323.8299
  현재 함수값: 56323.5742
  변화량: -0.2557
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-12 23:34:37 - [단계 2/2] Analytic Gradient 계산 #iter8-21
