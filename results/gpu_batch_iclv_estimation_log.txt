2025-11-14 21:10:42 - SimultaneousEstimator.estimate() 시작
2025-11-14 21:10:42 - 데이터 shape: (5868, 60)
2025-11-14 21:10:42 - 개인 수: 326
2025-11-14 21:10:42 - Halton draws 이미 설정됨 (건너뛰기)
2025-11-14 21:10:42 - Analytic gradient calculators 초기화 (Apollo 방식)...
2025-11-14 21:10:42 - 다중 잠재변수 측정모델 gradient 초기화: 5개 LV
2025-11-14 21:10:42 - 다중 잠재변수 구조모델 gradient 초기화
2025-11-14 21:10:42 - GPU 배치 그래디언트 활성화
2025-11-14 21:10:42 - 다중 잠재변수 JointGradient 초기화 완료
2025-11-14 21:10:42 - 초기 파라미터 설정 시작...
2025-11-14 21:10:42 - 초기 파라미터 설정 완료 (총 80개)
2025-11-14 21:10:42 - ================================================================================
2025-11-14 21:10:42 - 파라미터 스케일링 비활성화
2025-11-14 21:10:42 - ================================================================================
2025-11-14 21:10:42 - ================================================================================
2025-11-14 21:10:42 - Custom Parameter Scaling Initialized (Gradient-Balanced)
2025-11-14 21:10:42 - ================================================================================
2025-11-14 21:10:42 - Total parameters: 80
2025-11-14 21:10:42 - 
2025-11-14 21:10:42 - Scale factors:
2025-11-14 21:10:42 -   zeta_health_concern_q7        :     1.000000
2025-11-14 21:10:42 -   zeta_health_concern_q8        :     1.000000
2025-11-14 21:10:42 -   zeta_health_concern_q9        :     1.000000
2025-11-14 21:10:42 -   zeta_health_concern_q10       :     1.000000
2025-11-14 21:10:42 -   zeta_health_concern_q11       :     1.000000
2025-11-14 21:10:42 -   sigma_sq_health_concern_q6    :     1.000000
2025-11-14 21:10:42 -   sigma_sq_health_concern_q7    :     1.000000
2025-11-14 21:10:42 -   sigma_sq_health_concern_q8    :     1.000000
2025-11-14 21:10:42 -   sigma_sq_health_concern_q9    :     1.000000
2025-11-14 21:10:42 -   sigma_sq_health_concern_q10   :     1.000000
2025-11-14 21:10:42 -   sigma_sq_health_concern_q11   :     1.000000
2025-11-14 21:10:42 -   zeta_perceived_benefit_q13    :     1.000000
2025-11-14 21:10:42 -   zeta_perceived_benefit_q14    :     1.000000
2025-11-14 21:10:42 -   zeta_perceived_benefit_q15    :     1.000000
2025-11-14 21:10:42 -   zeta_perceived_benefit_q16    :     1.000000
2025-11-14 21:10:42 -   zeta_perceived_benefit_q17    :     1.000000
2025-11-14 21:10:42 -   sigma_sq_perceived_benefit_q12:     1.000000
2025-11-14 21:10:42 -   sigma_sq_perceived_benefit_q13:     1.000000
2025-11-14 21:10:42 -   sigma_sq_perceived_benefit_q14:     1.000000
2025-11-14 21:10:42 -   sigma_sq_perceived_benefit_q15:     1.000000
2025-11-14 21:10:42 -   sigma_sq_perceived_benefit_q16:     1.000000
2025-11-14 21:10:42 -   sigma_sq_perceived_benefit_q17:     1.000000
2025-11-14 21:10:42 -   zeta_perceived_price_q28      :     1.000000
2025-11-14 21:10:42 -   zeta_perceived_price_q29      :     1.000000
2025-11-14 21:10:42 -   sigma_sq_perceived_price_q27  :     1.000000
2025-11-14 21:10:42 -   sigma_sq_perceived_price_q28  :     1.000000
2025-11-14 21:10:42 -   sigma_sq_perceived_price_q29  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q31  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q32  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q33  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q34  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q35  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q36  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q37  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q38  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q39  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q40  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q41  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q42  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q43  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q44  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q45  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q46  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q47  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q48  :     1.000000
2025-11-14 21:10:42 -   zeta_nutrition_knowledge_q49  :     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q30:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q31:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q32:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q33:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q34:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q35:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q36:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q37:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q38:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q39:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q40:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q41:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q42:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q43:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q44:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q45:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q46:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q47:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q48:     1.000000
2025-11-14 21:10:42 -   sigma_sq_nutrition_knowledge_q49:     1.000000
2025-11-14 21:10:42 -   zeta_purchase_intention_q19   :     1.000000
2025-11-14 21:10:42 -   zeta_purchase_intention_q20   :     1.000000
2025-11-14 21:10:42 -   sigma_sq_purchase_intention_q18:     1.000000
2025-11-14 21:10:42 -   sigma_sq_purchase_intention_q19:     1.000000
2025-11-14 21:10:42 -   sigma_sq_purchase_intention_q20:     1.000000
2025-11-14 21:10:42 -   gamma_health_concern_to_perceived_benefit:     1.000000
2025-11-14 21:10:42 -   gamma_perceived_benefit_to_purchase_intention:     1.000000
2025-11-14 21:10:42 -   beta_intercept                :     1.000000
2025-11-14 21:10:42 -   beta_sugar_free               :     1.000000
2025-11-14 21:10:42 -   beta_health_label             :     1.000000
2025-11-14 21:10:42 -   beta_price                    :     1.000000
2025-11-14 21:10:42 -   lambda_main                   :     1.000000
2025-11-14 21:10:42 -   lambda_mod_perceived_price    :     1.000000
2025-11-14 21:10:42 -   lambda_mod_nutrition_knowledge:     1.000000
2025-11-14 21:10:42 - ================================================================================
2025-11-14 21:10:42 - 파라미터 bounds 계산 시작...
2025-11-14 21:10:42 - 파라미터 bounds 계산 완료 (총 80개)
2025-11-14 21:10:42 - 최대 반복 횟수: 1000
2025-11-14 21:10:42 - ======================================================================
2025-11-14 21:10:42 - 순차처리 사용
2025-11-14 21:10:42 - 최적화 시작: BHHH (gradient-based)
2025-11-14 21:10:42 - Analytic gradient 사용 (Apollo 방식)
2025-11-14 21:10:42 - 조기 종료 비활성화 (정상 종료만 사용)
2025-11-14 21:10:42 - BHHH 최적화 알고리즘 초기화...
2025-11-14 21:10:42 -   - 방법: Newton-CG with OPG (Outer Product of Gradients)
2025-11-14 21:10:42 -   - Hessian 계산: 각 iteration마다 개인별 gradient로 OPG 계산
2025-11-14 21:10:42 - BHHH 옵션: xtol=1e-05
2025-11-14 21:10:42 - [Major Iteration #1 시작] [단계 1/2] 전체 우도 계산
2025-11-14 21:10:42 -   측정모델 health_concern: zeta[0]=1.0000, sigma_sq[0]=3.8647
2025-11-14 21:10:42 -   구조모델 (계층적): gamma_health_concern_to_perceived_benefit=1.780750
2025-11-14 21:10:42 -   선택모델 (조절): intercept=-1.417551, lambda_main=-3.730210, lambda_mod_perceived_price=-8.554751
2025-11-14 21:10:42 - 
================================================================================
2025-11-14 21:10:42 - Iteration 1 - 파라미터 값
2025-11-14 21:10:42 - ================================================================================
2025-11-14 21:10:42 - 
[측정모델 파라미터]
2025-11-14 21:10:42 -   health_concern:
2025-11-14 21:10:42 -     - zeta: [1.       3.057237 3.01138  3.173862 3.217228 2.974514]
2025-11-14 21:10:42 -     - sigma_sq: [3.864668 2.18714  2.246337 2.228297 2.364601 2.207417]
2025-11-14 21:10:42 -   perceived_benefit:
2025-11-14 21:10:42 -     - zeta: [1.       1.037288 1.371762 1.516105 1.480759 1.233572]
2025-11-14 21:10:42 -     - sigma_sq: [2.92292  1.804884 2.145589 2.339271 2.33027  1.905254]
2025-11-14 21:10:42 -   perceived_price:
2025-11-14 21:10:42 -     - zeta: [1.       2.855975 2.830507]
2025-11-14 21:10:42 -     - sigma_sq: [4.29789  3.547512 3.696596]
2025-11-14 21:10:42 -   nutrition_knowledge:
2025-11-14 21:10:42 -     - zeta: [1.       2.685624 3.038699 2.556703 3.11136  3.113229 3.100313 2.694394
 3.045692 3.080931 2.537128 3.081512 3.22641  3.224173 3.089504 3.185674
 2.876741 2.048112 2.797846 2.637763]
2025-11-14 21:10:42 -     - sigma_sq: [3.347495 1.033751 0.979497 1.52678  1.242678 0.999206 1.217285 1.38065
 1.186172 0.993093 1.49884  1.199043 1.039658 1.075677 0.984363 0.89612
 1.026117 1.55202  0.945691 1.126017]
2025-11-14 21:10:42 -   purchase_intention:
2025-11-14 21:10:42 -     - zeta: [1.       1.623188 1.66194 ]
2025-11-14 21:10:42 -     - sigma_sq: [4.587242 4.405831 4.517172]
2025-11-14 21:10:42 - 
[구조모델 파라미터]
2025-11-14 21:10:42 -   gamma_health_concern_to_perceived_benefit: 1.780750
2025-11-14 21:10:42 -   gamma_perceived_benefit_to_purchase_intention: 0.061141
2025-11-14 21:10:42 - 
[선택모델 파라미터]
2025-11-14 21:10:42 -   intercept: -1.417551
2025-11-14 21:10:42 -   beta: [1.31269  1.19     0.004965]
2025-11-14 21:10:42 -   lambda_main: -3.730210
2025-11-14 21:10:42 -   lambda_mod_perceived_price: -8.554751
2025-11-14 21:10:42 -   lambda_mod_nutrition_knowledge: 8.573049
2025-11-14 21:10:42 - ================================================================================
2025-11-14 21:10:43 - [구조모델 예측 - 계층적] Draw 0:
2025-11-14 21:10:43 -   1차 LV draws: [-1.37059446  1.41543841 -2.24983637  0.31765022]
2025-11-14 21:10:43 -   2차+ LV 오차항: {'perceived_benefit': np.float64(0.11916846740100552), 'purchase_intention': np.float64(0.14646561656071386)}
2025-11-14 21:10:43 -   예측된 LV: {'health_concern': np.float64(-1.3705944565341344), 'perceived_benefit': np.float64(-2.3215176110721543), 'perceived_price': np.float64(-2.249836365937222), 'nutrition_knowledge': np.float64(0.3176502214967085), 'purchase_intention': np.float64(0.004525708302151266)}
2025-11-14 21:10:43 - 
[측정모델 우도 계산 시작]
2025-11-14 21:10:43 -   개인 데이터 shape: (18, 60)
2025-11-14 21:10:43 -   LV 개수: 100
2025-11-14 21:10:43 -   측정모델 우도 (처음 5개): [-300.97324934 -748.1597163  -111.46514131 -110.39031976 -300.87906022]
2025-11-14 21:10:43 -   측정모델 우도 범위: [-1144.99, -68.13]
2025-11-14 21:10:43 -   측정모델 우도 평균: -335.05
2025-11-14 21:10:43 - 
[선택모델 우도 계산 시작]
2025-11-14 21:10:43 -   선택 상황 수: 18
2025-11-14 21:10:43 -   선택모델 우도 (처음 5개): [  -8.04653995 -138.15510558   -8.179481    -27.97229496 -138.15510558]
2025-11-14 21:10:43 -   선택모델 우도 범위: [-138.16, -8.05]
2025-11-14 21:10:43 -   선택모델 우도 평균: -74.06
2025-11-14 21:10:43 - 
[구조모델 우도 계산 시작]
2025-11-14 21:10:43 -   경로 health_concern->perceived_benefit: 예측=-2.4407, 실제=-2.3215, LL=-0.9260
2025-11-14 21:10:43 -   경로 perceived_benefit->purchase_intention: 예측=-0.1419, 실제=0.0045, LL=-0.9297
2025-11-14 21:10:43 -   구조모델 우도 (처음 5개): [-1.85570372 -3.27096531 -2.00042653 -2.86979936 -2.68971947]
2025-11-14 21:10:43 -   구조모델 우도 범위: [-6.60, -1.85]
2025-11-14 21:10:43 -   구조모델 우도 평균: -2.85
2025-11-14 21:10:43 - 
[결합 우도 계산] Draw 0:
2025-11-14 21:10:43 -   측정모델: -300.9732
2025-11-14 21:10:43 -   선택모델: -8.0465
2025-11-14 21:10:43 -   구조모델: -1.8557
2025-11-14 21:10:43 -   합계: -310.8755
2025-11-14 21:10:43 - 
[전체 draws 통계]
2025-11-14 21:10:43 -   Draw 우도 범위: [-1285.79, -107.12]
2025-11-14 21:10:43 -   Draw 우도 평균: -411.95
2025-11-14 21:10:43 - ================================================================================
2025-11-14 21:10:43 - ================================================================================
2025-11-14 21:10:43 - 두 번째 함수 호출 - 파라미터 변화 확인
2025-11-14 21:10:43 - ================================================================================
2025-11-14 21:10:43 - [파라미터 확인]
2025-11-14 21:10:43 -   측정모델 zeta (health_concern 처음 3개): [1.       3.057237 3.01138 ]
2025-11-14 21:10:43 -   구조모델 (계층적) gamma_health_concern_to_perceived_benefit: 1.78075
2025-11-14 21:10:43 -   선택모델 intercept: -1.417551
2025-11-14 21:10:43 -   선택모델 beta: [1.31269  1.19     0.004965]
2025-11-14 21:10:43 -   선택모델 lambda_main: -3.73021
2025-11-14 21:10:43 -   선택모델 lambda_mod_perceived_price: -8.554751
2025-11-14 21:10:43 -   선택모델 lambda_mod_nutrition_knowledge: 8.573049
2025-11-14 21:10:43 - ================================================================================
2025-11-14 21:12:01 -   LL =  -28846.7150 (Best:  -28846.7150) [NEW BEST]
2025-11-14 21:12:01 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:12:01 -   측정모델 health_concern: zeta[0]=1.0000, sigma_sq[0]=3.8647
2025-11-14 21:12:01 -   구조모델 (계층적): gamma_health_concern_to_perceived_benefit=1.780750
2025-11-14 21:12:01 -   선택모델 (조절): intercept=-1.417551, lambda_main=-3.730210, lambda_mod_perceived_price=-8.554751
2025-11-14 21:12:02 - 
[Gradient 방향 검증 - External (원본)]
  Gradient norm: 1.370578e+04
  Gradient max: 4.829759e+03
  Gradient (처음 5개): [455.73160856 436.99930974 464.42878396 443.80253644 439.35892345]
  Gradient (마지막 5개): [  23.29599639  282.40336068 -110.49588793  254.83550327 -253.95599375]

2025-11-14 21:12:02 - 
[Gradient 방향 검증 - Internal (스케일됨)]
  Gradient norm: 1.370578e+04
  Gradient max: 4.829759e+03
  Gradient (처음 5개): [455.73160856 436.99930974 464.42878396 443.80253644 439.35892345]
  Gradient (마지막 5개): [  23.29599639  282.40336068 -110.49588793  254.83550327 -253.95599375]
  주의: scipy는 이 gradient를 사용하여 descent direction을 계산합니다.
       d = -H^(-1) · gradient이므로, gradient가 양수면 d는 음수 방향입니다.
2025-11-14 21:12:02 - 
2025-11-14 21:12:02 - Gradient Scaling Comparison:
2025-11-14 21:12:02 - --------------------------------------------------------------------------------
2025-11-14 21:12:02 - Parameter                       Grad(External)  Grad(Internal)        Scale
2025-11-14 21:12:02 - --------------------------------------------------------------------------------
2025-11-14 21:12:02 - zeta_health_concern_q7            4.557316e+02    4.557316e+02     1.000000
2025-11-14 21:12:02 - zeta_health_concern_q8            4.369993e+02    4.369993e+02     1.000000
2025-11-14 21:12:02 - zeta_health_concern_q9            4.644288e+02    4.644288e+02     1.000000
2025-11-14 21:12:02 - zeta_health_concern_q10           4.438025e+02    4.438025e+02     1.000000
2025-11-14 21:12:02 - zeta_health_concern_q11           4.393589e+02    4.393589e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_health_concern_q6       -1.310924e+02   -1.310924e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_health_concern_q7       -7.223221e+02   -7.223221e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_health_concern_q8       -6.689051e+02   -6.689051e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_health_concern_q9       -7.511944e+02   -7.511944e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_health_concern_q10      -6.927045e+02   -6.927045e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_health_concern_q11      -6.742359e+02   -6.742359e+02     1.000000
2025-11-14 21:12:02 - zeta_perceived_benefit_q13        5.938706e+02    5.938706e+02     1.000000
2025-11-14 21:12:02 - zeta_perceived_benefit_q14        6.610535e+02    6.610535e+02     1.000000
2025-11-14 21:12:02 - zeta_perceived_benefit_q15        6.700433e+02    6.700433e+02     1.000000
2025-11-14 21:12:02 - zeta_perceived_benefit_q16        6.566826e+02    6.566826e+02     1.000000
2025-11-14 21:12:02 - zeta_perceived_benefit_q17        6.688094e+02    6.688094e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_perceived_benefit_q12   -2.504090e+02   -2.504090e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_perceived_benefit_q13   -4.323698e+02   -4.323698e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_perceived_benefit_q14   -5.368185e+02   -5.368185e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_perceived_benefit_q15   -5.490431e+02   -5.490431e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_perceived_benefit_q16   -5.249851e+02   -5.249851e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_perceived_benefit_q17   -5.400243e+02   -5.400243e+02     1.000000
2025-11-14 21:12:02 - zeta_perceived_price_q28          2.625293e+02    2.625293e+02     1.000000
2025-11-14 21:12:02 - zeta_perceived_price_q29          2.497194e+02    2.497194e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_perceived_price_q27     -9.487004e+01   -9.487004e+01     1.000000
2025-11-14 21:12:02 - sigma_sq_perceived_price_q28     -2.281796e+02   -2.281796e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_perceived_price_q29     -2.129877e+02   -2.129877e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q31      8.465569e+02    8.465569e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q32      1.011146e+03    1.011146e+03     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q33      5.459819e+02    5.459819e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q34      8.158046e+02    8.158046e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q35      1.015501e+03    1.015501e+03     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q36      8.303252e+02    8.303252e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q37      6.363138e+02    6.363138e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q38      8.367308e+02    8.367308e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q39      1.011246e+03    1.011246e+03     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q40      5.517811e+02    5.517811e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q41      8.378286e+02    8.378286e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q42      1.011488e+03    1.011488e+03     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q43      9.771595e+02    9.771595e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q44      1.022861e+03    1.022861e+03     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q45      1.158995e+03    1.158995e+03     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q46      9.139005e+02    9.139005e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q47      4.300595e+02    4.300595e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q48      9.641497e+02    9.641497e+02     1.000000
2025-11-14 21:12:02 - zeta_nutrition_knowledge_q49      7.629870e+02    7.629870e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q30   -1.622644e+02   -1.622644e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q31   -2.593178e+03   -2.593178e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q32   -3.687560e+03   -3.687560e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q33   -1.098624e+03   -1.098624e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q34   -2.420812e+03   -2.420812e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q35   -3.720766e+03   -3.720766e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q36   -2.498365e+03   -2.498365e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q37   -1.477431e+03   -1.477431e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q38   -2.535227e+03   -2.535227e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q39   -3.687308e+03   -3.687308e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q40   -1.116969e+03   -1.116969e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q41   -2.545376e+03   -2.545376e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q42   -3.686998e+03   -3.686998e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q43   -3.453754e+03   -3.453754e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q44   -3.775663e+03   -3.775663e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q45   -4.829759e+03   -4.829759e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q46   -3.016955e+03   -3.016955e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q47   -6.878394e+02   -6.878394e+02     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q48   -3.347757e+03   -3.347757e+03     1.000000
2025-11-14 21:12:02 - sigma_sq_nutrition_knowledge_q49   -2.111811e+03   -2.111811e+03     1.000000
2025-11-14 21:12:02 - zeta_purchase_intention_q19       1.428574e+00    1.428574e+00     1.000000
2025-11-14 21:12:02 - zeta_purchase_intention_q20       1.430566e+00    1.430566e+00     1.000000
2025-11-14 21:12:02 - sigma_sq_purchase_intention_q18   -6.772963e+01   -6.772963e+01     1.000000
2025-11-14 21:12:02 - sigma_sq_purchase_intention_q19   -6.712440e+01   -6.712440e+01     1.000000
2025-11-14 21:12:02 - sigma_sq_purchase_intention_q20   -6.905732e+01   -6.905732e+01     1.000000
2025-11-14 21:12:02 - gamma_health_concern_to_perceived_benefit   -0.000000e+00   -0.000000e+00     1.000000
2025-11-14 21:12:02 - gamma_perceived_benefit_to_purchase_intention   -0.000000e+00   -0.000000e+00     1.000000
2025-11-14 21:12:02 - beta_intercept                    3.475312e+02    3.475312e+02     1.000000
2025-11-14 21:12:02 - beta_sugar_free                   4.384657e+01    4.384657e+01     1.000000
2025-11-14 21:12:02 - beta_health_label                 2.329600e+01    2.329600e+01     1.000000
2025-11-14 21:12:02 - beta_price                        2.824034e+02    2.824034e+02     1.000000
2025-11-14 21:12:02 - lambda_main                      -1.104959e+02   -1.104959e+02     1.000000
2025-11-14 21:12:02 - lambda_mod_perceived_price        2.548355e+02    2.548355e+02     1.000000
2025-11-14 21:12:02 - lambda_mod_nutrition_knowledge   -2.539560e+02   -2.539560e+02     1.000000
2025-11-14 21:12:02 - --------------------------------------------------------------------------------
2025-11-14 21:12:02 - External gradient norm: 1.370578e+04
2025-11-14 21:12:02 - Internal gradient norm: 1.370578e+04
2025-11-14 21:12:02 - External gradient max:  4.829759e+03
2025-11-14 21:12:02 - Internal gradient max:  4.829759e+03
2025-11-14 21:12:02 - --------------------------------------------------------------------------------
2025-11-14 21:12:02 - 
================================================================================
[Major Iteration #1 시작]
================================================================================
2025-11-14 21:12:02 - 
================================================================================
BHHH Hessian 계산 #1
================================================================================
2025-11-14 21:12:02 -   측정모델 health_concern: zeta[0]=1.0000, sigma_sq[0]=3.8647
2025-11-14 21:12:02 -   구조모델 (계층적): gamma_health_concern_to_perceived_benefit=1.780750
2025-11-14 21:12:02 -   선택모델 (조절): intercept=-1.417551, lambda_main=-3.730210, lambda_mod_perceived_price=-8.554751
2025-11-14 21:12:02 - 개인별 gradient 계산 시작...
2025-11-14 21:12:02 -   ✅ 완전 GPU Batch 모드: 326명 동시 처리
2025-11-14 21:12:02 -   데이터 준비 완료 (0.027초): all_ind_draws shape = (326, 100, 6)
2025-11-14 21:12:02 - 
======================================================================
완전 병렬 Gradient 계산 (Advanced Indexing)
======================================================================
  개인 수: 326
  Draws: 100
  차원: 6
2025-11-14 21:12:02 -   LV 계산 완료 (0.077초)
    - all_lvs shape: (326, 100, 5)
2025-11-14 21:12:02 -   완전 병렬 측정모델 Gradient 계산 시작
    - 총 지표 수: 38개
    - 총 파라미터 수: 71개 (33 zeta + 38 sigma_sq)
    - LV 수: 5개
    - 매핑: {'health_concern': 6, 'perceived_benefit': 6, 'perceived_price': 3, 'nutrition_knowledge': 20, 'purchase_intention': 3}
2025-11-14 21:12:02 -   ✅ 완전 병렬 측정모델 Gradient 계산 완료 (0.0747초)
    - GPU 커널 호출: 1번
    - 지표 수: 38개
    - 파라미터 수: 71개 (33 zeta + 38 sigma_sq)
    - 계산량: 326 × 100 × 38 × 2 = 2,477,600개 (zeta + sigma_sq)
2025-11-14 21:12:02 - 
======================================================================
완전 병렬 Gradient 계산 완료 (0.335초)
======================================================================
  시간 분석:
    - LV 계산:      0.077초 (22.9%)
    - 측정모델:     0.075초 (22.3%)
    - 구조모델:     0.001초 (0.3%)
    - 선택모델:     0.180초 (53.6%)
  성능:
    - 개인당 시간:  1.03ms
    - 처리량:       972.7 개인/초
======================================================================
2025-11-14 21:12:02 -   GPU Batch gradient 계산 완료 (0.336초)
2025-11-14 21:12:02 -   개인별 gradient 벡터 변환 시작 (326명)...
2025-11-14 21:12:02 -   개인 0 (ID=1): gradient norm = 5.330276e+01
2025-11-14 21:12:02 -   개인 1 (ID=3): gradient norm = 3.501719e+01
2025-11-14 21:12:02 -   개인 2 (ID=5): gradient norm = 4.777418e+01
2025-11-14 21:12:02 - ✅ 완전 GPU Batch gradient 계산 완료: 326명
2025-11-14 21:12:02 -   Gradient norm 통계: min=2.967197e+01, max=6.215045e+01, mean=4.352755e+01
2025-11-14 21:12:02 - OPG 행렬 계산 중...
2025-11-14 21:12:02 - 
================================================================================
OPG (Outer Product of Gradients) 계산 시작
================================================================================
  개인 수: 326명
  파라미터 수: 80개
  최소화 문제: True
  계산 방식: BHHH = Σ_i (grad_i × grad_i^T)
================================================================================
2025-11-14 21:12:02 - 
개인 0 OPG 계산:
  Gradient shape: (80,)
  Gradient norm: 5.330276e+01
  Gradient 범위: [-3.567154e+00, 2.145295e+01]
  Outer product shape: (80, 80)
  Outer product 대각 범위: [0.000000e+00, 4.602289e+02]
2025-11-14 21:12:02 - 
개인 1 OPG 계산:
  Gradient shape: (80,)
  Gradient norm: 3.501719e+01
  Gradient 범위: [-3.611082e+00, 1.267981e+01]
  Outer product shape: (80, 80)
  Outer product 대각 범위: [0.000000e+00, 1.607777e+02]
2025-11-14 21:12:02 - 
개인 2 OPG 계산:
  Gradient shape: (80,)
  Gradient norm: 4.777418e+01
  Gradient 범위: [-3.463624e+00, 1.680908e+01]
  Outer product shape: (80, 80)
  Outer product 대각 범위: [0.000000e+00, 2.825452e+02]
2025-11-14 21:12:02 - 
================================================================================
개인별 Gradient 통계 (OPG 계산 전)
================================================================================
  Gradient norm 통계:
    - 최소: 2.967197e+01
    - 최대: 6.215045e+01
    - 평균: 4.352755e+01
    - 중앙값: 4.345688e+01
    - 표준편차: 7.373285e+00
  Zero gradient 개수: 0/326
================================================================================
2025-11-14 21:12:02 - 
================================================================================
OPG 행렬 통계 (부호 변경 전)
================================================================================
  Shape: (80, 80)
  대각 원소 범위: [0.000000e+00, 7.743097e+04]
  전체 원소 범위: [-1.718137e+04, 7.743097e+04]
  대각 원소 평균: 7.942229e+03
  대칭성 확인: True
================================================================================
2025-11-14 21:12:02 - 
최소화 문제이므로 OPG 행렬에 음수 부호 적용: BHHH = -OPG
2025-11-14 21:12:02 - 
================================================================================
BHHH Hessian (최종) 통계
================================================================================
  Shape: (80, 80)
  대각 원소:
    - 범위: [-7.743097e+04, -0.000000e+00]
    - 평균: -7.942229e+03
    - 중앙값: -1.499351e+03
    - 음수 개수: 78/80
  비대각 원소:
    - 범위: [-5.916415e+04, 1.718137e+04]
    - 평균: -6.093978e+02
    - 절대값 평균: 3.307472e+03
================================================================================

2025-11-14 21:12:02 - OPG 계산 완료 (0.004초)
2025-11-14 21:12:02 - 
================================================================================
BHHH Hessian 계산 완료 (총 0.376초)
================================================================================
  Shape: (80, 80)
  시간 분석:
    - 데이터 준비: 0.027초
    - GPU Batch gradient: 0.336초
    - OPG 계산: 0.004초
  성능:
    - 개인당 시간: 1.15ms
    - 처리량: 865.9 개인/초
================================================================================
2025-11-14 21:12:02 - [Line Search 함수 호출 #iter1-1] [단계 1/2] 전체 우도 계산
2025-11-14 21:12:02 - 
================================================================================
2025-11-14 21:12:02 - Iteration 2 - 파라미터 값
2025-11-14 21:12:02 - ================================================================================
2025-11-14 21:12:02 - 
[측정모델 파라미터]
2025-11-14 21:12:02 -   health_concern:
2025-11-14 21:12:02 -     - zeta: [1.       3.057237 3.01138  3.173862 3.217228 2.974514]
2025-11-14 21:12:02 -     - sigma_sq: [3.864668 2.18714  2.246337 2.228297 2.364601 2.207417]
2025-11-14 21:12:02 -   perceived_benefit:
2025-11-14 21:12:02 -     - zeta: [1.       1.037288 1.371762 1.516105 1.480759 1.233572]
2025-11-14 21:12:02 -     - sigma_sq: [2.92292  1.804884 2.145589 2.339271 2.33027  1.905254]
2025-11-14 21:12:02 -   perceived_price:
2025-11-14 21:12:02 -     - zeta: [1.       2.855975 2.830507]
2025-11-14 21:12:02 -     - sigma_sq: [4.29789  3.547512 3.696596]
2025-11-14 21:12:02 -   nutrition_knowledge:
2025-11-14 21:12:02 -     - zeta: [1.       2.685624 3.038699 2.556703 3.11136  3.113229 3.100313 2.694394
 3.045692 3.080931 2.537128 3.081512 3.22641  3.224173 3.089504 3.185674
 2.876741 2.048112 2.797846 2.637763]
2025-11-14 21:12:02 -     - sigma_sq: [3.347495 1.033751 0.979497 1.52678  1.242678 0.999206 1.217285 1.38065
 1.186172 0.993093 1.49884  1.199043 1.039658 1.075677 0.984363 0.89612
 1.026117 1.55202  0.945691 1.126017]
2025-11-14 21:12:02 -   purchase_intention:
2025-11-14 21:12:02 -     - zeta: [1.       1.623188 1.66194 ]
2025-11-14 21:12:02 -     - sigma_sq: [4.587242 4.405831 4.517172]
2025-11-14 21:12:02 - 
[구조모델 파라미터]
2025-11-14 21:12:02 -   gamma_health_concern_to_perceived_benefit: 1.780750
2025-11-14 21:12:02 -   gamma_perceived_benefit_to_purchase_intention: 0.061141
2025-11-14 21:12:02 - 
[선택모델 파라미터]
2025-11-14 21:12:02 -   intercept: -1.417551
2025-11-14 21:12:02 -   beta: [1.31269  1.19     0.004965]
2025-11-14 21:12:02 -   lambda_main: -3.730210
2025-11-14 21:12:02 -   lambda_mod_perceived_price: -8.554751
2025-11-14 21:12:02 -   lambda_mod_nutrition_knowledge: 8.573049
2025-11-14 21:12:02 - ================================================================================
2025-11-14 21:13:22 -   LL =  -28846.7150 (Best:  -28846.7150) 
2025-11-14 21:13:22 -   파라미터 변화량 (L2 norm): 0.000000e+00
  함수값 변화: +0.0000 (증가)
2025-11-14 21:13:22 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:13:22 - 
[탐색 방향 분석 - Iteration #1]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 1.370578e+04
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [-455.73160856 -436.99930974 -464.42878396 -443.80253644 -439.35892345]
  → Hessian이 방향을 조정함

2025-11-14 21:13:22 - ======================================================================
2025-11-14 21:13:22 - ICLV 모델 추정 시작
2025-11-14 21:13:22 - ======================================================================
2025-11-14 21:13:22 - 
================================================================================
[Major Iteration #1 완료]
  최종 LL: -28846.7150
  파라미터 변화량 (L2 norm): 0.000000e+00
  LL 변화: +0.0000
  Gradient norm: 1.370578e+04

  전체 파라미터 값 및 그래디언트:
    [ 0] zeta_health_concern_q7                            : param=+3.057237e+00, grad=+4.557316e+02
    [ 1] zeta_health_concern_q8                            : param=+3.011380e+00, grad=+4.369993e+02
    [ 2] zeta_health_concern_q9                            : param=+3.173862e+00, grad=+4.644288e+02
    [ 3] zeta_health_concern_q10                           : param=+3.217228e+00, grad=+4.438025e+02
    [ 4] zeta_health_concern_q11                           : param=+2.974514e+00, grad=+4.393589e+02
    [ 5] sigma_sq_health_concern_q6                        : param=+3.864668e+00, grad=-1.310924e+02
    [ 6] sigma_sq_health_concern_q7                        : param=+2.187140e+00, grad=-7.223221e+02
    [ 7] sigma_sq_health_concern_q8                        : param=+2.246337e+00, grad=-6.689051e+02
    [ 8] sigma_sq_health_concern_q9                        : param=+2.228297e+00, grad=-7.511944e+02
    [ 9] sigma_sq_health_concern_q10                       : param=+2.364601e+00, grad=-6.927045e+02
    [10] sigma_sq_health_concern_q11                       : param=+2.207417e+00, grad=-6.742359e+02
    [11] zeta_perceived_benefit_q13                        : param=+1.037288e+00, grad=+5.938706e+02
    [12] zeta_perceived_benefit_q14                        : param=+1.371762e+00, grad=+6.610535e+02
    [13] zeta_perceived_benefit_q15                        : param=+1.516105e+00, grad=+6.700433e+02
    [14] zeta_perceived_benefit_q16                        : param=+1.480759e+00, grad=+6.566826e+02
    [15] zeta_perceived_benefit_q17                        : param=+1.233572e+00, grad=+6.688094e+02
    [16] sigma_sq_perceived_benefit_q12                    : param=+2.922920e+00, grad=-2.504090e+02
    [17] sigma_sq_perceived_benefit_q13                    : param=+1.804884e+00, grad=-4.323698e+02
    [18] sigma_sq_perceived_benefit_q14                    : param=+2.145589e+00, grad=-5.368185e+02
    [19] sigma_sq_perceived_benefit_q15                    : param=+2.339271e+00, grad=-5.490431e+02
    [20] sigma_sq_perceived_benefit_q16                    : param=+2.330270e+00, grad=-5.249851e+02
    [21] sigma_sq_perceived_benefit_q17                    : param=+1.905254e+00, grad=-5.400243e+02
    [22] zeta_perceived_price_q28                          : param=+2.855975e+00, grad=+2.625293e+02
    [23] zeta_perceived_price_q29                          : param=+2.830507e+00, grad=+2.497194e+02
    [24] sigma_sq_perceived_price_q27                      : param=+4.297890e+00, grad=-9.487004e+01
    [25] sigma_sq_perceived_price_q28                      : param=+3.547512e+00, grad=-2.281796e+02
    [26] sigma_sq_perceived_price_q29                      : param=+3.696596e+00, grad=-2.129877e+02
    [27] zeta_nutrition_knowledge_q31                      : param=+2.685624e+00, grad=+8.465569e+02
    [28] zeta_nutrition_knowledge_q32                      : param=+3.038699e+00, grad=+1.011146e+03
    [29] zeta_nutrition_knowledge_q33                      : param=+2.556703e+00, grad=+5.459819e+02
    [30] zeta_nutrition_knowledge_q34                      : param=+3.111360e+00, grad=+8.158046e+02
    [31] zeta_nutrition_knowledge_q35                      : param=+3.113229e+00, grad=+1.015501e+03
    [32] zeta_nutrition_knowledge_q36                      : param=+3.100313e+00, grad=+8.303252e+02
    [33] zeta_nutrition_knowledge_q37                      : param=+2.694394e+00, grad=+6.363138e+02
    [34] zeta_nutrition_knowledge_q38                      : param=+3.045692e+00, grad=+8.367308e+02
    [35] zeta_nutrition_knowledge_q39                      : param=+3.080931e+00, grad=+1.011246e+03
    [36] zeta_nutrition_knowledge_q40                      : param=+2.537128e+00, grad=+5.517811e+02
    [37] zeta_nutrition_knowledge_q41                      : param=+3.081512e+00, grad=+8.378286e+02
    [38] zeta_nutrition_knowledge_q42                      : param=+3.226410e+00, grad=+1.011488e+03
    [39] zeta_nutrition_knowledge_q43                      : param=+3.224173e+00, grad=+9.771595e+02
    [40] zeta_nutrition_knowledge_q44                      : param=+3.089504e+00, grad=+1.022861e+03
    [41] zeta_nutrition_knowledge_q45                      : param=+3.185674e+00, grad=+1.158995e+03
    [42] zeta_nutrition_knowledge_q46                      : param=+2.876741e+00, grad=+9.139005e+02
    [43] zeta_nutrition_knowledge_q47                      : param=+2.048112e+00, grad=+4.300595e+02
    [44] zeta_nutrition_knowledge_q48                      : param=+2.797846e+00, grad=+9.641497e+02
    [45] zeta_nutrition_knowledge_q49                      : param=+2.637763e+00, grad=+7.629870e+02
    [46] sigma_sq_nutrition_knowledge_q30                  : param=+3.347495e+00, grad=-1.622644e+02
    [47] sigma_sq_nutrition_knowledge_q31                  : param=+1.033751e+00, grad=-2.593178e+03
    [48] sigma_sq_nutrition_knowledge_q32                  : param=+9.794970e-01, grad=-3.687560e+03
    [49] sigma_sq_nutrition_knowledge_q33                  : param=+1.526780e+00, grad=-1.098624e+03
    [50] sigma_sq_nutrition_knowledge_q34                  : param=+1.242678e+00, grad=-2.420812e+03
    [51] sigma_sq_nutrition_knowledge_q35                  : param=+9.992060e-01, grad=-3.720766e+03
    [52] sigma_sq_nutrition_knowledge_q36                  : param=+1.217285e+00, grad=-2.498365e+03
    [53] sigma_sq_nutrition_knowledge_q37                  : param=+1.380650e+00, grad=-1.477431e+03
    [54] sigma_sq_nutrition_knowledge_q38                  : param=+1.186172e+00, grad=-2.535227e+03
    [55] sigma_sq_nutrition_knowledge_q39                  : param=+9.930930e-01, grad=-3.687308e+03
    [56] sigma_sq_nutrition_knowledge_q40                  : param=+1.498840e+00, grad=-1.116969e+03
    [57] sigma_sq_nutrition_knowledge_q41                  : param=+1.199043e+00, grad=-2.545376e+03
    [58] sigma_sq_nutrition_knowledge_q42                  : param=+1.039658e+00, grad=-3.686998e+03
    [59] sigma_sq_nutrition_knowledge_q43                  : param=+1.075677e+00, grad=-3.453754e+03
    [60] sigma_sq_nutrition_knowledge_q44                  : param=+9.843630e-01, grad=-3.775663e+03
    [61] sigma_sq_nutrition_knowledge_q45                  : param=+8.961200e-01, grad=-4.829759e+03
    [62] sigma_sq_nutrition_knowledge_q46                  : param=+1.026117e+00, grad=-3.016955e+03
    [63] sigma_sq_nutrition_knowledge_q47                  : param=+1.552020e+00, grad=-6.878394e+02
    [64] sigma_sq_nutrition_knowledge_q48                  : param=+9.456910e-01, grad=-3.347757e+03
    [65] sigma_sq_nutrition_knowledge_q49                  : param=+1.126017e+00, grad=-2.111811e+03
    [66] zeta_purchase_intention_q19                       : param=+1.623188e+00, grad=+1.428574e+00
    [67] zeta_purchase_intention_q20                       : param=+1.661940e+00, grad=+1.430566e+00
    [68] sigma_sq_purchase_intention_q18                   : param=+4.587242e+00, grad=-6.772963e+01
    [69] sigma_sq_purchase_intention_q19                   : param=+4.405831e+00, grad=-6.712440e+01
    [70] sigma_sq_purchase_intention_q20                   : param=+4.517172e+00, grad=-6.905732e+01
    [71] gamma_health_concern_to_perceived_benefit         : param=+1.780750e+00, grad=-0.000000e+00
    [72] gamma_perceived_benefit_to_purchase_intention     : param=+6.114100e-02, grad=-0.000000e+00
    [73] beta_intercept                                    : param=-1.417551e+00, grad=+3.475312e+02
    [74] beta_sugar_free                                   : param=+1.312690e+00, grad=+4.384657e+01
    [75] beta_health_label                                 : param=+1.190000e+00, grad=+2.329600e+01
    [76] beta_price                                        : param=+4.965000e-03, grad=+2.824034e+02
    [77] lambda_main                                       : param=-3.730210e+00, grad=-1.104959e+02
    [78] lambda_mod_perceived_price                        : param=-8.554751e+00, grad=+2.548355e+02
    [79] lambda_mod_nutrition_knowledge                    : param=+8.573049e+00, grad=-2.539560e+02
  Hessian 근사: BHHH (OPG) 방법으로 계산 완료
================================================================================
2025-11-14 21:13:22 - [Line Search 함수 호출 #iter1-2] [단계 1/2] 전체 우도 계산
2025-11-14 21:13:22 - 
================================================================================
2025-11-14 21:13:22 - Iteration 3 - 파라미터 값
2025-11-14 21:13:22 - ================================================================================
2025-11-14 21:13:22 - 
[측정모델 파라미터]
2025-11-14 21:13:22 -   health_concern:
2025-11-14 21:13:22 -     - zeta: [1.         3.05646969 3.01064423 3.17308005 3.21648077 2.97377426]
2025-11-14 21:13:22 -     - sigma_sq: [3.86488872 2.18835617 2.24746323 2.22956178 2.3657673  2.2085522 ]
2025-11-14 21:13:22 -   perceived_benefit:
2025-11-14 21:13:22 -     - zeta: [1.         1.03628811 1.37064899 1.51497686 1.47965335 1.23244593]
2025-11-14 21:13:22 -     - sigma_sq: [2.92334161 1.80561198 2.14649283 2.34019542 2.33115391 1.90616323]
2025-11-14 21:13:22 -   perceived_price:
2025-11-14 21:13:22 -     - zeta: [1.         2.85553298 2.83008655]
2025-11-14 21:13:22 -     - sigma_sq: [4.29804973 3.54789618 3.6969546 ]
2025-11-14 21:13:22 -   nutrition_knowledge:
2025-11-14 21:13:22 -     - zeta: [1.         2.68419866 3.03699655 2.55578374 3.10998644 3.11151921
 3.09891499 2.69332265 3.04428321 3.07922838 2.53619897 3.08010136
 3.22470697 3.22252777 3.08778182 3.18372261 2.87520228 2.04738791
 2.79622267 2.63647837]
2025-11-14 21:13:22 -     - sigma_sq: [3.3477682  1.0381171  0.9857057  1.52862974 1.24675389 1.00547061
 1.22149147 1.38313753 1.19044053 0.99930128 1.50072063 1.20332862
 1.04586576 1.08149205 0.99072004 0.90425181 1.03119661 1.55317811
 0.95132758 1.12957263]
2025-11-14 21:13:22 -   purchase_intention:
2025-11-14 21:13:22 -     - zeta: [1.         1.62318559 1.66193759]
2025-11-14 21:13:22 -     - sigma_sq: [4.58735604 4.40594402 4.51728827]
2025-11-14 21:13:22 - 
[구조모델 파라미터]
2025-11-14 21:13:22 -   gamma_health_concern_to_perceived_benefit: 1.780750
2025-11-14 21:13:22 -   gamma_perceived_benefit_to_purchase_intention: 0.061141
2025-11-14 21:13:22 - 
[선택모델 파라미터]
2025-11-14 21:13:22 -   intercept: -1.418136
2025-11-14 21:13:22 -   beta: [1.31261618 1.18996078 0.00448952]
2025-11-14 21:13:22 -   lambda_main: -3.730024
2025-11-14 21:13:22 -   lambda_mod_perceived_price: -8.555180
2025-11-14 21:13:22 -   lambda_mod_nutrition_knowledge: 8.573477
2025-11-14 21:13:22 - ================================================================================
2025-11-14 21:14:41 -   LL =  -28847.3970 (Best:  -28846.7150) 
2025-11-14 21:14:41 -   파라미터 변화량 (L2 norm): 2.307625e-02
  함수값 변화: -0.6819 (증가)
2025-11-14 21:14:41 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:14:41 - [Line Search 함수 호출 #iter1-3] [단계 1/2] 전체 우도 계산
2025-11-14 21:16:00 -   LL =  -28846.8554 (Best:  -28846.7150) 
2025-11-14 21:16:00 -   파라미터 변화량 (L2 norm): 4.883799e-03
  함수값 변화: -0.1403 (증가)
2025-11-14 21:16:00 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:16:00 - [Line Search 함수 호출 #iter1-4] [단계 1/2] 전체 우도 계산
2025-11-14 21:17:19 -   LL =  -28846.7445 (Best:  -28846.7150) 
2025-11-14 21:17:19 -   파라미터 변화량 (L2 norm): 1.030090e-03
  함수값 변화: -0.0294 (증가)
2025-11-14 21:17:19 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:17:19 - [Line Search 함수 호출 #iter1-5] [단계 1/2] 전체 우도 계산
2025-11-14 21:18:38 -   LL =  -28846.7212 (Best:  -28846.7150) 
2025-11-14 21:18:38 -   파라미터 변화량 (L2 norm): 2.171091e-04
  함수값 변화: -0.0062 (증가)
2025-11-14 21:18:38 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:18:38 - [Line Search 함수 호출 #iter1-6] [단계 1/2] 전체 우도 계산
2025-11-14 21:19:58 -   LL =  -28846.7164 (Best:  -28846.7150) 
2025-11-14 21:19:58 -   파라미터 변화량 (L2 norm): 4.575244e-05
  함수값 변화: -0.0013 (증가)
2025-11-14 21:19:58 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:19:58 - [Line Search 함수 호출 #iter1-7] [단계 1/2] 전체 우도 계산
2025-11-14 21:21:18 -   LL =  -28846.7153 (Best:  -28846.7150) 
2025-11-14 21:21:18 -   파라미터 변화량 (L2 norm): 9.641320e-06
  함수값 변화: -0.0003 (증가)
2025-11-14 21:21:18 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:21:18 - [Line Search 함수 호출 #iter1-8] [단계 1/2] 전체 우도 계산
2025-11-14 21:22:37 -   LL =  -28846.7151 (Best:  -28846.7150) 
2025-11-14 21:22:37 -   파라미터 변화량 (L2 norm): 2.031682e-06
  함수값 변화: -0.0001 (증가)
2025-11-14 21:22:37 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:22:37 - [Line Search 함수 호출 #iter1-9] [단계 1/2] 전체 우도 계산
2025-11-14 21:22:37 - 
================================================================================
2025-11-14 21:22:37 - Iteration 10 - 파라미터 값
2025-11-14 21:22:37 - ================================================================================
2025-11-14 21:22:37 - 
[측정모델 파라미터]
2025-11-14 21:22:37 -   health_concern:
2025-11-14 21:22:37 -     - zeta: [1.         3.05723699 3.01137999 3.17386199 3.21722799 2.97451399]
2025-11-14 21:22:37 -     - sigma_sq: [3.864668   2.18714002 2.24633702 2.22829702 2.36460102 2.20741702]
2025-11-14 21:22:37 -   perceived_benefit:
2025-11-14 21:22:37 -     - zeta: [1.         1.03728798 1.37176198 1.51610498 1.48075898 1.23357198]
2025-11-14 21:22:37 -     - sigma_sq: [2.92292001 1.80488401 2.14558902 2.33927102 2.33027002 1.90525402]
2025-11-14 21:22:37 -   perceived_price:
2025-11-14 21:22:37 -     - zeta: [1.         2.85597499 2.83050699]
2025-11-14 21:22:37 -     - sigma_sq: [4.29789    3.54751201 3.69659601]
2025-11-14 21:22:37 -   nutrition_knowledge:
2025-11-14 21:22:37 -     - zeta: [1.         2.68562397 3.03869897 2.55670298 3.11135997 3.11322897
 3.10031297 2.69439398 3.04569197 3.08093097 2.53712798 3.08151197
 3.22640997 3.22417297 3.08950397 3.18567396 2.87674097 2.04811199
 2.79784597 2.63776298]
2025-11-14 21:22:37 -     - sigma_sq: [3.34749501 1.03375108 0.97949712 1.52678003 1.24267808 0.99920612
 1.21728508 1.38065005 1.18617208 0.99309312 1.49884003 1.19904308
 1.03965812 1.07567711 0.98436312 0.89612015 1.02611709 1.55202002
 0.9456911  1.12601707]
2025-11-14 21:22:37 -   purchase_intention:
2025-11-14 21:22:37 -     - zeta: [1.       1.623188 1.66194 ]
2025-11-14 21:22:37 -     - sigma_sq: [4.587242 4.405831 4.517172]
2025-11-14 21:22:37 - 
[구조모델 파라미터]
2025-11-14 21:22:37 -   gamma_health_concern_to_perceived_benefit: 1.780750
2025-11-14 21:22:37 -   gamma_perceived_benefit_to_purchase_intention: 0.061141
2025-11-14 21:22:37 - 
[선택모델 파라미터]
2025-11-14 21:22:37 -   intercept: -1.417551
2025-11-14 21:22:37 -   beta: [1.31269    1.19       0.00496499]
2025-11-14 21:22:37 -   lambda_main: -3.730210
2025-11-14 21:22:37 -   lambda_mod_perceived_price: -8.554751
2025-11-14 21:22:37 -   lambda_mod_nutrition_knowledge: 8.573049
2025-11-14 21:22:37 - ================================================================================
2025-11-14 21:23:56 -   LL =  -28846.7151 (Best:  -28846.7150) 
2025-11-14 21:23:56 -   파라미터 변화량 (L2 norm): 4.281288e-07
  함수값 변화: -0.0000 (증가)
2025-11-14 21:23:56 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:23:57 - [Line Search 함수 호출 #iter1-10] [단계 1/2] 전체 우도 계산
2025-11-14 21:25:16 -   LL =  -28846.7150 (Best:  -28846.7150) 
2025-11-14 21:25:16 -   파라미터 변화량 (L2 norm): 9.021794e-08
  함수값 변화: -0.0000 (증가)
2025-11-14 21:25:16 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7150
  변화량: 0.0000
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:25:16 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:25:16 - [Line Search 함수 호출 #iter1-11] [단계 1/2] 전체 우도 계산
2025-11-14 21:26:35 -   LL =  -28846.7150 (Best:  -28846.7150) 
2025-11-14 21:26:35 -   파라미터 변화량 (L2 norm): 1.901128e-08
  함수값 변화: -0.0000 (증가)
2025-11-14 21:26:35 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7150
  변화량: 0.0000
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:26:35 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:26:36 - [Line Search 함수 호출 #iter1-12] [단계 1/2] 전체 우도 계산
2025-11-14 21:27:55 -   LL =  -28846.7150 (Best:  -28846.7150) 
2025-11-14 21:27:55 -   파라미터 변화량 (L2 norm): 4.006174e-09
  함수값 변화: -0.0000 (증가)
2025-11-14 21:27:55 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7150
  변화량: 0.0000
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:27:55 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:27:55 - [Line Search 함수 호출 #iter1-13] [단계 1/2] 전체 우도 계산
2025-11-14 21:29:14 -   LL =  -28846.7150 (Best:  -28846.7150) 
2025-11-14 21:29:14 -   파라미터 변화량 (L2 norm): 8.442058e-10
  함수값 변화: -0.0000 (증가)
2025-11-14 21:29:14 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7150
  변화량: 0.0000
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:29:14 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:29:14 - [Line Search 함수 호출 #iter1-14] [단계 1/2] 전체 우도 계산
2025-11-14 21:30:33 -   LL =  -28846.7150 (Best:  -28846.7150) 
2025-11-14 21:30:33 -   파라미터 변화량 (L2 norm): 2.307625e-10
  함수값 변화: -0.0000 (증가)
2025-11-14 21:30:33 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7150
  변화량: 0.0000
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:30:33 - [단계 2/2] Analytic Gradient 계산 #init
2025-11-14 21:30:34 - [Line Search 함수 호출 #iter1-15] [단계 1/2] 전체 우도 계산
2025-11-14 21:31:53 -   LL =  -28847.3970 (Best:  -28846.7150) 
2025-11-14 21:31:53 -   파라미터 변화량 (L2 norm): 2.307625e-02
  함수값 변화: -0.6819 (증가)
2025-11-14 21:31:53 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28847.3970
  변화량: 0.6819
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:31:53 - [Line Search 함수 호출 #iter1-16] [단계 1/2] 전체 우도 계산
2025-11-14 21:33:12 -   LL =  -28847.0493 (Best:  -28846.7150) 
2025-11-14 21:33:12 -   파라미터 변화량 (L2 norm): 1.151330e-02
  함수값 변화: -0.3343 (증가)
2025-11-14 21:33:12 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28847.0493
  변화량: 0.3343
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:33:12 - [Line Search 함수 호출 #iter1-17] [단계 1/2] 전체 우도 계산
2025-11-14 21:34:31 -   LL =  -28846.8545 (Best:  -28846.7150) 
2025-11-14 21:34:31 -   파라미터 변화량 (L2 norm): 4.854309e-03
  함수값 변화: -0.1395 (증가)
2025-11-14 21:34:31 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.8545
  변화량: 0.1395
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:34:31 - [Line Search 함수 호출 #iter1-18] [단계 1/2] 전체 우도 계산
2025-11-14 21:35:47 -   LL =  -28846.7755 (Best:  -28846.7150) 
2025-11-14 21:35:47 -   파라미터 변화량 (L2 norm): 2.112855e-03
  함수값 변화: -0.0604 (증가)
2025-11-14 21:35:47 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7755
  변화량: 0.0604
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:35:47 - [Line Search 함수 호출 #iter1-19] [단계 1/2] 전체 우도 계산
2025-11-14 21:35:47 - 
================================================================================
2025-11-14 21:35:47 - Iteration 20 - 파라미터 값
2025-11-14 21:35:47 - ================================================================================
2025-11-14 21:35:47 - 
[측정모델 파라미터]
2025-11-14 21:35:47 -   health_concern:
2025-11-14 21:35:47 -     - zeta: [1.         3.05720659 3.01135084 3.17383101 3.21719838 2.97448468]
2025-11-14 21:35:47 -     - sigma_sq: [3.86467675 2.1871882  2.24638164 2.22834713 2.36464723 2.20746199]
2025-11-14 21:35:47 -   perceived_benefit:
2025-11-14 21:35:47 -     - zeta: [1.         1.03724837 1.37171789 1.51606029 1.48071518 1.23352737]
2025-11-14 21:35:47 -     - sigma_sq: [2.92293671 1.80491285 2.14562482 2.33930764 2.33030503 1.90529004]
2025-11-14 21:35:47 -   perceived_price:
2025-11-14 21:35:47 -     - zeta: [1.         2.85595748 2.83049034]
2025-11-14 21:35:47 -     - sigma_sq: [4.29789633 3.54752723 3.69661021]
2025-11-14 21:35:47 -   nutrition_knowledge:
2025-11-14 21:35:47 -     - zeta: [1.         2.68556751 3.03863152 2.55666656 3.11130556 3.11316123
 3.10025759 2.69435154 3.04563616 3.08086352 2.53709118 3.08145609
 3.2263425  3.22410779 3.08943574 3.18559666 2.87668001 2.0480833
 2.79778166 2.63771208]
2025-11-14 21:35:47 -     - sigma_sq: [3.34750583 1.03392405 0.97974308 1.52685331 1.24283955 0.9994543
 1.21745172 1.38074859 1.18634118 0.99333907 1.49891454 1.19921286
 1.03990404 1.07590748 0.98461496 0.8964423  1.02631833 1.5520659
 0.94591441 1.12615793]
2025-11-14 21:35:47 -   purchase_intention:
2025-11-14 21:35:47 -     - zeta: [1.        1.6231879 1.6619399]
2025-11-14 21:35:47 -     - sigma_sq: [4.58724652 4.40583548 4.51717661]
2025-11-14 21:35:47 - 
[구조모델 파라미터]
2025-11-14 21:35:47 -   gamma_health_concern_to_perceived_benefit: 1.780750
2025-11-14 21:35:47 -   gamma_perceived_benefit_to_purchase_intention: 0.061141
2025-11-14 21:35:47 - 
[선택모델 파라미터]
2025-11-14 21:35:47 -   intercept: -1.417574
2025-11-14 21:35:47 -   beta: [1.31268707 1.18999845 0.00494615]
2025-11-14 21:35:47 -   lambda_main: -3.730203
2025-11-14 21:35:47 -   lambda_mod_perceived_price: -8.554768
2025-11-14 21:35:47 -   lambda_mod_nutrition_knowledge: 8.573066
2025-11-14 21:35:47 - ================================================================================
2025-11-14 21:37:02 -   LL =  -28846.7412 (Best:  -28846.7150) 
2025-11-14 21:37:02 -   파라미터 변화량 (L2 norm): 9.146283e-04
  함수값 변화: -0.0261 (증가)
2025-11-14 21:37:02 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7412
  변화량: 0.0261
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:37:02 - [Line Search 함수 호출 #iter1-20] [단계 1/2] 전체 우도 계산
2025-11-14 21:38:19 -   LL =  -28846.7264 (Best:  -28846.7150) 
2025-11-14 21:38:19 -   파라미터 변화량 (L2 norm): 3.963103e-04
  함수값 변화: -0.0113 (증가)
2025-11-14 21:38:19 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7264
  변화량: 0.0113
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:38:19 - [Line Search 함수 호출 #iter1-21] [단계 1/2] 전체 우도 계산
2025-11-14 21:39:34 -   LL =  -28846.7199 (Best:  -28846.7150) 
2025-11-14 21:39:34 -   파라미터 변화량 (L2 norm): 1.716937e-04
  함수값 변화: -0.0049 (증가)
2025-11-14 21:39:34 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7199
  변화량: 0.0049
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:39:34 - [Line Search 함수 호출 #iter1-22] [단계 1/2] 전체 우도 계산
2025-11-14 21:40:49 -   LL =  -28846.7172 (Best:  -28846.7150) 
2025-11-14 21:40:49 -   파라미터 변화량 (L2 norm): 7.438517e-05
  함수값 변화: -0.0021 (증가)
2025-11-14 21:40:49 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7172
  변화량: 0.0021
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:40:49 - [Line Search 함수 호출 #iter1-23] [단계 1/2] 전체 우도 계산
2025-11-14 21:42:03 -   LL =  -28846.7160 (Best:  -28846.7150) 
2025-11-14 21:42:03 -   파라미터 변화량 (L2 norm): 3.222673e-05
  함수값 변화: -0.0009 (증가)
2025-11-14 21:42:03 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7160
  변화량: 0.0009
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:42:03 - [Line Search 함수 호출 #iter1-24] [단계 1/2] 전체 우도 계산
2025-11-14 21:43:17 -   LL =  -28846.7154 (Best:  -28846.7150) 
2025-11-14 21:43:17 -   파라미터 변화량 (L2 norm): 1.396196e-05
  함수값 변화: -0.0004 (증가)
2025-11-14 21:43:17 - 
⚠️  [Line Search 경고] maxls=10에 도달했습니다.
  시작 함수값: 28846.7150
  현재 함수값: 28846.7154
  변화량: 0.0004
  Line search가 Wolfe 조건을 만족하는 step size를 찾지 못했을 수 있습니다.
2025-11-14 21:43:17 - [Line Search 함수 호출 #iter1-25] [단계 1/2] 전체 우도 계산
