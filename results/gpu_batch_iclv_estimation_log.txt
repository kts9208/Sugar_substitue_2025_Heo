2025-11-12 08:44:04 - ======================================================================
2025-11-12 08:44:04 - ICLV 모델 추정 시작
2025-11-12 08:44:04 - ======================================================================
2025-11-12 08:44:04 - SimultaneousEstimator.estimate() 시작
2025-11-12 08:44:04 - 데이터 shape: (5904, 60)
2025-11-12 08:44:04 - 개인 수: 326
2025-11-12 08:44:04 - Halton draws 이미 설정됨 (건너뛰기)
2025-11-12 08:44:04 - Analytic gradient calculators 초기화 (Apollo 방식)...
2025-11-12 08:44:04 - 다중 잠재변수 측정모델 gradient 초기화: 5개 LV
2025-11-12 08:44:04 - 다중 잠재변수 구조모델 gradient 초기화
2025-11-12 08:44:04 - GPU 배치 그래디언트 활성화
2025-11-12 08:44:04 - 다중 잠재변수 JointGradient 초기화 완료
2025-11-12 08:44:04 - 초기 파라미터 설정 시작...
2025-11-12 08:44:04 - 초기 파라미터 설정 완료 (총 80개)
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - 파라미터 스케일링 비활성화
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - Custom Parameter Scaling Initialized (Gradient-Balanced)
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - Total parameters: 80
2025-11-12 08:44:04 - 
2025-11-12 08:44:04 - Scale factors:
2025-11-12 08:44:04 -   ζ_health_concern_q7           :     1.000000
2025-11-12 08:44:04 -   ζ_health_concern_q8           :     1.000000
2025-11-12 08:44:04 -   ζ_health_concern_q9           :     1.000000
2025-11-12 08:44:04 -   ζ_health_concern_q10          :     1.000000
2025-11-12 08:44:04 -   ζ_health_concern_q11          :     1.000000
2025-11-12 08:44:04 -   σ²_health_concern_q6          :     1.000000
2025-11-12 08:44:04 -   σ²_health_concern_q7          :     1.000000
2025-11-12 08:44:04 -   σ²_health_concern_q8          :     1.000000
2025-11-12 08:44:04 -   σ²_health_concern_q9          :     1.000000
2025-11-12 08:44:04 -   σ²_health_concern_q10         :     1.000000
2025-11-12 08:44:04 -   σ²_health_concern_q11         :     1.000000
2025-11-12 08:44:04 -   ζ_perceived_benefit_q13       :     1.000000
2025-11-12 08:44:04 -   ζ_perceived_benefit_q14       :     1.000000
2025-11-12 08:44:04 -   ζ_perceived_benefit_q15       :     1.000000
2025-11-12 08:44:04 -   ζ_perceived_benefit_q16       :     1.000000
2025-11-12 08:44:04 -   ζ_perceived_benefit_q17       :     1.000000
2025-11-12 08:44:04 -   σ²_perceived_benefit_q12      :     1.000000
2025-11-12 08:44:04 -   σ²_perceived_benefit_q13      :     1.000000
2025-11-12 08:44:04 -   σ²_perceived_benefit_q14      :     1.000000
2025-11-12 08:44:04 -   σ²_perceived_benefit_q15      :     1.000000
2025-11-12 08:44:04 -   σ²_perceived_benefit_q16      :     1.000000
2025-11-12 08:44:04 -   σ²_perceived_benefit_q17      :     1.000000
2025-11-12 08:44:04 -   ζ_perceived_price_q28         :     1.000000
2025-11-12 08:44:04 -   ζ_perceived_price_q29         :     1.000000
2025-11-12 08:44:04 -   σ²_perceived_price_q27        :     1.000000
2025-11-12 08:44:04 -   σ²_perceived_price_q28        :     1.000000
2025-11-12 08:44:04 -   σ²_perceived_price_q29        :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q31     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q32     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q33     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q34     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q35     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q36     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q37     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q38     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q39     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q40     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q41     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q42     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q43     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q44     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q45     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q46     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q47     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q48     :     1.000000
2025-11-12 08:44:04 -   ζ_nutrition_knowledge_q49     :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q30    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q31    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q32    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q33    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q34    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q35    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q36    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q37    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q38    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q39    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q40    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q41    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q42    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q43    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q44    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q45    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q46    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q47    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q48    :     1.000000
2025-11-12 08:44:04 -   σ²_nutrition_knowledge_q49    :     1.000000
2025-11-12 08:44:04 -   ζ_purchase_intention_q19      :     1.000000
2025-11-12 08:44:04 -   ζ_purchase_intention_q20      :     1.000000
2025-11-12 08:44:04 -   σ²_purchase_intention_q18     :     1.000000
2025-11-12 08:44:04 -   σ²_purchase_intention_q19     :     1.000000
2025-11-12 08:44:04 -   σ²_purchase_intention_q20     :     1.000000
2025-11-12 08:44:04 -   γ_health_concern_to_perceived_benefit:     1.000000
2025-11-12 08:44:04 -   γ_perceived_benefit_to_purchase_intention:     1.000000
2025-11-12 08:44:04 -   β_intercept                   :     1.000000
2025-11-12 08:44:04 -   β_sugar_free                  :     1.000000
2025-11-12 08:44:04 -   β_health_label                :     1.000000
2025-11-12 08:44:04 -   β_price                       :     1.000000
2025-11-12 08:44:04 -   λ_main                        :     1.000000
2025-11-12 08:44:04 -   λ_mod_perceived_price         :     1.000000
2025-11-12 08:44:04 -   λ_mod_nutrition_knowledge     :     1.000000
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - 파라미터 bounds 계산 시작...
2025-11-12 08:44:04 - 파라미터 bounds 계산 완료 (총 80개)
2025-11-12 08:44:04 - 최대 반복 횟수: 1000
2025-11-12 08:44:04 - ======================================================================
2025-11-12 08:44:04 - 순차처리 사용
2025-11-12 08:44:04 - 최적화 시작: BFGS (gradient-based)
2025-11-12 08:44:04 - Analytic gradient 사용 (Apollo 방식)
2025-11-12 08:44:04 - 조기 종료 비활성화 (정상 종료만 사용)
2025-11-12 08:44:04 - BFGS 옵션: c1=0.0001, c2=0.9 (scipy 기본값)
2025-11-12 08:44:04 - [Major Iteration #1 시작] [단계 1/2] 전체 우도 계산
2025-11-12 08:44:04 -   측정모델 health_concern: zeta[0]=1.0000, sigma_sq[0]=0.0340
2025-11-12 08:44:04 -   구조모델 (계층적): gamma_health_concern_to_perceived_benefit=0.500000
2025-11-12 08:44:04 -   선택모델 (조절): intercept=0.290000, lambda_main=0.890000, lambda_mod_perceived_price=-0.470000
2025-11-12 08:44:04 - 
================================================================================
2025-11-12 08:44:04 - Iteration 1 - 파라미터 값
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - 
[측정모델 파라미터]
2025-11-12 08:44:04 -   health_concern:
2025-11-12 08:44:04 -     - zeta (처음 3개): [1.    0.024 0.024]
2025-11-12 08:44:04 -     - sigma_sq (처음 3개): [0.034 0.034 0.034]
2025-11-12 08:44:04 -   perceived_benefit:
2025-11-12 08:44:04 -     - zeta (처음 3개): [1.   0.05 0.05]
2025-11-12 08:44:04 -     - sigma_sq (처음 3개): [0.036 0.036 0.036]
2025-11-12 08:44:04 -   perceived_price:
2025-11-12 08:44:04 -     - zeta (처음 3개): [1.   0.12 0.12]
2025-11-12 08:44:04 -     - sigma_sq (처음 3개): [0.023 0.023 0.023]
2025-11-12 08:44:04 -   nutrition_knowledge:
2025-11-12 08:44:04 -     - zeta (처음 3개): [1.    0.022 0.022]
2025-11-12 08:44:04 -     - sigma_sq (처음 3개): [0.046 0.046 0.046]
2025-11-12 08:44:04 -   purchase_intention:
2025-11-12 08:44:04 -     - zeta (처음 3개): [1.    0.083 0.083]
2025-11-12 08:44:04 -     - sigma_sq (처음 3개): [0.026 0.026 0.026]
2025-11-12 08:44:04 - 
[구조모델 파라미터]
2025-11-12 08:44:04 -   gamma_health_concern_to_perceived_benefit: 0.500000
2025-11-12 08:44:04 -   gamma_perceived_benefit_to_purchase_intention: 0.500000
2025-11-12 08:44:04 - 
[선택모델 파라미터]
2025-11-12 08:44:04 -   intercept: 0.290000
2025-11-12 08:44:04 -   beta: [ 0.23   0.22  -0.056]
2025-11-12 08:44:04 -   lambda_main: 0.890000
2025-11-12 08:44:04 -   lambda_mod_perceived_price: -0.470000
2025-11-12 08:44:04 -   lambda_mod_nutrition_knowledge: 1.200000
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - [구조모델 예측 - 계층적] Draw 0:
2025-11-12 08:44:04 -   1차 LV draws: [ 1.05625053  0.5888206  -0.52082087  2.06351762]
2025-11-12 08:44:04 -   2차+ LV 오차항: {'perceived_benefit': np.float64(0.8878494192714436), 'purchase_intention': np.float64(0.9159186974350734)}
2025-11-12 08:44:04 -   예측된 LV: {'health_concern': np.float64(1.0562505302438723), 'perceived_benefit': np.float64(1.4159746843933796), 'perceived_price': np.float64(-0.5208208692842057), 'nutrition_knowledge': np.float64(2.0635176204505683), 'purchase_intention': np.float64(1.623906039631763)}
2025-11-12 08:44:04 - 
[측정모델 우도 계산 시작]
2025-11-12 08:44:04 -   개인 데이터 shape: (18, 60)
2025-11-12 08:44:04 -   LV 개수: 100
2025-11-12 08:44:04 -   측정모델 우도 (처음 5개): [-6941.41715902 -8194.08052614 -7578.66220622 -7371.20549832
 -7317.12869943]
2025-11-12 08:44:04 -   측정모델 우도 범위: [-8563.54, -6556.50]
2025-11-12 08:44:04 -   측정모델 우도 평균: -7614.80
2025-11-12 08:44:04 - 
[선택모델 우도 계산 시작]
2025-11-12 08:44:04 -   선택 상황 수: 18
2025-11-12 08:44:04 -   선택모델 우도 (처음 5개): [-130.9978409   -35.99867359   -8.54222424   -8.7871651    -8.00657238]
2025-11-12 08:44:04 -   선택모델 우도 범위: [-131.00, -7.89]
2025-11-12 08:44:04 -   선택모델 우도 평균: -18.46
2025-11-12 08:44:04 - 
[구조모델 우도 계산 시작]
2025-11-12 08:44:04 -   경로 health_concern->perceived_benefit: 예측=0.5281, 실제=1.4160, LL=-1.3131
2025-11-12 08:44:04 -   경로 perceived_benefit->purchase_intention: 예측=0.7080, 실제=1.6239, LL=-1.3384
2025-11-12 08:44:04 -   구조모델 우도 (처음 5개): [-2.65146889 -2.67683331 -1.99624413 -1.9192333  -2.43677822]
2025-11-12 08:44:04 -   구조모델 우도 범위: [-7.37, -1.84]
2025-11-12 08:44:04 -   구조모델 우도 평균: -2.84
2025-11-12 08:44:04 - 
[결합 우도 계산] Draw 0:
2025-11-12 08:44:04 -   측정모델: -6941.4172
2025-11-12 08:44:04 -   선택모델: -130.9978
2025-11-12 08:44:04 -   구조모델: -2.6515
2025-11-12 08:44:04 -   합계: -7075.0665
2025-11-12 08:44:04 - 
[전체 draws 통계]
2025-11-12 08:44:04 -   Draw 우도 범위: [-8630.71, -6636.19]
2025-11-12 08:44:04 -   Draw 우도 평균: -7636.10
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - 두 번째 함수 호출 - 파라미터 변화 확인
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:44:04 - [파라미터 확인]
2025-11-12 08:44:04 -   측정모델 zeta (health_concern 처음 3개): [1.    0.024 0.024]
2025-11-12 08:44:04 -   구조모델 (계층적) gamma_health_concern_to_perceived_benefit: 0.5
2025-11-12 08:44:04 -   선택모델 intercept: 0.29
2025-11-12 08:44:04 -   선택모델 beta: [ 0.23   0.22  -0.056]
2025-11-12 08:44:04 -   선택모델 lambda_main: 0.89
2025-11-12 08:44:04 -   선택모델 lambda_mod_perceived_price: -0.47
2025-11-12 08:44:04 -   선택모델 lambda_mod_nutrition_knowledge: 1.2
2025-11-12 08:44:04 - ================================================================================
2025-11-12 08:45:26 -   LL = -1901036.3858 (Best: -1901036.3858) [NEW BEST]
2025-11-12 08:45:26 - [단계 2/2] Analytic Gradient 계산 #1
2025-11-12 08:45:26 -   측정모델 health_concern: zeta[0]=1.0000, sigma_sq[0]=0.0340
2025-11-12 08:45:26 -   구조모델 (계층적): gamma_health_concern_to_perceived_benefit=0.500000
2025-11-12 08:45:26 -   선택모델 (조절): intercept=0.290000, lambda_main=0.890000, lambda_mod_perceived_price=-0.470000
2025-11-12 08:45:26 - 
[측정모델 그래디언트 계산]
2025-11-12 08:45:26 -   잠재변수: health_concern
2025-11-12 08:45:26 -     - 측정 방법: continuous_linear
2025-11-12 08:45:26 -     - 지표 수: 6
2025-11-12 08:45:26 -     - zeta (처음 3개): [1.    0.024 0.024]
2025-11-12 08:45:26 -     - LV 값 범위: [-2.7466, 2.5898]
2025-11-12 08:45:26 -     - LV 값 평균: -0.0141
2025-11-12 08:45:26 - 
    [지표 q6 계산 예시]
2025-11-12 08:45:26 -       - 관측값 y: 4.0000
2025-11-12 08:45:26 -       - zeta[0]: 1.000000
2025-11-12 08:45:26 -       - sigma_sq[0]: 0.034000
2025-11-12 08:45:26 -       - LV (draw 0): 1.0563
2025-11-12 08:45:26 -       - 예측값 (draw 0): 1.0563
2025-11-12 08:45:26 -       - 잔차 (draw 0): 2.9437
2025-11-12 08:45:26 - 
    [가중평균 적용 전후]
2025-11-12 08:45:26 -       - grad_zeta_batch (draw 0, 처음 3개): [1646.1195555891316, 2222.5903181958274, 1663.3988610078954]
2025-11-12 08:45:26 -       - weights (처음 5개): [7.736311654045452e-145, 0.0, 2.524637422674e-311, 9.568247167976612e-274, 3.261779575737245e-95]
2025-11-12 08:45:26 -       - grad_zeta_weighted (처음 3개): [561.5239293291113, 603.6668927688286, 452.4910939817052]
2025-11-12 08:45:26 -       - grad_sigma_sq_weighted (처음 3개): [107152.36927671026, 123876.28460564534, 69484.72703800861]
2025-11-12 08:45:26 - 
  [health_concern] 최종 그래디언트:
2025-11-12 08:45:26 -     - grad_zeta: 범위=[452.4911, 603.6669], norm=1287.7815
2025-11-12 08:45:26 -     - grad_sigma_sq: 범위=[69484.7270, 123876.2846], norm=238026.6369
2025-11-12 08:45:26 - 
  [perceived_benefit] 최종 그래디언트:
2025-11-12 08:45:26 -     - grad_zeta: 범위=[142.2674, 285.0445], norm=591.4907
2025-11-12 08:45:26 -     - grad_sigma_sq: 범위=[27329.8302, 110464.8619], norm=208450.8892
2025-11-12 08:45:26 - 
  [perceived_price] 최종 그래디언트:
2025-11-12 08:45:26 -     - grad_zeta: 범위=[3103.6786, 5372.6456], norm=8207.5248
2025-11-12 08:45:26 -     - grad_sigma_sq: 범위=[80826.3116, 242982.0789], norm=353006.3371
2025-11-12 08:45:26 - 
  [nutrition_knowledge] 최종 그래디언트:
2025-11-12 08:45:26 -     - grad_zeta: 범위=[951.9051, 4988.5561], norm=18064.0637
2025-11-12 08:45:26 -     - grad_sigma_sq: 범위=[3588.7049, 103737.5278], norm=340580.6658
2025-11-12 08:45:26 - 
  [purchase_intention] 최종 그래디언트:
2025-11-12 08:45:26 -     - grad_zeta: 범위=[144.7395, 197.3985], norm=286.0288
2025-11-12 08:45:26 -     - grad_sigma_sq: 범위=[113841.5608, 212040.9733], norm=268482.9670
2025-11-12 08:45:26 - 
[구조모델 그래디언트 계산]
2025-11-12 08:45:26 -   구조 유형: 계층적
2025-11-12 08:45:26 - 
  [경로 1] health_concern → perceived_benefit
2025-11-12 08:45:26 -     - gamma: 0.500000
2025-11-12 08:45:26 -     - predictor (draw 0): 1.0563
2025-11-12 08:45:26 -     - target (draw 0): 0.5281
2025-11-12 08:45:26 -     - 예측값 μ (draw 0): 0.5281
2025-11-12 08:45:26 -     - 잔차 (draw 0): 0.0000
2025-11-12 08:45:26 -     - 잔차 범위: [0.0000, 0.0000]
2025-11-12 08:45:26 -     - grad_gamma_health_concern_to_perceived_benefit: 0.000000
2025-11-12 08:45:26 -     - grad_gamma_perceived_benefit_to_purchase_intention: 0.000000
2025-11-12 08:45:26 - 
[선택모델 그래디언트 계산]
2025-11-12 08:45:26 -   선택 상황 수: 18
2025-11-12 08:45:26 -   조절효과 모델:
2025-11-12 08:45:26 -     - intercept: 0.290000
2025-11-12 08:45:26 -     - beta: [ 0.23   0.22  -0.056]
2025-11-12 08:45:26 -     - lambda_main: 0.890000
2025-11-12 08:45:26 -     - lambda_mod_perceived_price: -0.470000
2025-11-12 08:45:26 -     - lambda_mod_nutrition_knowledge: 1.200000
2025-11-12 08:45:26 - 
  [중간 계산 값 (draw 0, situation 0)]
2025-11-12 08:45:26 -     - V: 1.3235
2025-11-12 08:45:26 -     - Φ(V): 0.9072
2025-11-12 08:45:26 -     - φ(V): 0.1662
2025-11-12 08:45:26 -     - choice: 1
2025-11-12 08:45:26 -     - Mills ratio: 0.1832
2025-11-12 08:45:26 - 
  [최종 그래디언트]
2025-11-12 08:45:26 -     - grad_intercept: -11.353623
2025-11-12 08:45:26 -     - grad_beta: [ -0.89980499  -2.47416379 -13.55428525]
2025-11-12 08:45:26 -     - grad_lambda_main: -0.810514
2025-11-12 08:45:26 -     - grad_lambda_mod_perceived_price: -1.471158
2025-11-12 08:45:26 -     - grad_lambda_mod_nutrition_knowledge: -2.090220
2025-11-12 08:46:17 - 
[Gradient 방향 검증 - External (원본)]
  Gradient norm: 1.832348e+08
  Gradient max: 6.768814e+07
  Gradient (처음 5개): [-1117636.09320152 -1117109.77512315 -1163911.45767581 -1197638.19947403
 -1104333.05334388]
  Gradient (마지막 5개): [ 937.64940176 6176.22304972 2247.23293011 2653.2277342  2842.36041707]

2025-11-12 08:46:17 - 
[Gradient 방향 검증 - Internal (스케일됨)]
  Gradient norm: 1.832348e+08
  Gradient max: 6.768814e+07
  Gradient (처음 5개): [-1117636.09320152 -1117109.77512315 -1163911.45767581 -1197638.19947403
 -1104333.05334388]
  Gradient (마지막 5개): [ 937.64940176 6176.22304972 2247.23293011 2653.2277342  2842.36041707]
  주의: scipy는 이 gradient를 사용하여 descent direction을 계산합니다.
       d = -H^(-1) · gradient이므로, gradient가 양수면 d는 음수 방향입니다.
2025-11-12 08:46:17 - 
2025-11-12 08:46:17 - Gradient Scaling Comparison:
2025-11-12 08:46:17 - --------------------------------------------------------------------------------
2025-11-12 08:46:17 - Parameter                       Grad(External)  Grad(Internal)        Scale
2025-11-12 08:46:17 - --------------------------------------------------------------------------------
2025-11-12 08:46:17 - ζ_health_concern_q7              -1.117636e+06   -1.117636e+06     1.000000
2025-11-12 08:46:17 - ζ_health_concern_q8              -1.117110e+06   -1.117110e+06     1.000000
2025-11-12 08:46:17 - ζ_health_concern_q9              -1.163911e+06   -1.163911e+06     1.000000
2025-11-12 08:46:17 - ζ_health_concern_q10             -1.197638e+06   -1.197638e+06     1.000000
2025-11-12 08:46:17 - ζ_health_concern_q11             -1.104333e+06   -1.104333e+06     1.000000
2025-11-12 08:46:17 - σ²_health_concern_q6             -1.256815e+07   -1.256815e+07     1.000000
2025-11-12 08:46:17 - σ²_health_concern_q7             -3.493991e+07   -3.493991e+07     1.000000
2025-11-12 08:46:17 - σ²_health_concern_q8             -3.455879e+07   -3.455879e+07     1.000000
2025-11-12 08:46:17 - σ²_health_concern_q9             -3.743752e+07   -3.743752e+07     1.000000
2025-11-12 08:46:17 - σ²_health_concern_q10            -3.921215e+07   -3.921215e+07     1.000000
2025-11-12 08:46:17 - σ²_health_concern_q11            -3.361798e+07   -3.361798e+07     1.000000
2025-11-12 08:46:17 - ζ_perceived_benefit_q13          -3.651652e+05   -3.651652e+05     1.000000
2025-11-12 08:46:17 - ζ_perceived_benefit_q14          -4.773740e+05   -4.773740e+05     1.000000
2025-11-12 08:46:17 - ζ_perceived_benefit_q15          -5.219714e+05   -5.219714e+05     1.000000
2025-11-12 08:46:17 - ζ_perceived_benefit_q16          -5.056618e+05   -5.056618e+05     1.000000
2025-11-12 08:46:17 - ζ_perceived_benefit_q17          -4.198234e+05   -4.198234e+05     1.000000
2025-11-12 08:46:17 - σ²_perceived_benefit_q12         -1.689276e+07   -1.689276e+07     1.000000
2025-11-12 08:46:17 - σ²_perceived_benefit_q13         -1.550988e+07   -1.550988e+07     1.000000
2025-11-12 08:46:17 - σ²_perceived_benefit_q14         -2.509014e+07   -2.509014e+07     1.000000
2025-11-12 08:46:17 - σ²_perceived_benefit_q15         -2.988237e+07   -2.988237e+07     1.000000
2025-11-12 08:46:17 - σ²_perceived_benefit_q16         -2.847447e+07   -2.847447e+07     1.000000
2025-11-12 08:46:17 - σ²_perceived_benefit_q17         -2.008674e+07   -2.008674e+07     1.000000
2025-11-12 08:46:17 - ζ_perceived_price_q28            -1.365726e+06   -1.365726e+06     1.000000
2025-11-12 08:46:17 - ζ_perceived_price_q29            -1.422448e+06   -1.422448e+06     1.000000
2025-11-12 08:46:17 - σ²_perceived_price_q27           -2.779831e+07   -2.779831e+07     1.000000
2025-11-12 08:46:17 - σ²_perceived_price_q28           -6.492170e+07   -6.492170e+07     1.000000
2025-11-12 08:46:17 - σ²_perceived_price_q29           -6.768814e+07   -6.768814e+07     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q31        -3.899947e+05   -3.899947e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q32        -4.306192e+05   -4.306192e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q33        -3.726325e+05   -3.726325e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q34        -4.339145e+05   -4.339145e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q35        -4.396742e+05   -4.396742e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q36        -4.305333e+05   -4.305333e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q37        -3.904792e+05   -3.904792e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q38        -4.267347e+05   -4.267347e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q39        -4.260655e+05   -4.260655e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q40        -3.665535e+05   -3.665535e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q41        -4.395329e+05   -4.395329e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q42        -4.446795e+05   -4.446795e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q43        -4.494831e+05   -4.494831e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q44        -4.343623e+05   -4.343623e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q45        -4.438393e+05   -4.438393e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q46        -4.013982e+05   -4.013982e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q47        -3.083693e+05   -3.083693e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q48        -3.893590e+05   -3.893590e+05     1.000000
2025-11-12 08:46:17 - ζ_nutrition_knowledge_q49        -3.603133e+05   -3.603133e+05     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q30       -1.153454e+07   -1.153454e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q31       -1.481766e+07   -1.481766e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q32       -1.849010e+07   -1.849010e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q33       -1.464733e+07   -1.464733e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q34       -1.994741e+07   -1.994741e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q35       -1.938322e+07   -1.938322e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q36       -1.968532e+07   -1.968532e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q37       -1.565533e+07   -1.565533e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q38       -1.897259e+07   -1.897259e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q39       -1.898992e+07   -1.898992e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q40       -1.433549e+07   -1.433549e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q41       -1.945559e+07   -1.945559e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q42       -2.074189e+07   -2.074189e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q43       -2.089696e+07   -2.089696e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q44       -1.909228e+07   -1.909228e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q45       -1.998945e+07   -1.998945e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q46       -1.679000e+07   -1.679000e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q47       -1.027589e+07   -1.027589e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q48       -1.575795e+07   -1.575795e+07     1.000000
2025-11-12 08:46:17 - σ²_nutrition_knowledge_q49       -1.457666e+07   -1.457666e+07     1.000000
2025-11-12 08:46:17 - ζ_purchase_intention_q19         -3.420022e+05   -3.420022e+05     1.000000
2025-11-12 08:46:17 - ζ_purchase_intention_q20         -3.568469e+05   -3.568469e+05     1.000000
2025-11-12 08:46:17 - σ²_purchase_intention_q18        -4.512309e+07   -4.512309e+07     1.000000
2025-11-12 08:46:17 - σ²_purchase_intention_q19        -5.289444e+07   -5.289444e+07     1.000000
2025-11-12 08:46:17 - σ²_purchase_intention_q20        -5.614883e+07   -5.614883e+07     1.000000
2025-11-12 08:46:17 - γ_health_concern_to_perceived_benefit   -0.000000e+00   -0.000000e+00     1.000000
2025-11-12 08:46:17 - γ_perceived_benefit_to_purchase_intention   -0.000000e+00   -0.000000e+00     1.000000
2025-11-12 08:46:17 - β_intercept                       4.882924e+03    4.882924e+03     1.000000
2025-11-12 08:46:17 - β_sugar_free                      8.994792e+02    8.994792e+02     1.000000
2025-11-12 08:46:17 - β_health_label                    9.376494e+02    9.376494e+02     1.000000
2025-11-12 08:46:17 - β_price                           6.176223e+03    6.176223e+03     1.000000
2025-11-12 08:46:17 - λ_main                            2.247233e+03    2.247233e+03     1.000000
2025-11-12 08:46:17 - λ_mod_perceived_price             2.653228e+03    2.653228e+03     1.000000
2025-11-12 08:46:17 - λ_mod_nutrition_knowledge         2.842360e+03    2.842360e+03     1.000000
2025-11-12 08:46:17 - --------------------------------------------------------------------------------
2025-11-12 08:46:17 - External gradient norm: 1.832348e+08
2025-11-12 08:46:17 - Internal gradient norm: 1.832348e+08
2025-11-12 08:46:17 - External gradient max:  6.768814e+07
2025-11-12 08:46:17 - Internal gradient max:  6.768814e+07
2025-11-12 08:46:17 - --------------------------------------------------------------------------------
2025-11-12 08:46:17 - [Line Search 함수 호출 #iter1-1] [단계 1/2] 전체 우도 계산
2025-11-12 08:46:17 -   측정모델 health_concern: zeta[0]=1.0000, sigma_sq[0]=0.1033
2025-11-12 08:46:17 -   구조모델 (계층적): gamma_health_concern_to_perceived_benefit=0.500000
2025-11-12 08:46:17 -   선택모델 (조절): intercept=0.289973, lambda_main=0.889988, lambda_mod_perceived_price=-0.470015
2025-11-12 08:46:17 - 
================================================================================
2025-11-12 08:46:17 - Iteration 2 - 파라미터 값
2025-11-12 08:46:17 - ================================================================================
2025-11-12 08:46:17 - 
[측정모델 파라미터]
2025-11-12 08:46:17 -   health_concern:
2025-11-12 08:46:17 -     - zeta (처음 3개): [1.         0.03016047 0.03015757]
2025-11-12 08:46:17 -     - sigma_sq (처음 3개): [0.10327632 0.22659067 0.22448993]
2025-11-12 08:46:17 -   perceived_benefit:
2025-11-12 08:46:17 -     - zeta (처음 3개): [1.         0.05201281 0.05263131]
2025-11-12 08:46:17 -     - sigma_sq (처음 3개): [0.12911379 0.1214913  0.17429824]
2025-11-12 08:46:17 -   perceived_price:
2025-11-12 08:46:17 -     - zeta (처음 3개): [1.         0.12752796 0.12784061]
2025-11-12 08:46:17 -     - sigma_sq (처음 3개): [0.1762258  0.38085195 0.39610073]
2025-11-12 08:46:17 -   nutrition_knowledge:
2025-11-12 08:46:17 -     - zeta (처음 3개): [1.         0.02414967 0.0243736 ]
2025-11-12 08:46:17 -     - sigma_sq (처음 3개): [0.10957901 0.12767575 0.14791846]
2025-11-12 08:46:17 -   purchase_intention:
2025-11-12 08:46:17 -     - zeta (처음 3개): [1.         0.08488513 0.08496696]
2025-11-12 08:46:17 -     - sigma_sq (처음 3개): [0.27472094 0.31755703 0.33549538]
2025-11-12 08:46:17 - 
[구조모델 파라미터]
2025-11-12 08:46:17 -   gamma_health_concern_to_perceived_benefit: 0.500000
2025-11-12 08:46:17 -   gamma_perceived_benefit_to_purchase_intention: 0.500000
2025-11-12 08:46:17 - 
[선택모델 파라미터]
2025-11-12 08:46:17 -   intercept: 0.289973
2025-11-12 08:46:17 -   beta: [ 0.22999504  0.21999483 -0.05603404]
2025-11-12 08:46:17 -   lambda_main: 0.889988
2025-11-12 08:46:17 -   lambda_mod_perceived_price: -0.470015
2025-11-12 08:46:17 -   lambda_mod_nutrition_knowledge: 1.199984
2025-11-12 08:46:17 - ================================================================================
2025-11-12 08:47:38 -   LL = -439431.9688 (Best: -439431.9688) [NEW BEST]
2025-11-12 08:47:38 -   파라미터 변화량 (L2 norm): 1.010000e+00
  함수값 변화: +1461604.4170 (감소)
2025-11-12 08:47:38 - [단계 2/2] Analytic Gradient 계산 #2
2025-11-12 08:48:27 - 
[탐색 방향 분석 - Iteration #1]
  탐색 방향 d norm: 1.010000e+00
  탐색 방향 d max: 3.731007e-01
  Gradient norm: 8.805280e+06
  d와 -grad의 코사인 유사도: 0.630074
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.00616047 0.00615757 0.00641554 0.00660145 0.00608714]
  -grad 상위 5개: [166933.40389084 167325.05351304 163719.40869309 161496.84430455
 169742.1059059 ]
  → Hessian이 방향을 조정함

2025-11-12 08:48:27 - 
[실제 계산에 사용된 파라미터 값 - Iteration #1]
  (External scale, 상위 10개)

2025-11-12 08:48:27 -     [79] param_79                                : +1.199984e+00 (internal: +1.199984e+00)
2025-11-12 08:48:27 -     [77] param_77                                : +8.899876e-01 (internal: +8.899876e-01)
2025-11-12 08:48:27 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 08:48:27 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 08:48:27 -     [78] param_78                                : -4.700146e-01 (internal: -4.700146e-01)
2025-11-12 08:48:27 -     [26] param_26                                : +3.961007e-01 (internal: +3.961007e-01)
2025-11-12 08:48:27 -     [25] param_25                                : +3.808519e-01 (internal: +3.808519e-01)
2025-11-12 08:48:27 -     [70] param_70                                : +3.354954e-01 (internal: +3.354954e-01)
2025-11-12 08:48:27 -     [69] param_69                                : +3.175570e-01 (internal: +3.175570e-01)
2025-11-12 08:48:27 -     [73] param_73                                : +2.899731e-01 (internal: +2.899731e-01)
2025-11-12 08:48:27 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 08:48:27 - [Line Search 함수 호출 #iter2-2] [단계 1/2] 전체 우도 계산
2025-11-12 08:48:27 - 
================================================================================
2025-11-12 08:48:27 - Iteration 3 - 파라미터 값
2025-11-12 08:48:27 - ================================================================================
2025-11-12 08:48:27 - 
[측정모델 파라미터]
2025-11-12 08:48:27 -   health_concern:
2025-11-12 08:48:27 -     - zeta (처음 3개): [1.         0.03016047 0.03015757]
2025-11-12 08:48:27 -     - sigma_sq (처음 3개): [0.10327632 0.22659067 0.22448993]
2025-11-12 08:48:27 -   perceived_benefit:
2025-11-12 08:48:27 -     - zeta (처음 3개): [1.         0.05201281 0.05263131]
2025-11-12 08:48:27 -     - sigma_sq (처음 3개): [0.12911379 0.1214913  0.17429824]
2025-11-12 08:48:27 -   perceived_price:
2025-11-12 08:48:27 -     - zeta (처음 3개): [1.         0.12752796 0.12784061]
2025-11-12 08:48:27 -     - sigma_sq (처음 3개): [0.1762258  0.38085195 0.39610073]
2025-11-12 08:48:27 -   nutrition_knowledge:
2025-11-12 08:48:27 -     - zeta (처음 3개): [1.         0.02414967 0.0243736 ]
2025-11-12 08:48:27 -     - sigma_sq (처음 3개): [0.10957901 0.12767575 0.14791846]
2025-11-12 08:48:27 -   purchase_intention:
2025-11-12 08:48:27 -     - zeta (처음 3개): [1.         0.08488513 0.08496696]
2025-11-12 08:48:27 -     - sigma_sq (처음 3개): [0.27472094 0.31755703 0.33549538]
2025-11-12 08:48:27 - 
[구조모델 파라미터]
2025-11-12 08:48:27 -   gamma_health_concern_to_perceived_benefit: 0.500000
2025-11-12 08:48:27 -   gamma_perceived_benefit_to_purchase_intention: 0.500000
2025-11-12 08:48:27 - 
[선택모델 파라미터]
2025-11-12 08:48:27 -   intercept: 0.289973
2025-11-12 08:48:27 -   beta: [ 0.22999504  0.21999483 -0.05603404]
2025-11-12 08:48:27 -   lambda_main: 0.889988
2025-11-12 08:48:27 -   lambda_mod_perceived_price: -0.470015
2025-11-12 08:48:27 -   lambda_mod_nutrition_knowledge: 1.199984
2025-11-12 08:48:27 - ================================================================================
2025-11-12 08:49:47 -   LL = -439431.9688 (Best: -439431.9688) 
2025-11-12 08:49:47 -   파라미터 변화량 (L2 norm): 1.010000e+00
  함수값 변화: +1461604.4170 (감소)
2025-11-12 08:49:47 - [단계 2/2] Analytic Gradient 계산 #3
2025-11-12 08:50:38 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 08:50:38 - [단계 2/2] Analytic Gradient 계산 #4
2025-11-12 08:51:27 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 08:51:27 - 
================================================================================
[Major Iteration #1 완료]
  최종 LL: -439431.9688
  Line Search: 2회 함수 호출 - ✓ 성공 (함수값 감소: 1461604.4170)
  함수 호출: 2회 (누적)
  그래디언트 호출: 2회 (누적)
  수렴 조건:
    - ftol = N/A (첫 iteration)
    - gtol = 2.028281e+06 (기준: 1e-3)

  상위 10개 Gradient (절대값 기준):
    [63] param_63                                : -2.028281e+06
    [56] param_56                                : -1.908653e+06
    [65] param_65                                : -1.899931e+06
    [49] param_49                                : -1.897931e+06
    [47] param_47                                : -1.891126e+06
    [53] param_53                                : -1.861959e+06
    [64] param_64                                : -1.857361e+06
    [62] param_62                                : -1.820290e+06
    [48] param_48                                : -1.759282e+06
    [54] param_54                                : -1.742179e+06

  Hessian 업데이트: 첫 iteration (초기 H = I)
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 08:51:27 - [Major Iteration #2 시작] [단계 1/2] 전체 우도 계산
2025-11-12 08:52:45 -   LL = -340181.7120 (Best: -340181.7120) [NEW BEST]
2025-11-12 08:52:45 - [단계 2/2] Analytic Gradient 계산 #5
2025-11-12 08:53:35 - [Line Search 함수 호출 #iter3-1] [단계 1/2] 전체 우도 계산
2025-11-12 08:54:53 -   LL = -340181.7120 (Best: -340181.7120) 
2025-11-12 08:54:53 -   파라미터 변화량 (L2 norm): 0.000000e+00
  함수값 변화: +0.0000 (증가)
2025-11-12 08:54:53 - [단계 2/2] Analytic Gradient 계산 #6
2025-11-12 08:55:42 - 
[탐색 방향 분석 - Iteration #3]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 4.563945e+06
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [170990.13959942 170714.01326483 172177.20007438 172800.99820814
 171165.04600285]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 08:55:42 - 
[실제 계산에 사용된 파라미터 값 - Iteration #3]
  (External scale, 상위 10개)

2025-11-12 08:55:42 -     [79] param_79                                : +1.199847e+00 (internal: +1.199847e+00)
2025-11-12 08:55:42 -     [77] param_77                                : +8.898127e-01 (internal: +8.898127e-01)
2025-11-12 08:55:42 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 08:55:42 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 08:55:42 -     [78] param_78                                : -4.702767e-01 (internal: -4.702767e-01)
2025-11-12 08:55:42 -     [26] param_26                                : +2.905608e-01 (internal: +2.905608e-01)
2025-11-12 08:55:42 -     [73] param_73                                : +2.895962e-01 (internal: +2.895962e-01)
2025-11-12 08:55:42 -     [25] param_25                                : +2.807237e-01 (internal: +2.807237e-01)
2025-11-12 08:55:42 -     [70] param_70                                : +2.564718e-01 (internal: +2.564718e-01)
2025-11-12 08:55:42 -     [69] param_69                                : +2.453166e-01 (internal: +2.453166e-01)
2025-11-12 08:55:42 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 08:55:42 - [단계 2/2] Analytic Gradient 계산 #7
2025-11-12 08:56:29 - 
[탐색 방향 분석 - Iteration #3]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 4.563945e+06
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [170990.13959942 170714.01326483 172177.20007438 172800.99820814
 171165.04600285]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 08:56:29 - 
[실제 계산에 사용된 파라미터 값 - Iteration #3]
  (External scale, 상위 10개)

2025-11-12 08:56:29 -     [79] param_79                                : +1.199847e+00 (internal: +1.199847e+00)
2025-11-12 08:56:29 -     [77] param_77                                : +8.898127e-01 (internal: +8.898127e-01)
2025-11-12 08:56:29 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 08:56:29 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 08:56:29 -     [78] param_78                                : -4.702767e-01 (internal: -4.702767e-01)
2025-11-12 08:56:29 -     [26] param_26                                : +2.905608e-01 (internal: +2.905608e-01)
2025-11-12 08:56:29 -     [73] param_73                                : +2.895962e-01 (internal: +2.895962e-01)
2025-11-12 08:56:29 -     [25] param_25                                : +2.807237e-01 (internal: +2.807237e-01)
2025-11-12 08:56:29 -     [70] param_70                                : +2.564718e-01 (internal: +2.564718e-01)
2025-11-12 08:56:29 -     [69] param_69                                : +2.453166e-01 (internal: +2.453166e-01)
2025-11-12 08:56:29 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 08:56:29 - [단계 2/2] Analytic Gradient 계산 #8
2025-11-12 08:57:18 - 
[탐색 방향 분석 - Iteration #3]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 4.563945e+06
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [170990.13959942 170714.01326483 172177.20007438 172800.99820814
 171165.04600285]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 08:57:18 - 
[실제 계산에 사용된 파라미터 값 - Iteration #3]
  (External scale, 상위 10개)

2025-11-12 08:57:18 -     [79] param_79                                : +1.199847e+00 (internal: +1.199847e+00)
2025-11-12 08:57:18 -     [77] param_77                                : +8.898127e-01 (internal: +8.898127e-01)
2025-11-12 08:57:18 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 08:57:18 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 08:57:18 -     [78] param_78                                : -4.702767e-01 (internal: -4.702767e-01)
2025-11-12 08:57:18 -     [26] param_26                                : +2.905608e-01 (internal: +2.905608e-01)
2025-11-12 08:57:18 -     [73] param_73                                : +2.895962e-01 (internal: +2.895962e-01)
2025-11-12 08:57:18 -     [25] param_25                                : +2.807237e-01 (internal: +2.807237e-01)
2025-11-12 08:57:18 -     [70] param_70                                : +2.564718e-01 (internal: +2.564718e-01)
2025-11-12 08:57:18 -     [69] param_69                                : +2.453166e-01 (internal: +2.453166e-01)
2025-11-12 08:57:18 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 08:57:18 - 
================================================================================
[Major Iteration #2 완료]
  최종 LL: -340181.7120
  Line Search: 1회 함수 호출 - ⚠️  정체 (함수값 변화 없음)
  함수 호출: 3회 (누적)
  그래디언트 호출: 3회 (누적)
  수렴 조건:
    - ftol = 2.258603e-01 (기준: 1e-3)
    - gtol = 8.986075e+05 (기준: 1e-3, 변화: -1.13e+06 [-55.7%])

  상위 10개 Gradient (절대값 기준):
    [19] param_19                                : -8.986075e+05
    [20] param_20                                : -8.855441e+05
    [ 9] param_9                                 : -8.789952e+05
    [ 8] param_8                                 : -8.787903e+05
    [ 6] param_6                                 : -8.752871e+05
    [ 7] param_7                                 : -8.744443e+05
    [10] param_10                                : -8.716035e+05
    [18] param_18                                : -8.437140e+05
    [59] param_59                                : -8.358064e+05
    [58] param_58                                : -8.313692e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 4.190306e-01
    - y_k (gradient 변화) norm: 4.990596e+06
    - s_k^T · y_k: 1.933122e+06 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 5.172979e-07
    - s_k 상위 5개: [0.00824865 0.00827357 0.0079701  0.00777443 0.00844415]
    - y_k 상위 5개: [ -4056.73570858  -3388.95975179  -8457.79138129 -11304.1539036
  -1422.94009695]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 08:57:18 - [Major Iteration #3 시작] [단계 1/2] 전체 우도 계산
2025-11-12 08:58:33 -   LL = -331782.4016 (Best: -331782.4016) [NEW BEST]
2025-11-12 08:58:33 - [단계 2/2] Analytic Gradient 계산 #9
2025-11-12 08:59:20 - [Line Search 함수 호출 #iter4-1] [단계 1/2] 전체 우도 계산
2025-11-12 09:00:35 -   LL = -331782.4016 (Best: -331782.4016) 
2025-11-12 09:00:35 -   파라미터 변화량 (L2 norm): 0.000000e+00
  함수값 변화: +0.0000 (증가)
2025-11-12 09:00:35 - [단계 2/2] Analytic Gradient 계산 #10
2025-11-12 09:01:24 - 
[탐색 방향 분석 - Iteration #4]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 4.283642e+06
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [149231.15429416 148650.34669484 151812.93765426 153626.83599421
 148616.6376451 ]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 09:01:24 - 
[실제 계산에 사용된 파라미터 값 - Iteration #4]
  (External scale, 상위 10개)

2025-11-12 09:01:24 -     [79] param_79                                : +1.199628e+00 (internal: +1.199628e+00)
2025-11-12 09:01:24 -     [77] param_77                                : +8.896243e-01 (internal: +8.896243e-01)
2025-11-12 09:01:24 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:01:24 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:01:24 -     [78] param_78                                : -4.705400e-01 (internal: -4.705400e-01)
2025-11-12 09:01:24 -     [73] param_73                                : +2.891594e-01 (internal: +2.891594e-01)
2025-11-12 09:01:24 -     [ 9] param_9                                 : +2.482781e-01 (internal: +2.482781e-01)
2025-11-12 09:01:24 -     [ 8] param_8                                 : +2.446226e-01 (internal: +2.446226e-01)
2025-11-12 09:01:24 -     [26] param_26                                : +2.409318e-01 (internal: +2.409318e-01)
2025-11-12 09:01:24 -     [ 6] param_6                                 : +2.391893e-01 (internal: +2.391893e-01)
2025-11-12 09:01:24 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 09:01:24 - [단계 2/2] Analytic Gradient 계산 #11
2025-11-12 09:02:12 - 
[탐색 방향 분석 - Iteration #4]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 4.283642e+06
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [149231.15429416 148650.34669484 151812.93765426 153626.83599421
 148616.6376451 ]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 09:02:12 - 
[실제 계산에 사용된 파라미터 값 - Iteration #4]
  (External scale, 상위 10개)

2025-11-12 09:02:12 -     [79] param_79                                : +1.199628e+00 (internal: +1.199628e+00)
2025-11-12 09:02:12 -     [77] param_77                                : +8.896243e-01 (internal: +8.896243e-01)
2025-11-12 09:02:12 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:02:12 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:02:12 -     [78] param_78                                : -4.705400e-01 (internal: -4.705400e-01)
2025-11-12 09:02:12 -     [73] param_73                                : +2.891594e-01 (internal: +2.891594e-01)
2025-11-12 09:02:12 -     [ 9] param_9                                 : +2.482781e-01 (internal: +2.482781e-01)
2025-11-12 09:02:12 -     [ 8] param_8                                 : +2.446226e-01 (internal: +2.446226e-01)
2025-11-12 09:02:12 -     [26] param_26                                : +2.409318e-01 (internal: +2.409318e-01)
2025-11-12 09:02:12 -     [ 6] param_6                                 : +2.391893e-01 (internal: +2.391893e-01)
2025-11-12 09:02:12 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 09:02:12 - [단계 2/2] Analytic Gradient 계산 #12
2025-11-12 09:03:02 - 
[탐색 방향 분석 - Iteration #4]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 4.283642e+06
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [149231.15429416 148650.34669484 151812.93765426 153626.83599421
 148616.6376451 ]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 09:03:02 - 
[실제 계산에 사용된 파라미터 값 - Iteration #4]
  (External scale, 상위 10개)

2025-11-12 09:03:02 -     [79] param_79                                : +1.199628e+00 (internal: +1.199628e+00)
2025-11-12 09:03:02 -     [77] param_77                                : +8.896243e-01 (internal: +8.896243e-01)
2025-11-12 09:03:02 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:03:02 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:03:02 -     [78] param_78                                : -4.705400e-01 (internal: -4.705400e-01)
2025-11-12 09:03:02 -     [73] param_73                                : +2.891594e-01 (internal: +2.891594e-01)
2025-11-12 09:03:02 -     [ 9] param_9                                 : +2.482781e-01 (internal: +2.482781e-01)
2025-11-12 09:03:02 -     [ 8] param_8                                 : +2.446226e-01 (internal: +2.446226e-01)
2025-11-12 09:03:02 -     [26] param_26                                : +2.409318e-01 (internal: +2.409318e-01)
2025-11-12 09:03:02 -     [ 6] param_6                                 : +2.391893e-01 (internal: +2.391893e-01)
2025-11-12 09:03:02 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 09:03:02 - 
================================================================================
[Major Iteration #3 완료]
  최종 LL: -331782.4016
  Line Search: 1회 함수 호출 - ⚠️  정체 (함수값 변화 없음)
  함수 호출: 4회 (누적)
  그래디언트 호출: 4회 (누적)
  수렴 조건:
    - ftol = 2.469066e-02 (기준: 1e-3, 변화: -2.01e-01 [-89.1%])
    - gtol = 7.574358e+05 (기준: 1e-3, 변화: -1.41e+05 [-15.7%])

  상위 10개 Gradient (절대값 기준):
    [59] param_59                                : -7.574358e+05
    [58] param_58                                : -7.564340e+05
    [61] param_61                                : -7.515068e+05
    [50] param_50                                : -7.511718e+05
    [52] param_52                                : -7.493339e+05
    [57] param_57                                : -7.477406e+05
    [51] param_51                                : -7.470063e+05
    [60] param_60                                : -7.450018e+05
    [55] param_55                                : -7.444156e+05
    [54] param_54                                : -7.443343e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 1.255040e-01
    - y_k (gradient 변화) norm: 7.228013e+05
    - s_k^T · y_k: 8.323885e+04 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 1.201362e-05
    - s_k 상위 5개: [0.01231515 0.01227113 0.0124979  0.01259956 0.01225741]
    - y_k 상위 5개: [21758.98530526 22063.66656999 20364.26242012 19174.16221393
 22548.40835775]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 09:03:02 - [Major Iteration #4 시작] [단계 1/2] 전체 우도 계산
2025-11-12 09:04:18 -   LL = -331106.0721 (Best: -331106.0721) [NEW BEST]
2025-11-12 09:04:18 - [단계 2/2] Analytic Gradient 계산 #13
2025-11-12 09:05:06 - [Line Search 함수 호출 #iter4-1] [단계 1/2] 전체 우도 계산
2025-11-12 09:06:22 -   LL = -328491.3734 (Best: -328491.3734) [NEW BEST]
2025-11-12 09:06:22 -   파라미터 변화량 (L2 norm): 1.220020e-01
  함수값 변화: +2614.6987 (감소)
2025-11-12 09:06:22 - [단계 2/2] Analytic Gradient 계산 #14
2025-11-12 09:07:11 - 
[탐색 방향 분석 - Iteration #4]
  탐색 방향 d norm: 1.220020e-01
  탐색 방향 d max: 2.673768e-02
  Gradient norm: 4.254201e+06
  d와 -grad의 코사인 유사도: 0.115207
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.0246805  0.02441317 0.02587561 0.02673768 0.02413591]
  -grad 상위 5개: [140789.88666378 140685.74134009 141140.14129355 141017.68859973
 141433.44809013]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 1.525026e-01
    - 변화량 max: 3.342210e-02
    - 변화 상위 5개 인덱스: [ 3 23  2 22  0]
    - 변화 상위 5개 값: [0.0334221  0.0333954  0.03234451 0.03225522 0.03085063]

2025-11-12 09:07:11 - 
[실제 계산에 사용된 파라미터 값 - Iteration #4]
  (External scale, 상위 10개)

2025-11-12 09:07:11 -     [79] param_79                                : +1.198882e+00 (internal: +1.198882e+00)
2025-11-12 09:07:11 -     [77] param_77                                : +8.889694e-01 (internal: +8.889694e-01)
2025-11-12 09:07:11 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:07:11 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:07:11 -     [78] param_78                                : -4.714940e-01 (internal: -4.714940e-01)
2025-11-12 09:07:11 -     [73] param_73                                : +2.876118e-01 (internal: +2.876118e-01)
2025-11-12 09:07:11 -     [ 9] param_9                                 : +2.535307e-01 (internal: +2.535307e-01)
2025-11-12 09:07:11 -     [70] param_70                                : +2.533150e-01 (internal: +2.533150e-01)
2025-11-12 09:07:11 -     [69] param_69                                : +2.511274e-01 (internal: +2.511274e-01)
2025-11-12 09:07:11 -     [ 8] param_8                                 : +2.471017e-01 (internal: +2.471017e-01)
2025-11-12 09:07:11 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:07:11 - [Line Search 함수 호출 #iter5-2] [단계 1/2] 전체 우도 계산
2025-11-12 09:07:11 - 
================================================================================
2025-11-12 09:07:11 - Iteration 10 - 파라미터 값
2025-11-12 09:07:11 - ================================================================================
2025-11-12 09:07:11 - 
[측정모델 파라미터]
2025-11-12 09:07:11 -   health_concern:
2025-11-12 09:07:11 -     - zeta (처음 3개): [1.         0.0815749  0.08121873]
2025-11-12 09:07:11 -     - sigma_sq (처음 3개): [0.17070604 0.23790566 0.23652103]
2025-11-12 09:07:11 -   perceived_benefit:
2025-11-12 09:07:11 -     - zeta (처음 3개): [1.         0.07363884 0.07668167]
2025-11-12 09:07:11 -     - sigma_sq (처음 3개): [0.19085151 0.18203538 0.21300235]
2025-11-12 09:07:11 -   perceived_price:
2025-11-12 09:07:11 -     - zeta (처음 3개): [1.         0.16723354 0.16862938]
2025-11-12 09:07:11 -     - sigma_sq (처음 3개): [0.19566521 0.21806392 0.21437648]
2025-11-12 09:07:11 -   nutrition_knowledge:
2025-11-12 09:07:11 -     - zeta (처음 3개): [1.         0.06771065 0.06944639]
2025-11-12 09:07:11 -     - sigma_sq (처음 3개): [0.16403487 0.20705026 0.22521837]
2025-11-12 09:07:11 -   purchase_intention:
2025-11-12 09:07:11 -     - zeta (처음 3개): [1.         0.09874165 0.09907973]
2025-11-12 09:07:11 -     - sigma_sq (처음 3개): [0.24261891 0.25112741 0.253315  ]
2025-11-12 09:07:11 - 
[구조모델 파라미터]
2025-11-12 09:07:11 -   gamma_health_concern_to_perceived_benefit: 0.500000
2025-11-12 09:07:11 -   gamma_perceived_benefit_to_purchase_intention: 0.500000
2025-11-12 09:07:11 - 
[선택모델 파라미터]
2025-11-12 09:07:11 -   intercept: 0.287612
2025-11-12 09:07:11 -   beta: [ 0.22952589  0.21950579 -0.05912031]
2025-11-12 09:07:11 -   lambda_main: 0.888969
2025-11-12 09:07:11 -   lambda_mod_perceived_price: -0.471494
2025-11-12 09:07:11 -   lambda_mod_nutrition_knowledge: 1.198882
2025-11-12 09:07:11 - ================================================================================
2025-11-12 09:08:26 -   LL = -328491.3734 (Best: -328491.3734) 
2025-11-12 09:08:26 -   파라미터 변화량 (L2 norm): 1.220020e-01
  함수값 변화: +2614.6987 (감소)
2025-11-12 09:08:26 - [단계 2/2] Analytic Gradient 계산 #15
2025-11-12 09:09:15 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:09:15 - [단계 2/2] Analytic Gradient 계산 #16
2025-11-12 09:10:04 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:10:04 - [단계 2/2] Analytic Gradient 계산 #17
2025-11-12 09:10:52 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:10:52 - 
================================================================================
[Major Iteration #4 완료]
  최종 LL: -328491.3734
  Line Search: 2회 함수 호출 - ✓ 성공 (함수값 감소: 2614.6987)
  함수 호출: 6회 (누적)
  그래디언트 호출: 6회 (누적)
  수렴 조건:
    - ftol = 9.919237e-03 (기준: 1e-3, 변화: -1.48e-02 [-59.8%])
    - gtol = 7.671289e+05 (기준: 1e-3, 변화: +9.69e+03 [+1.3%])

  상위 10개 Gradient (절대값 기준):
    [26] param_26                                : -7.671289e+05
    [59] param_59                                : -7.570564e+05
    [58] param_58                                : -7.551522e+05
    [61] param_61                                : -7.442961e+05
    [50] param_50                                : -7.437721e+05
    [52] param_52                                : -7.402511e+05
    [57] param_57                                : -7.368212e+05
    [51] param_51                                : -7.358372e+05
    [60] param_60                                : -7.315530e+05
    [55] param_55                                : -7.306317e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 1.525026e-01
    - y_k (gradient 변화) norm: 3.024437e+05
    - s_k^T · y_k: 1.008924e+04 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 9.911548e-05
    - s_k 상위 5개: [0.03085063 0.03051646 0.03234451 0.0334221  0.03016989]
    - y_k 상위 5개: [ 8441.26763038  7964.60535474 10672.79636071 12609.14739448
  7183.18955497]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 09:10:52 - [Major Iteration #5 시작] [단계 1/2] 전체 우도 계산
2025-11-12 09:12:08 -   LL = -328203.8261 (Best: -328203.8261) [NEW BEST]
2025-11-12 09:12:08 - [단계 2/2] Analytic Gradient 계산 #18
2025-11-12 09:12:56 - [Line Search 함수 호출 #iter5-1] [단계 1/2] 전체 우도 계산
2025-11-12 09:14:11 -   LL = -327030.2700 (Best: -327030.2700) [NEW BEST]
2025-11-12 09:14:11 -   파라미터 변화량 (L2 norm): 4.900750e-02
  함수값 변화: +1173.5561 (감소)
2025-11-12 09:14:11 - [단계 2/2] Analytic Gradient 계산 #19
2025-11-12 09:14:58 - 
[탐색 방향 분석 - Iteration #5]
  탐색 방향 d norm: 4.900750e-02
  탐색 방향 d max: 1.099331e-02
  Gradient norm: 4.242971e+06
  d와 -grad의 코사인 유사도: 0.128101
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.00987635 0.00978429 0.01028398 0.01056584 0.00969979]
  -grad 상위 5개: [137873.56559481 137705.08898397 137877.81996856 137383.92742771
 138633.33610379]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 1.822563e-01
    - 변화량 max: 4.045796e-02
    - 변화 상위 5개 인덱스: [23  3 22  2  0]
    - 변화 상위 5개 값: [0.04045796 0.03994498 0.03893656 0.03873058 0.03702594]

2025-11-12 09:14:58 - 
[실제 계산에 사용된 파라미터 값 - Iteration #5]
  (External scale, 상위 10개)

2025-11-12 09:14:58 -     [79] param_79                                : +1.198584e+00 (internal: +1.198584e+00)
2025-11-12 09:14:58 -     [77] param_77                                : +8.886996e-01 (internal: +8.886996e-01)
2025-11-12 09:14:58 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:14:58 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:14:58 -     [78] param_78                                : -4.718993e-01 (internal: -4.718993e-01)
2025-11-12 09:14:58 -     [73] param_73                                : +2.869650e-01 (internal: +2.869650e-01)
2025-11-12 09:14:58 -     [70] param_70                                : +2.562965e-01 (internal: +2.562965e-01)
2025-11-12 09:14:58 -     [69] param_69                                : +2.547714e-01 (internal: +2.547714e-01)
2025-11-12 09:14:58 -     [ 9] param_9                                 : +2.537998e-01 (internal: +2.537998e-01)
2025-11-12 09:14:58 -     [68] param_68                                : +2.473829e-01 (internal: +2.473829e-01)
2025-11-12 09:14:58 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:14:58 - [Line Search 함수 호출 #iter5-2] [단계 1/2] 전체 우도 계산
2025-11-12 09:16:14 -   LL = -322056.2981 (Best: -322056.2981) [NEW BEST]
2025-11-12 09:16:14 -   파라미터 변화량 (L2 norm): 2.450375e-01
  함수값 변화: +6147.5280 (감소)
2025-11-12 09:16:14 - [단계 2/2] Analytic Gradient 계산 #20
2025-11-12 09:17:02 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:17:02 - [Line Search 함수 호출 #iter5-3] [단계 1/2] 전체 우도 계산
2025-11-12 09:18:17 -   LL = -303143.1492 (Best: -303143.1492) [NEW BEST]
2025-11-12 09:18:17 -   파라미터 변화량 (L2 norm): 1.029158e+00
  함수값 변화: +25060.6769 (감소)
2025-11-12 09:18:17 - [단계 2/2] Analytic Gradient 계산 #21
2025-11-12 09:19:05 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:19:05 - [Line Search 함수 호출 #iter6-4] [단계 1/2] 전체 우도 계산
2025-11-12 09:20:21 -   LL = -303143.1492 (Best: -303143.1492) 
2025-11-12 09:20:21 -   파라미터 변화량 (L2 norm): 1.029158e+00
  함수값 변화: +25060.6769 (감소)
2025-11-12 09:20:21 - [단계 2/2] Analytic Gradient 계산 #22
2025-11-12 09:21:09 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:21:09 - [단계 2/2] Analytic Gradient 계산 #23
2025-11-12 09:21:58 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:21:58 - [단계 2/2] Analytic Gradient 계산 #24
2025-11-12 09:22:45 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:22:45 - 
================================================================================
[Major Iteration #5 완료]
  최종 LL: -303143.1492
  Line Search: 4회 함수 호출 - ✓ 성공 (함수값 감소: 25060.6769)
  함수 호출: 10회 (누적)
  그래디언트 호출: 10회 (누적)
  수렴 조건:
    - ftol = 7.716557e-02 (기준: 1e-3, 변화: +6.72e-02 [+677.9%])
    - gtol = 1.587765e+06 (기준: 1e-3, 변화: +8.21e+05 [+107.0%])

  상위 10개 Gradient (절대값 기준):
    [26] param_26                                : -1.587765e+06
    [46] param_46                                : -1.419372e+06
    [25] param_25                                : -1.173026e+06
    [20] param_20                                : -7.934754e+05
    [18] param_18                                : -7.882721e+05
    [19] param_19                                : -7.839429e+05
    [21] param_21                                : -6.928549e+05
    [10] param_10                                : -6.901996e+05
    [59] param_59                                : -6.726573e+05
    [58] param_58                                : -6.687684e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 1.041409e+00
    - y_k (gradient 변화) norm: 1.458306e+06
    - s_k^T · y_k: 1.479297e+05 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 6.759967e-06
    - s_k 상위 5개: [0.20987245 0.20791606 0.21853452 0.22452403 0.20612049]
    - y_k 상위 5개: [45085.09702321 43512.80244727 48457.71356044 50925.481828
 42281.87435383]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 09:22:45 - [Major Iteration #6 시작] [단계 1/2] 전체 우도 계산
2025-11-12 09:24:00 -   LL = -300426.3430 (Best: -300426.3430) [NEW BEST]
2025-11-12 09:24:00 - [단계 2/2] Analytic Gradient 계산 #25
2025-11-12 09:24:46 - [Line Search 함수 호출 #iter6-1] [단계 1/2] 전체 우도 계산
2025-11-12 09:26:02 -   LL = -290725.1097 (Best: -290725.1097) [NEW BEST]
2025-11-12 09:26:02 -   파라미터 변화량 (L2 norm): 3.811704e-01
  함수값 변화: +9701.2333 (감소)
2025-11-12 09:26:02 - [단계 2/2] Analytic Gradient 계산 #26
2025-11-12 09:26:52 - 
[탐색 방향 분석 - Iteration #6]
  탐색 방향 d norm: 3.811704e-01
  탐색 방향 d max: 8.475614e-02
  Gradient norm: 4.574975e+06
  d와 -grad의 코사인 유사도: 0.092664
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.07673114 0.07601877 0.08008281 0.08245507 0.07530629]
  -grad 상위 5개: [92452.60609979 93958.26266464 87587.65446571 84076.488392
 96824.06953205]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 1.502453e+00
    - 변화량 max: 3.368047e-01
    - 변화 상위 5개 인덱스: [23  3 22  2  0]
    - 변화 상위 5개 값: [0.33680472 0.32495141 0.32191711 0.31606704 0.30331728]

2025-11-12 09:26:52 - 
[실제 계산에 사용된 파라미터 값 - Iteration #6]
  (External scale, 상위 10개)

2025-11-12 09:26:52 -     [79] param_79                                : +1.191517e+00 (internal: +1.191517e+00)
2025-11-12 09:26:52 -     [77] param_77                                : +8.822937e-01 (internal: +8.822937e-01)
2025-11-12 09:26:52 -     [23] param_23                                : +5.081824e-01 (internal: +5.081824e-01)
2025-11-12 09:26:52 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:26:52 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:26:52 -     [22] param_22                                : +4.917771e-01 (internal: +4.917771e-01)
2025-11-12 09:26:52 -     [78] param_78                                : -4.815258e-01 (internal: -4.815258e-01)
2025-11-12 09:26:52 -     [ 3] param_3                                 : +4.119904e-01 (internal: +4.119904e-01)
2025-11-12 09:26:52 -     [ 2] param_2                                 : +4.018661e-01 (internal: +4.018661e-01)
2025-11-12 09:26:52 -     [ 0] param_0                                 : +3.873613e-01 (internal: +3.873613e-01)
2025-11-12 09:26:52 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:26:52 - [Line Search 함수 호출 #iter7-2] [단계 1/2] 전체 우도 계산
2025-11-12 09:28:07 -   LL = -290725.1097 (Best: -290725.1097) 
2025-11-12 09:28:07 -   파라미터 변화량 (L2 norm): 3.811704e-01
  함수값 변화: +9701.2333 (감소)
2025-11-12 09:28:07 - [단계 2/2] Analytic Gradient 계산 #27
2025-11-12 09:28:55 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:28:55 - [단계 2/2] Analytic Gradient 계산 #28
2025-11-12 09:29:43 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:29:43 - [단계 2/2] Analytic Gradient 계산 #29
2025-11-12 09:30:29 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:30:29 - 
================================================================================
[Major Iteration #6 완료]
  최종 LL: -290725.1097
  Line Search: 2회 함수 호출 - ✓ 성공 (함수값 감소: 9701.2333)
  함수 호출: 12회 (누적)
  그래디언트 호출: 12회 (누적)
  수렴 조건:
    - ftol = 4.096428e-02 (기준: 1e-3, 변화: -3.62e-02 [-46.9%])
    - gtol = 2.118025e+06 (기준: 1e-3, 변화: +5.30e+05 [+33.4%])

  상위 10개 Gradient (절대값 기준):
    [26] param_26                                : -2.118025e+06
    [25] param_25                                : -1.577765e+06
    [18] param_18                                : -8.669626e+05
    [20] param_20                                : -8.648959e+05
    [19] param_19                                : -8.456019e+05
    [46] param_46                                : -8.319604e+05
    [63] param_63                                : -7.467187e+05
    [21] param_21                                : -7.320371e+05
    [10] param_10                                : -7.020944e+05
    [ 7] param_7                                 : -6.698344e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 4.764629e-01
    - y_k (gradient 변화) norm: 9.283478e+05
    - s_k^T · y_k: 5.402859e+04 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 1.850872e-05
    - s_k 상위 5개: [0.09591392 0.09502346 0.10010352 0.10306884 0.09413286]
    - y_k 상위 5개: [3252.18354079 3214.67622818 5094.7732674  6015.71837972 2327.50420425]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 09:30:29 - [Major Iteration #7 시작] [단계 1/2] 전체 우도 계산
2025-11-12 09:31:44 -   LL = -289405.9602 (Best: -289405.9602) [NEW BEST]
2025-11-12 09:31:44 - [단계 2/2] Analytic Gradient 계산 #30
2025-11-12 09:32:34 - [Line Search 함수 호출 #iter8-1] [단계 1/2] 전체 우도 계산
2025-11-12 09:32:34 - 
================================================================================
2025-11-12 09:32:34 - Iteration 20 - 파라미터 값
2025-11-12 09:32:34 - ================================================================================
2025-11-12 09:32:34 - 
[측정모델 파라미터]
2025-11-12 09:32:34 -   health_concern:
2025-11-12 09:32:34 -     - zeta (처음 3개): [1.         0.40033674 0.39696456]
2025-11-12 09:32:34 -     - sigma_sq (처음 3개): [0.22626151 0.22051191 0.21723337]
2025-11-12 09:32:34 -   perceived_benefit:
2025-11-12 09:32:34 -     - zeta (처음 3개): [1.         0.19574843 0.21644102]
2025-11-12 09:32:34 -     - sigma_sq (처음 3개): [0.21041451 0.18785988 0.18676088]
2025-11-12 09:32:34 -   perceived_price:
2025-11-12 09:32:34 -     - zeta (처음 3개): [1.         0.50298226 0.51930587]
2025-11-12 09:32:34 -     - sigma_sq (처음 3개): [0.28718    0.13585648 0.1294628 ]
2025-11-12 09:32:34 -   nutrition_knowledge:
2025-11-12 09:32:34 -     - zeta (처음 3개): [1.         0.34549183 0.35596022]
2025-11-12 09:32:34 -     - sigma_sq (처음 3개): [0.09732338 0.19215528 0.20777518]
2025-11-12 09:32:34 -   purchase_intention:
2025-11-12 09:32:34 -     - zeta (처음 3개): [1.         0.20193473 0.2060772 ]
2025-11-12 09:32:34 -     - sigma_sq (처음 3개): [0.37524936 0.34212991 0.31780154]
2025-11-12 09:32:34 - 
[구조모델 파라미터]
2025-11-12 09:32:34 -   gamma_health_concern_to_perceived_benefit: 0.500000
2025-11-12 09:32:34 -   gamma_perceived_benefit_to_purchase_intention: 0.500000
2025-11-12 09:32:34 - 
[선택모델 파라미터]
2025-11-12 09:32:34 -   intercept: 0.271058
2025-11-12 09:32:34 -   beta: [ 0.22625075  0.21608859 -0.08070271]
2025-11-12 09:32:34 -   lambda_main: 0.882065
2025-11-12 09:32:34 -   lambda_mod_perceived_price: -0.481819
2025-11-12 09:32:34 -   lambda_mod_nutrition_knowledge: 1.191239
2025-11-12 09:32:34 - ================================================================================
2025-11-12 09:33:49 -   LL = -289405.9602 (Best: -289405.9602) 
2025-11-12 09:33:49 -   파라미터 변화량 (L2 norm): 0.000000e+00
  함수값 변화: +0.0000 (증가)
2025-11-12 09:33:49 - [단계 2/2] Analytic Gradient 계산 #31
2025-11-12 09:34:37 - 
[탐색 방향 분석 - Iteration #8]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 4.539832e+06
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [92414.2227639  93956.59744479 87240.48845774 83347.46317278
 96857.10812684]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 09:34:37 - 
[실제 계산에 사용된 파라미터 값 - Iteration #8]
  (External scale, 상위 10개)

2025-11-12 09:34:37 -     [79] param_79                                : +1.191239e+00 (internal: +1.191239e+00)
2025-11-12 09:34:37 -     [77] param_77                                : +8.820646e-01 (internal: +8.820646e-01)
2025-11-12 09:34:37 -     [23] param_23                                : +5.193059e-01 (internal: +5.193059e-01)
2025-11-12 09:34:37 -     [22] param_22                                : +5.029823e-01 (internal: +5.029823e-01)
2025-11-12 09:34:37 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:34:37 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:34:37 -     [78] param_78                                : -4.818189e-01 (internal: -4.818189e-01)
2025-11-12 09:34:37 -     [ 3] param_3                                 : +4.264855e-01 (internal: +4.264855e-01)
2025-11-12 09:34:37 -     [ 2] param_2                                 : +4.156411e-01 (internal: +4.156411e-01)
2025-11-12 09:34:37 -     [ 0] param_0                                 : +4.003367e-01 (internal: +4.003367e-01)
2025-11-12 09:34:37 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 09:34:37 - [단계 2/2] Analytic Gradient 계산 #32
2025-11-12 09:35:27 - 
[탐색 방향 분석 - Iteration #8]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 4.539832e+06
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [92414.2227639  93956.59744479 87240.48845774 83347.46317278
 96857.10812684]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 09:35:27 - 
[실제 계산에 사용된 파라미터 값 - Iteration #8]
  (External scale, 상위 10개)

2025-11-12 09:35:27 -     [79] param_79                                : +1.191239e+00 (internal: +1.191239e+00)
2025-11-12 09:35:27 -     [77] param_77                                : +8.820646e-01 (internal: +8.820646e-01)
2025-11-12 09:35:27 -     [23] param_23                                : +5.193059e-01 (internal: +5.193059e-01)
2025-11-12 09:35:27 -     [22] param_22                                : +5.029823e-01 (internal: +5.029823e-01)
2025-11-12 09:35:27 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:35:27 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:35:27 -     [78] param_78                                : -4.818189e-01 (internal: -4.818189e-01)
2025-11-12 09:35:27 -     [ 3] param_3                                 : +4.264855e-01 (internal: +4.264855e-01)
2025-11-12 09:35:27 -     [ 2] param_2                                 : +4.156411e-01 (internal: +4.156411e-01)
2025-11-12 09:35:27 -     [ 0] param_0                                 : +4.003367e-01 (internal: +4.003367e-01)
2025-11-12 09:35:27 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 09:35:27 - [단계 2/2] Analytic Gradient 계산 #33
2025-11-12 09:36:14 - 
[탐색 방향 분석 - Iteration #8]
  탐색 방향 d norm: 0.000000e+00
  탐색 방향 d max: 0.000000e+00
  Gradient norm: 4.539832e+06
  d와 -grad의 코사인 유사도: 0.000000
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0. 0. 0. 0. 0.]
  -grad 상위 5개: [92414.2227639  93956.59744479 87240.48845774 83347.46317278
 96857.10812684]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 0.000000e+00
    - 변화량 max: 0.000000e+00
    - 변화 상위 5개 인덱스: [79 78 77 76 75]
    - 변화 상위 5개 값: [0. 0. 0. 0. 0.]

2025-11-12 09:36:14 - 
[실제 계산에 사용된 파라미터 값 - Iteration #8]
  (External scale, 상위 10개)

2025-11-12 09:36:14 -     [79] param_79                                : +1.191239e+00 (internal: +1.191239e+00)
2025-11-12 09:36:14 -     [77] param_77                                : +8.820646e-01 (internal: +8.820646e-01)
2025-11-12 09:36:14 -     [23] param_23                                : +5.193059e-01 (internal: +5.193059e-01)
2025-11-12 09:36:14 -     [22] param_22                                : +5.029823e-01 (internal: +5.029823e-01)
2025-11-12 09:36:14 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:36:14 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:36:14 -     [78] param_78                                : -4.818189e-01 (internal: -4.818189e-01)
2025-11-12 09:36:14 -     [ 3] param_3                                 : +4.264855e-01 (internal: +4.264855e-01)
2025-11-12 09:36:14 -     [ 2] param_2                                 : +4.156411e-01 (internal: +4.156411e-01)
2025-11-12 09:36:14 -     [ 0] param_0                                 : +4.003367e-01 (internal: +4.003367e-01)
2025-11-12 09:36:14 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ✓ 만족
  → Strong Wolfe: ✓ 만족
  → Gradient가 충분히 평평해짐
2025-11-12 09:36:14 - 
================================================================================
[Major Iteration #7 완료]
  최종 LL: -289405.9602
  Line Search: 1회 함수 호출 - ⚠️  정체 (함수값 변화 없음)
  함수 호출: 13회 (누적)
  그래디언트 호출: 13회 (누적)
  수렴 조건:
    - ftol = 4.537446e-03 (기준: 1e-3, 변화: -3.64e-02 [-88.9%])
    - gtol = 1.924961e+06 (기준: 1e-3, 변화: -1.93e+05 [-9.1%])

  상위 10개 Gradient (절대값 기준):
    [26] param_26                                : -1.924961e+06
    [25] param_25                                : -1.686167e+06
    [20] param_20                                : -8.786399e+05
    [18] param_18                                : -8.782185e+05
    [46] param_46                                : -8.615486e+05
    [19] param_19                                : -8.600202e+05
    [63] param_63                                : -8.388564e+05
    [21] param_21                                : -7.382933e+05
    [10] param_10                                : -6.967303e+05
    [ 7] param_7                                 : -6.642155e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 5.236876e-02
    - y_k (gradient 변화) norm: 2.504972e+05
    - s_k^T · y_k: 3.431398e+03 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 2.914264e-04
    - s_k 상위 5개: [0.01297547 0.0128063  0.01377498 0.0144951  0.01262887]
    - y_k 상위 5개: [ 38.3833359    1.66521986 347.16600797 729.02521922 -33.03859479]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 09:36:14 - [Major Iteration #8 시작] [단계 1/2] 전체 우도 계산
2025-11-12 09:37:30 -   LL = -289252.6921 (Best: -289252.6921) [NEW BEST]
2025-11-12 09:37:30 - [단계 2/2] Analytic Gradient 계산 #34
2025-11-12 09:38:21 - [Line Search 함수 호출 #iter8-1] [단계 1/2] 전체 우도 계산
2025-11-12 09:39:37 -   LL = -288656.0301 (Best: -288656.0301) [NEW BEST]
2025-11-12 09:39:37 -   파라미터 변화량 (L2 norm): 2.344574e-02
  함수값 변화: +596.6620 (감소)
2025-11-12 09:39:37 - [단계 2/2] Analytic Gradient 계산 #35
2025-11-12 09:40:27 - 
[탐색 방향 분석 - Iteration #8]
  탐색 방향 d norm: 2.344574e-02
  탐색 방향 d max: 7.064758e-03
  Gradient norm: 4.528113e+06
  d와 -grad의 코사인 유사도: 0.094652
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.00626691 0.00617937 0.00667932 0.00706476 0.00608615]
  -grad 상위 5개: [92583.03482557 94145.7088382  87279.15949768 83137.29437915
 97050.45636665]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 2.930718e-02
    - 변화량 max: 8.830947e-03
    - 변화 상위 5개 인덱스: [3 2 0 1 4]
    - 변화 상위 5개 값: [0.00883095 0.00834915 0.00783364 0.00772421 0.00760769]

2025-11-12 09:40:27 - 
[실제 계산에 사용된 파라미터 값 - Iteration #8]
  (External scale, 상위 10개)

2025-11-12 09:40:27 -     [79] param_79                                : +1.191077e+00 (internal: +1.191077e+00)
2025-11-12 09:40:27 -     [77] param_77                                : +8.819359e-01 (internal: +8.819359e-01)
2025-11-12 09:40:27 -     [23] param_23                                : +5.252379e-01 (internal: +5.252379e-01)
2025-11-12 09:40:27 -     [22] param_22                                : +5.094379e-01 (internal: +5.094379e-01)
2025-11-12 09:40:27 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:40:27 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:40:27 -     [78] param_78                                : -4.819721e-01 (internal: -4.819721e-01)
2025-11-12 09:40:27 -     [ 3] param_3                                 : +4.353165e-01 (internal: +4.353165e-01)
2025-11-12 09:40:27 -     [ 2] param_2                                 : +4.239902e-01 (internal: +4.239902e-01)
2025-11-12 09:40:27 -     [ 0] param_0                                 : +4.081704e-01 (internal: +4.081704e-01)
2025-11-12 09:40:27 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:40:27 - [Line Search 함수 호출 #iter8-2] [단계 1/2] 전체 우도 계산
2025-11-12 09:41:43 -   LL = -286527.0456 (Best: -286527.0456) [NEW BEST]
2025-11-12 09:41:43 -   파라미터 변화량 (L2 norm): 1.172287e-01
  함수값 변화: +2725.6465 (감소)
2025-11-12 09:41:43 - [단계 2/2] Analytic Gradient 계산 #36
2025-11-12 09:42:31 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:42:31 - [Line Search 함수 호출 #iter9-3] [단계 1/2] 전체 우도 계산
2025-11-12 09:43:47 -   LL = -286527.0456 (Best: -286527.0456) 
2025-11-12 09:43:47 -   파라미터 변화량 (L2 norm): 1.172287e-01
  함수값 변화: +2725.6465 (감소)
2025-11-12 09:43:47 - [단계 2/2] Analytic Gradient 계산 #37
2025-11-12 09:44:36 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:44:36 - [단계 2/2] Analytic Gradient 계산 #38
2025-11-12 09:45:27 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:45:27 - [단계 2/2] Analytic Gradient 계산 #39
2025-11-12 09:46:15 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:46:15 - 
================================================================================
[Major Iteration #8 완료]
  최종 LL: -286527.0456
  Line Search: 3회 함수 호출 - ✓ 성공 (함수값 감소: 2725.6465)
  함수 호출: 16회 (누적)
  그래디언트 호출: 16회 (누적)
  수렴 조건:
    - ftol = 9.947669e-03 (기준: 1e-3, 변화: +5.41e-03 [+119.2%])
    - gtol = 2.136695e+06 (기준: 1e-3, 변화: +2.12e+05 [+11.0%])

  상위 10개 Gradient (절대값 기준):
    [26] param_26                                : -2.136695e+06
    [25] param_25                                : -1.361095e+06
    [63] param_63                                : -9.192323e+05
    [20] param_20                                : -8.863391e+05
    [18] param_18                                : -8.796039e+05
    [19] param_19                                : -8.721620e+05
    [46] param_46                                : -8.582948e+05
    [21] param_21                                : -7.422245e+05
    [10] param_10                                : -6.800180e+05
    [16] param_16                                : -6.765540e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 1.230901e-01
    - y_k (gradient 변화) norm: 4.237707e+05
    - s_k^T · y_k: 1.328480e+04 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 7.527399e-05
    - s_k 상위 5개: [0.0329013  0.03244167 0.03506643 0.03708998 0.03195229]
    - y_k 상위 5개: [-257.39585615 -339.89673253  324.67039036 1313.23972537 -346.05445949]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 09:46:15 - [Major Iteration #9 시작] [단계 1/2] 전체 우도 계산
2025-11-12 09:47:31 -   LL = -286191.1375 (Best: -286191.1375) [NEW BEST]
2025-11-12 09:47:31 - [단계 2/2] Analytic Gradient 계산 #40
2025-11-12 09:48:19 - [Line Search 함수 호출 #iter9-1] [단계 1/2] 전체 우도 계산
2025-11-12 09:49:36 -   LL = -284939.0888 (Best: -284939.0888) [NEW BEST]
2025-11-12 09:49:36 -   파라미터 변화량 (L2 norm): 5.515817e-02
  함수값 변화: +1252.0487 (감소)
2025-11-12 09:49:36 - [단계 2/2] Analytic Gradient 계산 #41
2025-11-12 09:50:26 - 
[탐색 방향 분석 - Iteration #9]
  탐색 방향 d norm: 5.515817e-02
  탐색 방향 d max: 1.871091e-02
  Gradient norm: 4.468157e+06
  d와 -grad의 코사인 유사도: 0.082153
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.01649163 0.01624439 0.01763539 0.01871091 0.01596854]
  -grad 상위 5개: [93762.85218256 95639.67778675 87871.23962106 82249.77077728
 98499.43652821]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 1.830089e-01
    - 변화량 max: 5.871243e-02
    - 변화 상위 5개 인덱스: [3 2 0 1 4]
    - 변화 상위 5개 값: [0.05871243 0.05544084 0.0519491  0.05120232 0.05039143]

2025-11-12 09:50:26 - 
[실제 계산에 사용된 파라미터 값 - Iteration #9]
  (External scale, 상위 10개)

2025-11-12 09:50:26 -     [79] param_79                                : +1.190150e+00 (internal: +1.190150e+00)
2025-11-12 09:50:26 -     [77] param_77                                : +8.812147e-01 (internal: +8.812147e-01)
2025-11-12 09:50:26 -     [23] param_23                                : +5.579458e-01 (internal: +5.579458e-01)
2025-11-12 09:50:26 -     [22] param_22                                : +5.453595e-01 (internal: +5.453595e-01)
2025-11-12 09:50:26 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:50:26 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:50:26 -     [ 3] param_3                                 : +4.869641e-01 (internal: +4.869641e-01)
2025-11-12 09:50:26 -     [78] param_78                                : -4.827868e-01 (internal: -4.827868e-01)
2025-11-12 09:50:26 -     [ 2] param_2                                 : +4.727517e-01 (internal: +4.727517e-01)
2025-11-12 09:50:26 -     [ 0] param_0                                 : +4.538526e-01 (internal: +4.538526e-01)
2025-11-12 09:50:26 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:50:26 - [Line Search 함수 호출 #iter10-2] [단계 1/2] 전체 우도 계산
2025-11-12 09:51:42 -   LL = -284939.0888 (Best: -284939.0888) 
2025-11-12 09:51:42 -   파라미터 변화량 (L2 norm): 5.515817e-02
  함수값 변화: +1252.0487 (감소)
2025-11-12 09:51:42 - [단계 2/2] Analytic Gradient 계산 #42
2025-11-12 09:52:32 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:52:32 - [단계 2/2] Analytic Gradient 계산 #43
2025-11-12 09:53:20 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:53:20 - [단계 2/2] Analytic Gradient 계산 #44
2025-11-12 09:54:07 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:54:07 - 
================================================================================
[Major Iteration #9 완료]
  최종 LL: -284939.0888
  Line Search: 2회 함수 호출 - ✓ 성공 (함수값 감소: 1252.0487)
  함수 호출: 18회 (누적)
  그래디언트 호출: 18회 (누적)
  수렴 조건:
    - ftol = 5.542084e-03 (기준: 1e-3, 변화: -4.41e-03 [-44.3%])
    - gtol = 2.060671e+06 (기준: 1e-3, 변화: -7.60e+04 [-3.6%])

  상위 10개 Gradient (절대값 기준):
    [26] param_26                                : -2.060671e+06
    [25] param_25                                : -1.396733e+06
    [20] param_20                                : -8.662476e+05
    [18] param_18                                : -8.625159e+05
    [19] param_19                                : -8.521879e+05
    [46] param_46                                : -8.431545e+05
    [63] param_63                                : -7.469006e+05
    [21] param_21                                : -7.346000e+05
    [16] param_16                                : -6.765800e+05
    [59] param_59                                : -6.737167e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 6.894771e-02
    - y_k (gradient 변화) norm: 2.050644e+05
    - s_k^T · y_k: 3.768376e+03 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 2.653663e-04
    - s_k 상위 5개: [0.02061453 0.02030549 0.02204424 0.02338864 0.01996068]
    - y_k 상위 5개: [-1091.23356252 -1343.18360943  -955.42155367  -215.54732987
 -1296.27394187]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 09:54:07 - [Major Iteration #10 시작] [단계 1/2] 전체 우도 계산
2025-11-12 09:55:23 -   LL = -284758.3772 (Best: -284758.3772) [NEW BEST]
2025-11-12 09:55:23 - [단계 2/2] Analytic Gradient 계산 #45
2025-11-12 09:56:11 - [Line Search 함수 호출 #iter10-1] [단계 1/2] 전체 우도 계산
2025-11-12 09:57:26 -   LL = -284049.3597 (Best: -284049.3597) [NEW BEST]
2025-11-12 09:57:26 -   파라미터 변화량 (L2 norm): 3.338518e-02
  함수값 변화: +709.0175 (감소)
2025-11-12 09:57:26 - [단계 2/2] Analytic Gradient 계산 #46
2025-11-12 09:58:15 - 
[탐색 방향 분석 - Iteration #10]
  탐색 방향 d norm: 3.338518e-02
  탐색 방향 d max: 1.266605e-02
  Gradient norm: 4.431427e+06
  d와 -grad의 코사인 유사도: 0.083648
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.01123045 0.01108752 0.01199925 0.01266605 0.01088869]
  -grad 상위 5개: [ 95678.36032349  97597.64865283  89902.83953032  84039.82286263
 100382.77366122]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 9.475914e-02
    - 변화량 max: 3.454347e-02
    - 변화 상위 5개 인덱스: [3 2 0 1 4]
    - 변화 상위 5개 값: [0.03454347 0.03263446 0.03052968 0.03010379 0.0295794 ]

2025-11-12 09:58:15 - 
[실제 계산에 사용된 파라미터 값 - Iteration #10]
  (External scale, 상위 10개)

2025-11-12 09:58:15 -     [79] param_79                                : +1.189881e+00 (internal: +1.189881e+00)
2025-11-12 09:58:15 -     [77] param_77                                : +8.810193e-01 (internal: +8.810193e-01)
2025-11-12 09:58:15 -     [23] param_23                                : +5.663110e-01 (internal: +5.663110e-01)
2025-11-12 09:58:15 -     [22] param_22                                : +5.551926e-01 (internal: +5.551926e-01)
2025-11-12 09:58:15 -     [ 3] param_3                                 : +5.027967e-01 (internal: +5.027967e-01)
2025-11-12 09:58:15 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:58:15 -     [71] param_71                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 09:58:15 -     [ 2] param_2                                 : +4.877508e-01 (internal: +4.877508e-01)
2025-11-12 09:58:15 -     [78] param_78                                : -4.829657e-01 (internal: -4.829657e-01)
2025-11-12 09:58:15 -     [ 0] param_0                                 : +4.678906e-01 (internal: +4.678906e-01)
2025-11-12 09:58:15 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 09:58:15 - [Line Search 함수 호출 #iter10-2] [단계 1/2] 전체 우도 계산
2025-11-12 09:58:15 - 
================================================================================
2025-11-12 09:58:15 - Iteration 30 - 파라미터 값
2025-11-12 09:58:15 - ================================================================================
2025-11-12 09:58:15 - 
[측정모델 파라미터]
2025-11-12 09:58:15 -   health_concern:
2025-11-12 09:58:15 -     - zeta (처음 3개): [1.         0.51281242 0.50792119]
2025-11-12 09:58:15 -     - sigma_sq (처음 3개): [0.21172044 0.20755488 0.20444907]
2025-11-12 09:58:15 -   perceived_benefit:
2025-11-12 09:58:15 -     - zeta (처음 3개): [1.         0.23913231 0.26259306]
2025-11-12 09:58:15 -     - sigma_sq (처음 3개): [0.21614974 0.18393171 0.19255303]
2025-11-12 09:58:15 -   perceived_price:
2025-11-12 09:58:15 -     - zeta (처음 3개): [1.         0.58665863 0.59307989]
2025-11-12 09:58:15 -     - sigma_sq (처음 3개): [0.23501947 0.15110254 0.12753529]
2025-11-12 09:58:15 -   nutrition_knowledge:
2025-11-12 09:58:15 -     - zeta (처음 3개): [1.         0.37022019 0.3877947 ]
2025-11-12 09:58:15 -     - sigma_sq (처음 3개): [0.1064747  0.1900205  0.20469098]
2025-11-12 09:58:15 -   purchase_intention:
2025-11-12 09:58:15 -     - zeta (처음 3개): [1.         0.24177448 0.2466148 ]
2025-11-12 09:58:15 -     - sigma_sq (처음 3개): [0.46315574 0.33843799 0.28333751]
2025-11-12 09:58:15 - 
[구조모델 파라미터]
2025-11-12 09:58:15 -   gamma_health_concern_to_perceived_benefit: 0.500000
2025-11-12 09:58:15 -   gamma_perceived_benefit_to_purchase_intention: 0.500000
2025-11-12 09:58:15 - 
[선택모델 파라미터]
2025-11-12 09:58:15 -   intercept: 0.267389
2025-11-12 09:58:15 -   beta: [ 0.22566505  0.21549558 -0.0850029 ]
2025-11-12 09:58:15 -   lambda_main: 0.880394
2025-11-12 09:58:15 -   lambda_mod_perceived_price: -0.483538
2025-11-12 09:58:15 -   lambda_mod_nutrition_knowledge: 1.189018
2025-11-12 09:58:15 - ================================================================================
2025-11-12 09:59:30 -   LL = -281429.4550 (Best: -281429.4550) [NEW BEST]
2025-11-12 09:59:30 -   파라미터 변화량 (L2 norm): 1.669259e-01
  함수값 변화: +3328.9223 (감소)
2025-11-12 09:59:30 - [단계 2/2] Analytic Gradient 계산 #47
2025-11-12 10:00:16 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:00:16 - [Line Search 함수 호출 #iter11-3] [단계 1/2] 전체 우도 계산
2025-11-12 10:01:32 -   LL = -281429.4550 (Best: -281429.4550) 
2025-11-12 10:01:32 -   파라미터 변화량 (L2 norm): 1.669259e-01
  함수값 변화: +3328.9223 (감소)
2025-11-12 10:01:32 - [단계 2/2] Analytic Gradient 계산 #48
2025-11-12 10:02:21 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:02:21 - [단계 2/2] Analytic Gradient 계산 #49
2025-11-12 10:03:11 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:03:11 - [단계 2/2] Analytic Gradient 계산 #50
2025-11-12 10:04:00 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:04:00 - 
================================================================================
[Major Iteration #10 완료]
  최종 LL: -281429.4550
  Line Search: 3회 함수 호출 - ✓ 성공 (함수값 감소: 3328.9223)
  함수 호출: 21회 (누적)
  그래디언트 호출: 21회 (누적)
  수렴 조건:
    - ftol = 1.231714e-02 (기준: 1e-3, 변화: +6.78e-03 [+122.2%])
    - gtol = 1.893271e+06 (기준: 1e-3, 변화: -1.67e+05 [-8.1%])

  상위 10개 Gradient (절대값 기준):
    [26] param_26                                : -1.893271e+06
    [25] param_25                                : -1.291221e+06
    [63] param_63                                : -8.297264e+05
    [20] param_20                                : -8.089029e+05
    [18] param_18                                : -8.057084e+05
    [19] param_19                                : -7.933784e+05
    [46] param_46                                : -7.793433e+05
    [10] param_10                                : -7.019412e+05
    [21] param_21                                : -6.834075e+05
    [ 7] param_7                                 : -6.728246e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 1.752722e-01
    - y_k (gradient 변화) norm: 3.155107e+05
    - s_k^T · y_k: 1.027113e+04 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 9.736027e-05
    - s_k 상위 5개: [0.05895985 0.05820948 0.06299608 0.06649675 0.0571656 ]
    - y_k 상위 5개: [-6833.23394325 -6695.47096105 -7335.10785221 -6889.00144491
 -6660.51543712]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 10:04:00 - [Major Iteration #11 시작] [단계 1/2] 전체 우도 계산
2025-11-12 10:05:15 -   LL = -281001.7774 (Best: -281001.7774) [NEW BEST]
2025-11-12 10:05:15 - [단계 2/2] Analytic Gradient 계산 #51
2025-11-12 10:06:02 - [Line Search 함수 호출 #iter11-1] [단계 1/2] 전체 우도 계산
2025-11-12 10:07:18 -   LL = -279312.1291 (Best: -279312.1291) [NEW BEST]
2025-11-12 10:07:18 -   파라미터 변화량 (L2 norm): 7.777902e-02
  함수값 변화: +1689.6483 (감소)
2025-11-12 10:07:18 - [단계 2/2] Analytic Gradient 계산 #52
2025-11-12 10:08:05 - 
[탐색 방향 분석 - Iteration #11]
  탐색 방향 d norm: 7.777902e-02
  탐색 방향 d max: 3.146113e-02
  Gradient norm: 4.254918e+06
  d와 -grad의 코사인 유사도: 0.083188
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.02816098 0.02784815 0.03002227 0.03146113 0.02737732]
  -grad 상위 5개: [101366.45596491 102792.37825041  97810.34054237  92913.84545665
 105144.95696978]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 2.609767e-01
    - 변화량 max: 1.026566e-01
    - 변화 상위 5개 인덱스: [3 2 0 1 4]
    - 변화 상위 5개 값: [0.10265665 0.0975241  0.09135346 0.09024779 0.08866508]

2025-11-12 10:08:05 - 
[실제 계산에 사용된 파라미터 값 - Iteration #11]
  (External scale, 상위 10개)

2025-11-12 10:08:05 -     [79] param_79                                : +1.188372e+00 (internal: +1.188372e+00)
2025-11-12 10:08:05 -     [77] param_77                                : +8.799214e-01 (internal: +8.799214e-01)
2025-11-12 10:08:05 -     [23] param_23                                : +6.118521e-01 (internal: +6.118521e-01)
2025-11-12 10:08:05 -     [22] param_22                                : +6.093623e-01 (internal: +6.093623e-01)
2025-11-12 10:08:05 -     [ 3] param_3                                 : +5.927873e-01 (internal: +5.927873e-01)
2025-11-12 10:08:05 -     [ 2] param_2                                 : +5.732757e-01 (internal: +5.732757e-01)
2025-11-12 10:08:05 -     [ 0] param_0                                 : +5.480136e-01 (internal: +5.480136e-01)
2025-11-12 10:08:05 -     [ 1] param_1                                 : +5.427314e-01 (internal: +5.427314e-01)
2025-11-12 10:08:05 -     [ 4] param_4                                 : +5.371410e-01 (internal: +5.371410e-01)
2025-11-12 10:08:05 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 10:08:05 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:08:05 - [Line Search 함수 호출 #iter11-2] [단계 1/2] 전체 우도 계산
2025-11-12 10:09:21 -   LL = -272885.5559 (Best: -272885.5559) [NEW BEST]
2025-11-12 10:09:21 -   파라미터 변화량 (L2 norm): 3.888951e-01
  함수값 변화: +8116.2215 (감소)
2025-11-12 10:09:21 - [단계 2/2] Analytic Gradient 계산 #53
2025-11-12 10:10:10 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:10:10 - [Line Search 함수 호출 #iter12-3] [단계 1/2] 전체 우도 계산
2025-11-12 10:11:26 -   LL = -272885.5559 (Best: -272885.5559) 
2025-11-12 10:11:26 -   파라미터 변화량 (L2 norm): 3.888951e-01
  함수값 변화: +8116.2215 (감소)
2025-11-12 10:11:26 - [단계 2/2] Analytic Gradient 계산 #54
2025-11-12 10:12:12 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:12:12 - [단계 2/2] Analytic Gradient 계산 #55
2025-11-12 10:13:00 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:13:00 - [단계 2/2] Analytic Gradient 계산 #56
2025-11-12 10:13:47 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:13:47 - 
================================================================================
[Major Iteration #11 완료]
  최종 LL: -272885.5559
  Line Search: 3회 함수 호출 - ✓ 성공 (함수값 감소: 8116.2215)
  함수 호출: 24회 (누적)
  그래디언트 호출: 24회 (누적)
  수렴 조건:
    - ftol = 3.035894e-02 (기준: 1e-3, 변화: +1.80e-02 [+146.5%])
    - gtol = 1.548784e+06 (기준: 1e-3, 변화: -3.44e+05 [-18.2%])

  상위 10개 Gradient (절대값 기준):
    [26] param_26                                : -1.548784e+06
    [25] param_25                                : -1.097848e+06
    [20] param_20                                : -7.991209e+05
    [19] param_19                                : -7.912502e+05
    [18] param_18                                : -7.887391e+05
    [63] param_63                                : -7.521590e+05
    [21] param_21                                : -6.801467e+05
    [59] param_59                                : -6.609786e+05
    [58] param_58                                : -6.571488e+05
    [61] param_61                                : -6.173363e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 4.083399e-01
    - y_k (gradient 변화) norm: 5.073130e+05
    - s_k^T · y_k: 1.564544e+04 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 6.391638e-05
    - s_k 상위 5개: [0.14784516 0.14620278 0.15761693 0.16517093 0.14373092]
    - y_k 상위 5개: [ -3875.14547381  -3422.37391938 -11114.37015721 -17429.83134964
   -379.341873  ]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 10:13:47 - [Major Iteration #12 시작] [단계 1/2] 전체 우도 계산
2025-11-12 10:15:03 -   LL = -271877.5828 (Best: -271877.5828) [NEW BEST]
2025-11-12 10:15:03 - [단계 2/2] Analytic Gradient 계산 #57
2025-11-12 10:15:53 - [Line Search 함수 호출 #iter12-1] [단계 1/2] 전체 우도 계산
2025-11-12 10:17:08 -   LL = -267993.0977 (Best: -267993.0977) [NEW BEST]
2025-11-12 10:17:08 -   파라미터 변화량 (L2 norm): 1.926371e-01
  함수값 변화: +3884.4851 (감소)
2025-11-12 10:17:08 - [단계 2/2] Analytic Gradient 계산 #58
2025-11-12 10:17:55 - 
[탐색 방향 분석 - Iteration #12]
  탐색 방향 d norm: 1.926371e-01
  탐색 방향 d max: 8.023348e-02
  Gradient norm: 3.945654e+06
  d와 -grad의 코사인 유사도: 0.087875
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.07010837 0.06934043 0.07582951 0.08023348 0.06771248]
  -grad 상위 5개: [109359.2595013  111955.74972473 108184.38064779 106698.5317612
 113329.66030593]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 6.271458e-01
    - 변화량 max: 2.575975e-01
    - 변화 상위 5개 인덱스: [3 2 0 1 4]
    - 변화 상위 5개 값: [0.25759751 0.24489824 0.22844037 0.22591629 0.22152719]

2025-11-12 10:17:55 - 
[실제 계산에 사용된 파라미터 값 - Iteration #12]
  (External scale, 상위 10개)

2025-11-12 10:17:55 -     [79] param_79                                : +1.184758e+00 (internal: +1.184758e+00)
2025-11-12 10:17:55 -     [77] param_77                                : +8.771726e-01 (internal: +8.771726e-01)
2025-11-12 10:17:55 -     [ 3] param_3                                 : +8.189237e-01 (internal: +8.189237e-01)
2025-11-12 10:17:55 -     [ 2] param_2                                 : +7.881516e-01 (internal: +7.881516e-01)
2025-11-12 10:17:55 -     [ 0] param_0                                 : +7.482930e-01 (internal: +7.482930e-01)
2025-11-12 10:17:55 -     [ 1] param_1                                 : +7.407995e-01 (internal: +7.407995e-01)
2025-11-12 10:17:55 -     [22] param_22                                : +7.332623e-01 (internal: +7.332623e-01)
2025-11-12 10:17:55 -     [ 4] param_4                                 : +7.312909e-01 (internal: +7.312909e-01)
2025-11-12 10:17:55 -     [23] param_23                                : +7.130075e-01 (internal: +7.130075e-01)
2025-11-12 10:17:55 -     [72] param_72                                : +5.000000e-01 (internal: +5.000000e-01)
2025-11-12 10:17:55 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:17:55 - [Line Search 함수 호출 #iter12-2] [단계 1/2] 전체 우도 계산
2025-11-12 10:19:10 -   LL = -254629.2078 (Best: -254629.2078) [NEW BEST]
2025-11-12 10:19:10 -   파라미터 변화량 (L2 norm): 9.631855e-01
  함수값 변화: +17248.3751 (감소)
2025-11-12 10:19:10 - [단계 2/2] Analytic Gradient 계산 #59
2025-11-12 10:19:58 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:19:58 - [Line Search 함수 호출 #iter13-3] [단계 1/2] 전체 우도 계산
2025-11-12 10:21:14 -   LL = -254629.2078 (Best: -254629.2078) 
2025-11-12 10:21:14 -   파라미터 변화량 (L2 norm): 9.631855e-01
  함수값 변화: +17248.3751 (감소)
2025-11-12 10:21:14 - [단계 2/2] Analytic Gradient 계산 #60
2025-11-12 10:22:02 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:22:02 - [단계 2/2] Analytic Gradient 계산 #61
2025-11-12 10:22:49 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:22:49 - [단계 2/2] Analytic Gradient 계산 #62
2025-11-12 10:23:38 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:23:38 - 
================================================================================
[Major Iteration #12 완료]
  최종 LL: -254629.2078
  Line Search: 3회 함수 호출 - ✓ 성공 (함수값 감소: 17248.3751)
  함수 호출: 27회 (누적)
  그래디언트 호출: 27회 (누적)
  수렴 조건:
    - ftol = 6.690112e-02 (기준: 1e-3, 변화: +3.65e-02 [+120.4%])
    - gtol = 1.010501e+06 (기준: 1e-3, 변화: -5.38e+05 [-34.8%])

  상위 10개 Gradient (절대값 기준):
    [26] param_26                                : -1.010501e+06
    [25] param_25                                : -7.888820e+05
    [16] param_16                                : -7.147298e+05
    [10] param_10                                : -7.136706e+05
    [ 5] param_5                                 : -6.970558e+05
    [63] param_63                                : -6.822285e+05
    [59] param_59                                : -6.633232e+05
    [61] param_61                                : -6.631791e+05
    [58] param_58                                : -6.631553e+05
    [50] param_50                                : -6.588908e+05

  Hessian 업데이트 정보:
    - s_k (파라미터 변화) norm: 1.011345e+00
    - y_k (gradient 변화) norm: 9.041826e+05
    - s_k^T · y_k: 1.018018e+05 (양수 ✓)
    - ρ = 1/(s_k^T · y_k): 9.823010e-06
    - s_k 상위 5개: [0.36806892 0.36403728 0.39810491 0.42122579 0.35549052]
    - y_k 상위 5개: [ -4595.40969816  -9008.99974428  12107.11171821  19051.55560481
 -18143.70646687]
  Hessian 근사: BFGS 공식으로 업데이트 완료
================================================================================
2025-11-12 10:23:38 - [Major Iteration #13 시작] [단계 1/2] 전체 우도 계산
2025-11-12 10:23:38 - 
================================================================================
2025-11-12 10:23:38 - Iteration 40 - 파라미터 값
2025-11-12 10:23:38 - ================================================================================
2025-11-12 10:23:38 - 
[측정모델 파라미터]
2025-11-12 10:23:38 -   health_concern:
2025-11-12 10:23:38 -     - zeta (처음 3개): [1.         1.06771281 1.05707886]
2025-11-12 10:23:38 -     - sigma_sq (처음 3개): [0.14862983 0.15152275 0.14635894]
2025-11-12 10:23:38 -   perceived_benefit:
2025-11-12 10:23:38 -     - zeta (처음 3개): [1.         0.46086338 0.49562793]
2025-11-12 10:23:38 -     - sigma_sq (처음 3개): [0.18017458 0.17678392 0.20298368]
2025-11-12 10:23:38 -   perceived_price:
2025-11-12 10:23:38 -     - zeta (처음 3개): [1.         0.9149478  0.85742532]
2025-11-12 10:23:38 -     - sigma_sq (처음 3개): [0.28950756 0.19269868 0.17532578]
2025-11-12 10:23:38 -   nutrition_knowledge:
2025-11-12 10:23:38 -     - zeta (처음 3개): [1.         0.39479697 0.44709295]
2025-11-12 10:23:38 -     - sigma_sq (처음 3개): [0.18053322 0.19036118 0.19751674]
2025-11-12 10:23:38 -   purchase_intention:
2025-11-12 10:23:38 -     - zeta (처음 3개): [1.         0.44292643 0.45764502]
2025-11-12 10:23:38 -     - sigma_sq (처음 3개): [0.47700329 0.2762321  0.31239371]
2025-11-12 10:23:38 - 
[구조모델 파라미터]
2025-11-12 10:23:38 -   gamma_health_concern_to_perceived_benefit: 0.500000
2025-11-12 10:23:38 -   gamma_perceived_benefit_to_purchase_intention: 0.500000
2025-11-12 10:23:38 - 
[선택모델 파라미터]
2025-11-12 10:23:38 -   intercept: 0.251309
2025-11-12 10:23:38 -   beta: [ 0.22334129  0.21321483 -0.10282763]
2025-11-12 10:23:38 -   lambda_main: 0.872604
2025-11-12 10:23:38 -   lambda_mod_perceived_price: -0.490862
2025-11-12 10:23:38 -   lambda_mod_nutrition_knowledge: 1.179182
2025-11-12 10:23:38 - ================================================================================
2025-11-12 10:24:53 -   LL = -252510.7635 (Best: -252510.7635) [NEW BEST]
2025-11-12 10:24:53 - [단계 2/2] Analytic Gradient 계산 #63
2025-11-12 10:25:41 - [Line Search 함수 호출 #iter13-1] [단계 1/2] 전체 우도 계산
2025-11-12 10:26:57 -   LL = -245046.9315 (Best: -245046.9315) [NEW BEST]
2025-11-12 10:26:57 -   파라미터 변화량 (L2 norm): 4.263256e-01
  함수값 변화: +7463.8320 (감소)
2025-11-12 10:26:57 - [단계 2/2] Analytic Gradient 계산 #64
2025-11-12 10:27:49 - 
[탐색 방향 분석 - Iteration #13]
  탐색 방향 d norm: 4.263256e-01
  탐색 방향 d max: 1.767113e-01
  Gradient norm: 3.569005e+06
  d와 -grad의 코사인 유사도: 0.073252
    (1.0 = 완전 동일 방향 [H=I], 0.0 = 직교, -1.0 = 반대 방향)
  d 상위 5개: [0.15594526 0.15567041 0.16666141 0.17671129 0.15360305]
  -grad 상위 5개: [97974.68448409 94864.10509368 84945.33414116 69874.34586082
 89794.90757434]
  → Hessian이 방향을 조정함

  이전 iteration 대비 파라미터 변화:
    - 변화량 norm: 1.484212e+00
    - 변화량 max: 6.220565e-01
    - 변화 상위 5개 인덱스: [3 2 0 1 4]
    - 변화 상위 5개 값: [0.62205654 0.5874743  0.5454734  0.54129019 0.53056622]

2025-11-12 10:27:49 - 
[실제 계산에 사용된 파라미터 값 - Iteration #13]
  (External scale, 상위 10개)

2025-11-12 10:27:49 -     [ 3] param_3                                 : +1.360747e+00 (internal: +1.360747e+00)
2025-11-12 10:27:49 -     [ 2] param_2                                 : +1.299796e+00 (internal: +1.299796e+00)
2025-11-12 10:27:49 -     [ 0] param_0                                 : +1.223658e+00 (internal: +1.223658e+00)
2025-11-12 10:27:49 -     [ 1] param_1                                 : +1.212749e+00 (internal: +1.212749e+00)
2025-11-12 10:27:49 -     [ 4] param_4                                 : +1.194145e+00 (internal: +1.194145e+00)
2025-11-12 10:27:49 -     [79] param_79                                : +1.176694e+00 (internal: +1.176694e+00)
2025-11-12 10:27:49 -     [22] param_22                                : +9.857138e-01 (internal: +9.857138e-01)
2025-11-12 10:27:49 -     [23] param_23                                : +9.092156e-01 (internal: +9.092156e-01)
2025-11-12 10:27:49 -     [77] param_77                                : +8.701574e-01 (internal: +8.701574e-01)
2025-11-12 10:27:49 -     [13] param_13                                : +6.189341e-01 (internal: +6.189341e-01)
2025-11-12 10:27:49 - 
[Wolfe 조건 체크]
  Armijo 조건 (c1=0.001): ✓ 만족
  Curvature 조건 (c2=0.5): ❌ 불만족
  → Strong Wolfe: ❌ 불만족
  → Gradient가 아직 가파름
2025-11-12 10:27:49 - [Line Search 함수 호출 #iter14-2] [단계 1/2] 전체 우도 계산
