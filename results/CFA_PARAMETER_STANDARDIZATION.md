# CFA 파라미터 표준화 여부 분석

## 핵심 결론

### ❌ **CFA 파라미터는 표준화되지 않음 (원척도)**

측정모델 우도 계산시 사용되는 CFA 파라미터:
- **ζ (요인적재량)**: ❌ 표준화 안됨 (원척도)
- **σ² (측정오차 분산)**: ❌ 표준화 안됨 (원척도)

---

## 1. 요인적재량 (ζ, Factor Loadings)

### **실제 값 확인**

| 잠재변수 | 첫 번째 지표 | ζ (Estimate) | 표준화 여부 |
|---------|-------------|--------------|------------|
| health_concern | q6 | **1.000** | 식별 제약 (고정) |
| perceived_benefit | q12 | **1.000** | 식별 제약 (고정) |
| perceived_price | q27 | **1.000** | 식별 제약 (고정) |
| nutrition_knowledge | q30 | **1.000** | 식별 제약 (고정) |
| purchase_intention | q18 | **1.000** | 식별 제약 (고정) |

**나머지 지표들**:
```
health_concern:
  q7:  ζ = 0.851 (표준화 안됨)
  q8:  ζ = 0.651
  q9:  ζ = 0.751
  q10: ζ = 0.691
  q11: ζ = 0.818

perceived_benefit:
  q13: ζ = 0.394 (표준화 안됨)
  q14: ζ = 0.852
  q15: ζ = 0.768
  q16: ζ = 0.587
  q17: ζ = 0.714

perceived_price:
  q28: ζ = 0.579 (표준화 안됨)
  q29: ζ = 0.895

nutrition_knowledge:
  q31: ζ = 0.389 (표준화 안됨)
  q32: ζ = 0.579
  q33: ζ = -0.329 (역코딩)
  ...
  (총 19개 지표)

purchase_intention:
  q19: ζ = 1.007 (표준화 안됨)
  q20: ζ = 0.993
```

### **해석**

1. **식별 제약 (Identification Constraint)**:
   - 각 잠재변수의 **첫 번째 지표의 ζ = 1.0으로 고정**
   - 이는 잠재변수의 스케일을 정의하기 위한 제약
   - **표준화와는 무관**

2. **나머지 지표의 ζ**:
   - **자유롭게 추정됨** (0.3 ~ 1.0 범위)
   - **원척도 값** (표준화 안됨)
   - 지표와 잠재변수 간의 실제 관계를 반영

3. **"Std. Err" 컬럼**:
   - 표준화된 적재량 (Standardized Loadings)
   - 이는 **해석용**이며, **우도 계산에는 사용 안됨**

---

## 2. 측정오차 분산 (σ², Measurement Error Variance)

### **실제 값 확인**

```
health_concern:
  q6:  σ² = 0.216 (원척도)
  q7:  σ² = 0.199
  q8:  σ² = 0.364
  q9:  σ² = 0.206
  q10: σ² = 0.300
  q11: σ² = 0.229

perceived_benefit:
  q12: σ² = 0.198 (원척도)
  q13: σ² = 0.642
  q14: σ² = 0.286
  q15: σ² = 0.373
  q16: σ² = 0.603
  q17: σ² = 0.573

perceived_price:
  q27: σ² = 0.052 (매우 작음!)
  q28: σ² = 0.514
  q29: σ² = 0.255

nutrition_knowledge:
  q30: σ² = 0.506 (원척도)
  q31: σ² = 0.588
  ...
  (평균: 약 0.55)

purchase_intention:
  q18: σ² = 0.171 (원척도)
  q19: σ² = 0.304
  q20: σ² = 0.273
```

### **통계**

- **평균**: 0.444
- **범위**: [0.052, 0.755]
- **표준편차**: 약 0.18

### **해석**

1. **원척도 분산**:
   - 지표(1-5점)의 관측 분산: 약 0.6-1.0
   - 측정오차 분산: 평균 0.444
   - **원척도 값** (표준화 안됨)

2. **신뢰도**:
   - 신뢰도 = 1 - (σ² / Var(지표))
   - 예: q6의 신뢰도 = 1 - (0.216 / 0.734) ≈ 0.71 (양호)

---

## 3. 측정모델 우도 계산

### **공식**

```
Y_i = ζ_i * LV + ε_i
ε_i ~ N(0, σ²_i)

log p(Y_i | LV) = -0.5 * log(2π * σ²_i) - 0.5 * (Y_i - ζ_i * LV)² / σ²_i
```

### **실제 계산 예시**

**개인 1, 지표 q6, LV = 0.5 (표준화)**:

```
Y_obs = 4.0 (원척도, 1-5점)
ζ = 1.000 (원척도, CFA 결과)
σ² = 0.216 (원척도, CFA 결과)
LV = 0.5 (표준화, N(0,1) 샘플링)

Y_pred = ζ * LV = 1.000 * 0.5 = 0.5

residual = Y_obs - Y_pred = 4.0 - 0.5 = 3.5 (매우 큼!)

ll = -0.5 * log(2π * 0.216) - 0.5 * (3.5)² / 0.216
   = -0.5 * log(1.356) - 0.5 * 12.25 / 0.216
   = -0.153 - 28.36
   = -28.51 (매우 낮음!)
```

### **문제점**

1. **스케일 불일치**:
   - LV: 표준화 (평균 0, 표준편차 1)
   - ζ: 원척도 (0.3 ~ 1.0)
   - Y: 원척도 (1-5점)

2. **큰 잔차**:
   - Y_pred = ζ * LV = 1.0 * 0.5 = 0.5
   - Y_obs = 4.0
   - residual = 3.5 (매우 큼!)

3. **낮은 우도**:
   - 큰 잔차 + 작은 σ² → 매우 낮은 우도
   - 지표당 평균 우도: -28.51 (매우 큰 음수)

---

## 4. 왜 이런 문제가 발생하는가?

### **근본 원인**

1. **CFA는 요인점수를 표준화**:
   - semopy는 잠재변수 분산 Var(LV) = 1로 고정
   - 요인점수: 평균 0, 표준편차 1

2. **하지만 파라미터(ζ, σ²)는 원척도 유지**:
   - ζ: 원척도 지표와 표준화 LV 간의 관계
   - σ²: 원척도 지표의 측정오차 분산

3. **동시추정에서 LV를 N(0,1)에서 샘플링**:
   - LV: 표준화 (평균 0, 표준편차 1)
   - 지표: 원척도 (1-5점)
   - **스케일 불일치!**

### **올바른 예측값 계산**

**CFA에서 학습한 관계**:
```
Y_i = ζ_i * LV + ε_i
여기서 LV는 표준화됨 (평균 0, 표준편차 1)
```

**동시추정에서도 동일하게 사용**:
```
LV ~ N(0, 1) (Halton 샘플링)
Y_pred = ζ_i * LV
```

**문제**:
- LV = 0.5 → Y_pred = 1.0 * 0.5 = 0.5
- 하지만 실제 지표는 1-5점 범위
- **예측값이 너무 작음!**

---

## 5. 해결 방안

### **Option A: 현재 상태 유지 (추천)**

**이유**:
- 이미 스케일링 적용 중 (측정모델 우도 ÷ 38)
- Gamma 파라미터 업데이트 성공
- 추가 작업 불필요

### **Option B: 지표 표준화**

**방법**:
- 지표(q6-q49)를 Z-score 표준화
- CFA 재추정
- 새로운 ζ, σ² 사용

**장점**:
- LV와 지표의 스케일 일치
- 잔차 감소 → 우도 증가

**단점**:
- 데이터 재전처리 필요
- 해석 복잡해짐

### **Option C: 절편 추가**

**방법**:
```
Y_i = α_i + ζ_i * LV + ε_i
```

**장점**:
- 스케일 불일치 해결
- 이론적으로 올바름

**단점**:
- 파라미터 증가 (38개 절편)
- 구현 복잡

---

## 6. 결론

### **CFA 파라미터 표준화 여부**

1. **ζ (요인적재량)**: ❌ **표준화 안됨** (원척도)
   - 첫 번째 지표: ζ = 1.0 (식별 제약)
   - 나머지 지표: 자유 추정 (0.3 ~ 1.0)

2. **σ² (측정오차 분산)**: ❌ **표준화 안됨** (원척도)
   - 평균: 0.444
   - 범위: [0.052, 0.755]

### **스케일 불일치 문제**

- **LV (표준화) vs 지표 (원척도)** → 큰 잔차 → 낮은 우도
- **현재 해결책**: 측정모델 우도 스케일링 (÷38)

### **권장**

- ✅ **현재 상태 유지** (Option A)
- 이미 작동하고 있음
- 추가 작업 불필요

---

**작성일**: 2025-11-20  
**작성자**: Augment Agent

